if (self.CavalryLogger) { CavalryLogger.start_js(["aW1AJ"]); }

__d("SphericalMediaPerformanceTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:SphericalMediaPerformanceLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:SphericalMediaPerformanceLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:SphericalMediaPerformanceLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setComputationTimeMs=function(a){this.$1.computation_time_ms=a;return this};c.setEndTimestampS=function(a){this.$1.end_timestamp_s=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setFallbackDuration=function(a){this.$1.fallback_duration=a;return this};c.setFallbackReason=function(a){this.$1.fallback_reason=a;return this};c.setNormalizedFrameTime=function(a){this.$1.normalized_frame_time=a;return this};c.setNumSpatialAudioStutters=function(a){this.$1.num_spatial_audio_stutters=a;return this};c.setProductName=function(a){this.$1.product_name=a;return this};c.setProjection=function(a){this.$1.projection=a;return this};c.setSpatialReactionsCacheUsed=function(a){this.$1.spatial_reactions_cache_used=a;return this};c.setSpatialReactionsClustersCount=function(a){this.$1.spatial_reactions_clusters_count=a;return this};c.setSpatialReactionsCount=function(a){this.$1.spatial_reactions_count=a;return this};c.setSphericalRendererSetupDuration=function(a){this.$1.spherical_renderer_setup_duration=a;return this};c.setStartTimestampS=function(a){this.$1.start_timestamp_s=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVideoID=function(a){this.$1.video_id=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={computation_time_ms:!0,end_timestamp_s:!0,event:!0,fallback_duration:!0,fallback_reason:!0,normalized_frame_time:!0,num_spatial_audio_stutters:!0,product_name:!0,projection:!0,spatial_reactions_cache_used:!0,spatial_reactions_clusters_count:!0,spatial_reactions_count:!0,spherical_renderer_setup_duration:!0,start_timestamp_s:!0,time:!0,video_id:!0,weight:!0};e.exports=a}),null);
__d("createExponentialMovingAverage",[],(function(a,b,c,d,e,f){__p&&__p();function a(a,b){b===void 0&&(b=0);var c=b;return function(b){return c+=a*(b-c)}}function g(a){return function(b){return 1-Math.exp(-b/a)}}function b(a,b){b===void 0&&(b=0);var c=b,d=g(a);return function(a,b){return c+=d(b)*(a-c)}}a.createContinuous=b;e.exports=a}),null);
__d("VelocityTracker",["createExponentialMovingAverage","performanceNow"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,c){a===void 0&&(a=50),c===void 0&&(c={x:0,y:0}),this.$5=c.x,this.$6=c.y,this.$1=b("performanceNow")(),this.$2=b("createExponentialMovingAverage").createContinuous(a,this.$5),this.$3=b("createExponentialMovingAverage").createContinuous(a,this.$6)}var c=a.prototype;c.update=function(a,c){var d=0;this.$4?(d=b("performanceNow")()-this.$1,d=this.updateVelocity((a-this.$4.x)*1e3/d,(c-this.$4.y)*1e3/d)):this.$1=b("performanceNow")();this.$4={x:a,y:c};return d};c.updateVelocity=function(a,c){var d=b("performanceNow")(),e=d-this.$1;this.$1=d;this.$5=this.$2(a,e);this.$6=this.$3(c,e);return e};c.getVelocityX=function(){return Math.trunc(this.$5)};c.getVelocityY=function(){return Math.trunc(this.$6)};c.getSpeed=function(){return Math.trunc(Math.sqrt(this.$5*this.$5+this.$6*this.$6))};return a}();e.exports=a}),null);
__d("SphericalVideoComponentDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;babelHelpers.assertThisInitialized(b).dispatch=b.dispatch.bind(babelHelpers.assertThisInitialized(b));return b}return b}(b("ExplicitRegistrationReactDispatcher"));e.exports=new a({strict:!0})}),null);
__d("SphericalVideoComponentActions",["SphericalVideoComponentDispatcher"],(function(a,b,c,d,e,f){__p&&__p();a={registerVideoPlayerController:function(a){a={type:"SphericalVideoComponent/registerVideoPlayerController",controller:a,id:a.getVideoPlayerID()};b("SphericalVideoComponentDispatcher").dispatch(a)},updateVideoPlayerState:function(a,c){a={type:"SphericalVideoComponent/updateVideoPlayerState",id:a,state:c};b("SphericalVideoComponentDispatcher").dispatch(a)},togglePlay:function(a,c){a={type:"SphericalVideoComponent/togglePlay",id:a,nextIsPlaying:c};b("SphericalVideoComponentDispatcher").dispatch(a)},toggleChannelView:function(a,c){a={type:"SphericalVideoComponent/toggleChannelView",id:a,isInChannelView:c};b("SphericalVideoComponentDispatcher").dispatch(a)},toggleTahoe:function(a,c){a={type:"SphericalVideoComponent/toggleTahoe",id:a,isInTahoe:c};b("SphericalVideoComponentDispatcher").dispatch(a)},setCurrentVideoTime:function(a,c){a={type:"SphericalVideoComponent/setCurrentPlaytime",id:a,time:c};b("SphericalVideoComponentDispatcher").dispatch(a)},setVideoDuration:function(a,c){a={type:"SphericalVideoComponent/setVideoDuration",id:a,durationSeconds:c};b("SphericalVideoComponentDispatcher").dispatch(a)},seekStart:function(a){a={type:"SphericalVideoComponent/seekStart",id:a};b("SphericalVideoComponentDispatcher").dispatch(a)},registerSphericalViewportControl:function(a,c,d){a={type:"SphericalVideoComponent/registerSphericalViewportControl",id:a,sphericalViewportControl:c,viewport:d};b("SphericalVideoComponentDispatcher").dispatch(a)},changeViewport:function(a,c,d,e){a={type:"SphericalVideoComponent/changeViewport",id:a,yaw:c,pitch:d,fieldOfView:e};b("SphericalVideoComponentDispatcher").dispatch(a)},toggleViewportGrabbed:function(a){a={type:"SphericalVideoComponent/toggleViewportGrabbed",id:a};b("SphericalVideoComponentDispatcher").dispatch(a)},updateViewportDimensions:function(a,c,d){a={type:"SphericalVideoComponent/updateViewportDimensions",id:a,width:c,height:d};b("SphericalVideoComponentDispatcher").dispatch(a)},setUserIsInactive:function(a){a={type:"SphericalVideoComponent/setUserIsInactive",id:a};b("SphericalVideoComponentDispatcher").dispatch(a)},setInitialViewport:function(a,c,d){a={type:"SphericalVideoComponent/setInitialViewport",id:a,yaw:c,pitch:d};b("SphericalVideoComponentDispatcher").dispatch(a)}};e.exports=a}),null);
__d("SphericalVideoComponentConstants",[],(function(a,b,c,d,e,f){a={ACTIONS:{REGISTER_VIDEO_PLAYER_CONTROLLER:"SphericalVideoComponent/registerVideoPlayerController",UPDATE_VIDEO_PLAYER_STATE:"SphericalVideoComponent/updateVideoPlayerState",TOGGLE_PLAY:"SphericalVideoComponent/togglePlay",SET_CURRENT_PLAY_TIME:"SphericalVideoComponent/setCurrentPlaytime",SET_VIDEO_DURATION:"SphericalVideoComponent/setVideoDuration",TOGGLE_CHANNEL_VIEW:"SphericalVideoComponent/toggleChannelView",TOGGLE_TAHOE:"SphericalVideoComponent/toggleTahoe",SEEK_START:"SphericalVideoComponent/seekStart",REGISTER_SPHERICAL_VIEWPORT_CONTROL:"SphericalVideoComponent/registerSphericalViewportControl",CHANGE_VIEWPORT:"SphericalVideoComponent/changeViewport",TOGGLE_VIEWPORT_GRABBED:"SphericalVideoComponent/toggleViewportGrabbed",UPDATE_VIEWPORT_DIMENSIONS:"SphericalVideoComponent/updateViewportDimensions",SET_USER_IS_INACTIVE:"SphericalVideoComponent/setUserIsInactive",SET_INITIAL_VIEWPORT:"SphericalVideoComponent/setInitialViewport"}};e.exports=a}),null);
__d("degToRad",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a*Math.PI/180}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("gl-matrix-2.4.0",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h={exports:g},i;function j(){__p&&__p();(function(a,b){if(typeof g==="object"&&typeof h==="object")h.exports=b();else if(typeof i==="function"&&i.amd)i([],b);else{b=b();for(var c in b)(typeof g==="object"?g:a)[c]=b[c]}})(this,function(){__p&&__p();return function(a){__p&&__p();var b={};function c(f){if(b[f])return b[f].exports;var d=b[f]={i:f,l:!1,exports:{}};a[f].call(d.exports,d,d.exports,c);d.l=!0;return d.exports}c.m=a;c.c=b;c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{configurable:!1,enumerable:!0,get:d})};c.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};c.d(b,"a",b);return b};c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};c.p="";return c(c.s=4)}([function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.setMatrixArrayType=a;b.toRadian=c;b.equals=h;var d=b.EPSILON=1e-6;b.ARRAY_TYPE=typeof Float32Array!=="undefined"?Float32Array:Array;b.RANDOM=Math.random;function a(a){b.ARRAY_TYPE=a}var g=Math.PI/180;function c(a){return a*g}function h(a,b){return Math.abs(a-b)<=d*Math.max(1,Math.abs(a),Math.abs(b))}},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.sub=b.mul=void 0;b.create=g;b.fromMat4=h;b.clone=i;b.copy=j;b.fromValues=k;b.set=l;b.identity=m;b.transpose=n;b.invert=o;b.adjoint=p;b.determinant=q;b.multiply=r;b.translate=s;b.rotate=t;b.scale=u;b.fromTranslation=v;b.fromRotation=w;b.fromScaling=x;b.fromMat2d=y;b.fromQuat=z;b.normalFromMat4=A;b.projection=B;b.str=C;b.frob=D;b.add=E;b.subtract=F;b.multiplyScalar=G;b.multiplyScalarAndAdd=H;b.exactEquals=I;b.equals=J;g=c(0);var d=a(g);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){__p&&__p();var a=new d.ARRAY_TYPE(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function h(a,b){__p&&__p();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a}function i(a){__p&&__p();var b=new d.ARRAY_TYPE(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b}function j(a,b){__p&&__p();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a}function k(a,b,c,e,f,g,h,i,j){__p&&__p();var k=new d.ARRAY_TYPE(9);k[0]=a;k[1]=b;k[2]=c;k[3]=e;k[4]=f;k[5]=g;k[6]=h;k[7]=i;k[8]=j;return k}function l(a,b,c,d,e,f,g,h,i,j){__p&&__p();a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=i;a[8]=j;return a}function m(a){__p&&__p();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function n(a,b){__p&&__p();if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a}function o(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7];b=b[8];var k=b*g-h*j,l=-b*f+h*i,m=j*f-g*i,n=c*k+d*l+e*m;if(!n)return null;n=1/n;a[0]=k*n;a[1]=(-b*d+e*j)*n;a[2]=(h*d-e*g)*n;a[3]=l*n;a[4]=(b*c-e*i)*n;a[5]=(-h*c+e*f)*n;a[6]=m*n;a[7]=(-j*c+d*i)*n;a[8]=(g*c-d*f)*n;return a}function p(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7];b=b[8];a[0]=g*b-h*j;a[1]=e*j-d*b;a[2]=d*h-e*g;a[3]=h*i-f*b;a[4]=c*b-e*i;a[5]=e*f-c*h;a[6]=f*j-g*i;a[7]=d*i-c*j;a[8]=c*g-d*f;return a}function q(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7];a=a[8];return b*(a*f-g*i)+c*(-a*e+g*h)+d*(i*e-f*h)}function r(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=c[0],m=c[1],n=c[2],o=c[3],p=c[4],q=c[5],r=c[6],s=c[7];c=c[8];a[0]=l*d+m*g+n*j;a[1]=l*e+m*h+n*k;a[2]=l*f+m*i+n*b;a[3]=o*d+p*g+q*j;a[4]=o*e+p*h+q*k;a[5]=o*f+p*i+q*b;a[6]=r*d+s*g+c*j;a[7]=r*e+s*h+c*k;a[8]=r*f+s*i+c*b;return a}function s(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=h;a[5]=i;a[6]=l*d+c*g+j;a[7]=l*e+c*h+k;a[8]=l*f+c*i+b;return a}function t(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=Math.sin(c);c=Math.cos(c);a[0]=c*d+l*g;a[1]=c*e+l*h;a[2]=c*f+l*i;a[3]=c*g-l*d;a[4]=c*h-l*e;a[5]=c*i-l*f;a[6]=j;a[7]=k;a[8]=b;return a}function u(a,b,c){__p&&__p();var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a}function v(a,b){__p&&__p();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a}function w(a,b){__p&&__p();var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=-c;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function x(a,b){__p&&__p();a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function y(a,b){__p&&__p();a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a}function z(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,g=d+d,h=e+e;c=c*f;var i=d*f;d=d*g;var j=e*f,k=e*g;e=e*h;f=b*f;g=b*g;b=b*h;a[0]=1-d-e;a[3]=i-b;a[6]=j+g;a[1]=i+b;a[4]=1-c-e;a[7]=k-f;a[2]=j-g;a[5]=k+f;a[8]=1-c-d;return a}function A(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14];b=b[15];var r=c*h-d*g,s=c*i-e*g,t=c*j-f*g,u=d*i-e*h,v=d*j-f*h,w=e*j-f*i,x=k*p-l*o,y=k*q-m*o;k=k*b-n*o;var z=l*q-m*p;l=l*b-n*p;m=m*b-n*q;n=r*m-s*l+t*z+u*k-v*y+w*x;if(!n)return null;n=1/n;a[0]=(h*m-i*l+j*z)*n;a[1]=(i*k-g*m-j*y)*n;a[2]=(g*l-h*k+j*x)*n;a[3]=(e*l-d*m-f*z)*n;a[4]=(c*m-e*k+f*y)*n;a[5]=(d*k-c*l-f*x)*n;a[6]=(p*w-q*v+b*u)*n;a[7]=(q*t-o*w-b*s)*n;a[8]=(o*v-p*t+b*r)*n;return a}function B(a,b,c){__p&&__p();a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/c;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a}function C(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}function D(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}function E(a,b,c){__p&&__p();a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a}function F(a,b,c){__p&&__p();a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a}function G(a,b,c){__p&&__p();a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a}function H(b,c,d,a){__p&&__p();b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;b[4]=c[4]+d[4]*a;b[5]=c[5]+d[5]*a;b[6]=c[6]+d[6]*a;b[7]=c[7]+d[7]*a;b[8]=c[8]+d[8]*a;return b}function I(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]}function J(a,b){var c=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7];a=a[8];var l=b[0],m=b[1],n=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7];b=b[8];return Math.abs(c-l)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(l))&&Math.abs(e-m)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(m))&&Math.abs(f-n)<=d.EPSILON*Math.max(1,Math.abs(f),Math.abs(n))&&Math.abs(g-o)<=d.EPSILON*Math.max(1,Math.abs(g),Math.abs(o))&&Math.abs(h-p)<=d.EPSILON*Math.max(1,Math.abs(h),Math.abs(p))&&Math.abs(i-q)<=d.EPSILON*Math.max(1,Math.abs(i),Math.abs(q))&&Math.abs(j-r)<=d.EPSILON*Math.max(1,Math.abs(j),Math.abs(r))&&Math.abs(k-s)<=d.EPSILON*Math.max(1,Math.abs(k),Math.abs(s))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}b.mul=r;b.sub=F},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.forEach=b.sqrLen=b.len=b.sqrDist=b.dist=b.div=b.mul=b.sub=void 0;b.create=g;b.clone=h;b.length=i;b.fromValues=j;b.copy=k;b.set=l;b.add=m;b.subtract=n;b.multiply=o;b.divide=p;b.ceil=q;b.floor=r;b.min=s;b.max=t;b.round=u;b.scale=v;b.scaleAndAdd=w;b.distance=x;b.squaredDistance=y;b.squaredLength=z;b.negate=A;b.inverse=B;b.normalize=C;b.dot=D;b.cross=E;b.lerp=F;b.hermite=G;b.bezier=H;b.random=I;b.transformMat4=J;b.transformMat3=K;b.transformQuat=L;b.rotateX=M;b.rotateY=N;b.rotateZ=O;b.angle=P;b.str=Q;b.exactEquals=R;b.equals=S;h=c(0);var d=a(h);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){var a=new d.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a}function h(a){var b=new d.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b}function i(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function j(a,b,c){var e=new d.ARRAY_TYPE(3);e[0]=a;e[1]=b;e[2]=c;return e}function k(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a}function l(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a}function m(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a}function n(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}function o(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a}function p(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a}function q(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a}function r(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a}function s(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a}function t(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a}function u(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a}function v(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a}function w(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;return b}function x(a,b){var c=b[0]-a[0],d=b[1]-a[1];b=b[2]-a[2];return Math.sqrt(c*c+d*d+b*b)}function y(a,b){var c=b[0]-a[0],d=b[1]-a[1];b=b[2]-a[2];return c*c+d*d+b*b}function z(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a}function A(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a}function B(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a}function C(a,b){var c=b[0],d=b[1],e=b[2];c=c*c+d*d+e*e;c>0&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a}function D(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function E(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],g=c[1];c=c[2];a[0]=e*c-b*g;a[1]=b*f-d*c;a[2]=d*g-e*f;return a}function F(a,b,c,d){var e=b[0],f=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=b+d*(c[2]-b);return a}function G(a,b,c,d,e,f){var g=f*f,h=g*(2*f-3)+1,i=g*(f-2)+f,j=g*(f-1);g=g*(3-2*f);a[0]=b[0]*h+c[0]*i+d[0]*j+e[0]*g;a[1]=b[1]*h+c[1]*i+d[1]*j+e[1]*g;a[2]=b[2]*h+c[2]*i+d[2]*j+e[2]*g;return a}function H(a,b,c,d,e,f){var g=1-f,h=g*g,i=f*f,j=h*g;h=3*f*h;g=3*i*g;i=i*f;a[0]=b[0]*j+c[0]*h+d[0]*g+e[0]*i;a[1]=b[1]*j+c[1]*h+d[1]*g+e[1]*i;a[2]=b[2]*j+c[2]*h+d[2]*g+e[2]*i;return a}function I(b,a){a=a||1;var c=d.RANDOM()*2*Math.PI,e=d.RANDOM()*2-1,f=Math.sqrt(1-e*e)*a;b[0]=Math.cos(c)*f;b[1]=Math.sin(c)*f;b[2]=e*a;return b}function J(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[3]*d+c[7]*e+c[11]*b+c[15];f=f||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/f;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/f;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/f;return a}function K(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a}function L(a,b,c){__p&&__p();var d=b[0],e=b[1];b=b[2];var f=c[0],g=c[1],h=c[2];c=c[3];var i=c*d+g*b-h*e,j=c*e+h*d-f*b,k=c*b+f*e-g*d;d=-f*d-g*e-h*b;a[0]=i*c+d*-f+j*-h-k*-g;a[1]=j*c+d*-g+k*-f-i*-h;a[2]=k*c+d*-h+i*-g-j*-f;return a}function M(a,b,c,d){__p&&__p();var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0];f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a}function N(a,b,c,d){__p&&__p();var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d);f[1]=e[1];f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a}function O(a,b,c,d){__p&&__p();var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);f[2]=e[2];a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a}function P(a,b){__p&&__p();a=j(a[0],a[1],a[2]);b=j(b[0],b[1],b[2]);C(a,a);C(b,b);a=D(a,b);if(a>1)return 0;else if(a<-1)return Math.PI;else return Math.acos(a)}function Q(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}function R(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function S(a,b){var c=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];return Math.abs(c-f)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(e-g)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}b.sub=n;b.mul=o;b.div=p;b.dist=x;b.sqrDist=y;b.len=i;b.sqrLen=z;b.forEach=function(){var a=g();return function(b,c,d,e,f,g){var h=void 0,i=void 0;c||(c=3);d||(d=0);e?i=Math.min(e*c+d,b.length):i=b.length;for(h=d;h<i;h+=c)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],f(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2];return b}}()},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.forEach=b.sqrLen=b.len=b.sqrDist=b.dist=b.div=b.mul=b.sub=void 0;b.create=g;b.clone=h;b.fromValues=i;b.copy=j;b.set=k;b.add=l;b.subtract=m;b.multiply=n;b.divide=o;b.ceil=p;b.floor=q;b.min=r;b.max=s;b.round=t;b.scale=u;b.scaleAndAdd=v;b.distance=w;b.squaredDistance=x;b.length=y;b.squaredLength=z;b.negate=A;b.inverse=B;b.normalize=C;b.dot=D;b.lerp=E;b.random=F;b.transformMat4=G;b.transformQuat=H;b.str=I;b.exactEquals=J;b.equals=K;h=c(0);var d=a(h);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){var a=new d.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a}function h(a){var b=new d.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b}function i(a,b,c,e){var f=new d.ARRAY_TYPE(4);f[0]=a;f[1]=b;f[2]=c;f[3]=e;return f}function j(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function k(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a}function l(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a}function m(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}function n(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a}function o(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a}function p(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a}function q(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a}function r(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a}function s(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a}function t(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a}function u(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a}function v(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;return b}function w(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];b=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+b*b)}function x(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];b=b[3]-a[3];return c*c+d*d+e*e+b*b}function y(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)}function z(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a}function A(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a}function B(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a}function C(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*c+d*d+e*e+b*b;f>0&&(f=1/Math.sqrt(f),a[0]=c*f,a[1]=d*f,a[2]=e*f,a[3]=b*f);return a}function D(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function E(a,b,c,d){var e=b[0],f=b[1],g=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=g+d*(c[2]-g);a[3]=b+d*(c[3]-b);return a}function F(a,b){b=b||1;a[0]=d.RANDOM();a[1]=d.RANDOM();a[2]=d.RANDOM();a[3]=d.RANDOM();C(a,a);u(a,a,b);return a}function G(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*b;return a}function H(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];c=c[3];var j=c*d+h*f-i*e,k=c*e+i*d-g*f,l=c*f+g*e-h*d;d=-g*d-h*e-i*f;a[0]=j*c+d*-g+k*-i-l*-h;a[1]=k*c+d*-h+l*-g-j*-i;a[2]=l*c+d*-i+j*-h-k*-g;a[3]=b[3];return a}function I(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}function J(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}function K(a,b){var c=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],h=b[1],i=b[2];b=b[3];return Math.abs(c-g)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(e-h)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(f-i)<=d.EPSILON*Math.max(1,Math.abs(f),Math.abs(i))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}b.sub=m;b.mul=n;b.div=o;b.dist=w;b.sqrDist=x;b.len=y;b.sqrLen=z;b.forEach=function(){var a=g();return function(b,c,d,e,f,g){var h=void 0,i=void 0;c||(c=4);d||(d=0);e?i=Math.min(e*c+d,b.length):i=b.length;for(h=d;h<i;h+=c)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],a[3]=b[h+3],f(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2],b[h+3]=a[3];return b}}()},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.vec4=b.vec3=b.vec2=b.quat=b.mat4=b.mat3=b.mat2d=b.mat2=b.glMatrix=void 0;var d=c(0);d=a(d);var g=c(5);g=a(g);var h=c(6);h=a(h);var i=c(1);i=a(i);var j=c(7);j=a(j);var k=c(8);k=a(k);var l=c(9);l=a(l);var m=c(2);m=a(m);c=c(3);a=a(c);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}b.glMatrix=d;b.mat2=g;b.mat2d=h;b.mat3=i;b.mat4=j;b.quat=k;b.vec2=l;b.vec3=m;b.vec4=a},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.sub=b.mul=void 0;b.create=g;b.clone=h;b.copy=i;b.identity=j;b.fromValues=k;b.set=l;b.transpose=m;b.invert=n;b.adjoint=o;b.determinant=p;b.multiply=q;b.rotate=r;b.scale=s;b.fromRotation=t;b.fromScaling=u;b.str=v;b.frob=w;b.LDU=x;b.add=y;b.subtract=z;b.exactEquals=A;b.equals=B;b.multiplyScalar=C;b.multiplyScalarAndAdd=D;g=c(0);var d=a(g);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){var a=new d.ARRAY_TYPE(4);a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a}function h(a){var b=new d.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b}function i(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function j(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a}function k(a,b,c,e){var f=new d.ARRAY_TYPE(4);f[0]=a;f[1]=b;f[2]=c;f[3]=e;return f}function l(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a}function m(a,b){if(a===b){var c=b[1];a[1]=b[2];a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a}function n(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*b-e*d;if(!f)return null;f=1/f;a[0]=b*f;a[1]=-d*f;a[2]=-e*f;a[3]=c*f;return a}function o(a,b){var c=b[0];a[0]=b[3];a[1]=-b[1];a[2]=-b[2];a[3]=c;return a}function p(a){return a[0]*a[3]-a[2]*a[1]}function q(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2];c=c[3];a[0]=d*g+f*h;a[1]=e*g+b*h;a[2]=d*i+f*c;a[3]=e*i+b*c;return a}function r(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+f*g;a[1]=e*c+b*g;a[2]=d*-g+f*c;a[3]=e*-g+b*c;return a}function s(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0];c=c[1];a[0]=d*g;a[1]=e*g;a[2]=f*c;a[3]=b*c;return a}function t(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=-c;a[3]=b;return a}function u(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];return a}function v(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}function w(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))}function x(a,b,c,d){a[2]=d[2]/d[0];c[0]=d[0];c[1]=d[1];c[3]=d[3]-a[2]*c[1];return[a,b,c]}function y(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a}function z(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}function A(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}function B(a,b){var c=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],h=b[1],i=b[2];b=b[3];return Math.abs(c-g)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(e-h)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(f-i)<=d.EPSILON*Math.max(1,Math.abs(f),Math.abs(i))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}function C(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a}function D(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;return b}b.mul=q;b.sub=z},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.sub=b.mul=void 0;b.create=g;b.clone=h;b.copy=i;b.identity=j;b.fromValues=k;b.set=l;b.invert=m;b.determinant=n;b.multiply=o;b.rotate=p;b.scale=q;b.translate=r;b.fromRotation=s;b.fromScaling=t;b.fromTranslation=u;b.str=v;b.frob=w;b.add=x;b.subtract=y;b.multiplyScalar=z;b.multiplyScalarAndAdd=A;b.exactEquals=B;b.equals=C;g=c(0);var d=a(g);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){var a=new d.ARRAY_TYPE(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function h(a){var b=new d.ARRAY_TYPE(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b}function i(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function j(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function k(a,b,c,e,f,g){var h=new d.ARRAY_TYPE(6);h[0]=a;h[1]=b;h[2]=c;h[3]=e;h[4]=f;h[5]=g;return h}function l(a,b,c,d,e,f,g){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;return a}function m(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4];b=b[5];var h=c*f-d*e;if(!h)return null;h=1/h;a[0]=f*h;a[1]=-d*h;a[2]=-e*h;a[3]=c*h;a[4]=(e*b-f*g)*h;a[5]=(d*g-c*b)*h;return a}function n(a){return a[0]*a[3]-a[1]*a[2]}function o(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0],j=c[1],k=c[2],l=c[3],m=c[4];c=c[5];a[0]=d*i+f*j;a[1]=e*i+g*j;a[2]=d*k+f*l;a[3]=e*k+g*l;a[4]=d*m+f*c+h;a[5]=e*m+g*c+b;return a}function p(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=Math.sin(c);c=Math.cos(c);a[0]=d*c+f*i;a[1]=e*c+g*i;a[2]=d*-i+f*c;a[3]=e*-i+g*c;a[4]=h;a[5]=b;return a}function q(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0];c=c[1];a[0]=d*i;a[1]=e*i;a[2]=f*c;a[3]=g*c;a[4]=h;a[5]=b;return a}function r(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=d*i+f*c+h;a[5]=e*i+g*c+b;return a}function s(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=-c;a[3]=b;a[4]=0;a[5]=0;return a}function t(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a}function u(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a}function v(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function w(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)}function x(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];return a}function y(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];return a}function z(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;return a}function A(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;b[4]=c[4]+d[4]*a;b[5]=c[5]+d[5]*a;return b}function B(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]}function C(a,b){var c=a[0],e=a[1],f=a[2],g=a[3],h=a[4];a=a[5];var i=b[0],j=b[1],k=b[2],l=b[3],m=b[4];b=b[5];return Math.abs(c-i)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(i))&&Math.abs(e-j)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(j))&&Math.abs(f-k)<=d.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(g-l)<=d.EPSILON*Math.max(1,Math.abs(g),Math.abs(l))&&Math.abs(h-m)<=d.EPSILON*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}b.mul=o;b.sub=y},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.sub=b.mul=void 0;b.create=g;b.clone=h;b.copy=i;b.fromValues=j;b.set=k;b.identity=l;b.transpose=m;b.invert=n;b.adjoint=o;b.determinant=p;b.multiply=q;b.translate=r;b.scale=s;b.rotate=t;b.rotateX=u;b.rotateY=v;b.rotateZ=w;b.fromTranslation=x;b.fromScaling=y;b.fromRotation=z;b.fromXRotation=A;b.fromYRotation=B;b.fromZRotation=C;b.fromRotationTranslation=D;b.getTranslation=E;b.getScaling=F;b.getRotation=G;b.fromRotationTranslationScale=H;b.fromRotationTranslationScaleOrigin=I;b.fromQuat=J;b.frustum=K;b.perspective=L;b.perspectiveFromFieldOfView=M;b.ortho=N;b.lookAt=O;b.targetTo=P;b.str=Q;b.frob=R;b.add=S;b.subtract=T;b.multiplyScalar=U;b.multiplyScalarAndAdd=V;b.exactEquals=W;b.equals=X;g=c(0);var d=a(g);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){__p&&__p();var a=new d.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function h(a){__p&&__p();var b=new d.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b}function i(a,b){__p&&__p();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}function j(a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q){__p&&__p();var r=new d.ARRAY_TYPE(16);r[0]=a;r[1]=b;r[2]=c;r[3]=e;r[4]=f;r[5]=g;r[6]=h;r[7]=i;r[8]=j;r[9]=k;r[10]=l;r[11]=m;r[12]=n;r[13]=o;r[14]=p;r[15]=q;return r}function k(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){__p&&__p();a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=i;a[8]=j;a[9]=k;a[10]=l;a[11]=m;a[12]=n;a[13]=o;a[14]=p;a[15]=q;return a}function l(a){__p&&__p();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function m(a,b){__p&&__p();if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}function n(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14];b=b[15];var r=c*h-d*g,s=c*i-e*g,t=c*j-f*g,u=d*i-e*h,v=d*j-f*h,w=e*j-f*i,x=k*p-l*o,y=k*q-m*o,z=k*b-n*o,A=l*q-m*p,B=l*b-n*p,C=m*b-n*q,D=r*C-s*B+t*A+u*z-v*y+w*x;if(!D)return null;D=1/D;a[0]=(h*C-i*B+j*A)*D;a[1]=(e*B-d*C-f*A)*D;a[2]=(p*w-q*v+b*u)*D;a[3]=(m*v-l*w-n*u)*D;a[4]=(i*z-g*C-j*y)*D;a[5]=(c*C-e*z+f*y)*D;a[6]=(q*t-o*w-b*s)*D;a[7]=(k*w-m*t+n*s)*D;a[8]=(g*B-h*z+j*x)*D;a[9]=(d*z-c*B-f*x)*D;a[10]=(o*v-p*t+b*r)*D;a[11]=(l*t-k*v-n*r)*D;a[12]=(h*y-g*A-i*x)*D;a[13]=(c*A-d*y+e*x)*D;a[14]=(p*s-o*u-q*r)*D;a[15]=(k*u-l*s+m*r)*D;return a}function o(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14];b=b[15];a[0]=h*(m*b-n*q)-l*(i*b-j*q)+p*(i*n-j*m);a[1]=-(d*(m*b-n*q)-l*(e*b-f*q)+p*(e*n-f*m));a[2]=d*(i*b-j*q)-h*(e*b-f*q)+p*(e*j-f*i);a[3]=-(d*(i*n-j*m)-h*(e*n-f*m)+l*(e*j-f*i));a[4]=-(g*(m*b-n*q)-k*(i*b-j*q)+o*(i*n-j*m));a[5]=c*(m*b-n*q)-k*(e*b-f*q)+o*(e*n-f*m);a[6]=-(c*(i*b-j*q)-g*(e*b-f*q)+o*(e*j-f*i));a[7]=c*(i*n-j*m)-g*(e*n-f*m)+k*(e*j-f*i);a[8]=g*(l*b-n*p)-k*(h*b-j*p)+o*(h*n-j*l);a[9]=-(c*(l*b-n*p)-k*(d*b-f*p)+o*(d*n-f*l));a[10]=c*(h*b-j*p)-g*(d*b-f*p)+o*(d*j-f*h);a[11]=-(c*(h*n-j*l)-g*(d*n-f*l)+k*(d*j-f*h));a[12]=-(g*(l*q-m*p)-k*(h*q-i*p)+o*(h*m-i*l));a[13]=c*(l*q-m*p)-k*(d*q-e*p)+o*(d*m-e*l);a[14]=-(c*(h*q-i*p)-g*(d*q-e*p)+o*(d*i-e*h));a[15]=c*(h*m-i*l)-g*(d*m-e*l)+k*(d*i-e*h);return a}function p(a){__p&&__p();var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14];a=a[15];var q=b*g-c*f,r=b*h-d*f;b=b*i-e*f;f=c*h-d*g;c=c*i-e*g;g=d*i-e*h;d=j*o-k*n;i=j*p-l*n;e=j*a-m*n;h=k*p-l*o;j=k*a-m*o;n=l*a-m*p;return q*n-r*j+b*h+f*e-c*i+g*d}function q(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14];b=b[15];var s=c[0],t=c[1],u=c[2],v=c[3];a[0]=s*d+t*h+u*l+v*p;a[1]=s*e+t*i+u*m+v*q;a[2]=s*f+t*j+u*n+v*r;a[3]=s*g+t*k+u*o+v*b;s=c[4];t=c[5];u=c[6];v=c[7];a[4]=s*d+t*h+u*l+v*p;a[5]=s*e+t*i+u*m+v*q;a[6]=s*f+t*j+u*n+v*r;a[7]=s*g+t*k+u*o+v*b;s=c[8];t=c[9];u=c[10];v=c[11];a[8]=s*d+t*h+u*l+v*p;a[9]=s*e+t*i+u*m+v*q;a[10]=s*f+t*j+u*n+v*r;a[11]=s*g+t*k+u*o+v*b;s=c[12];t=c[13];u=c[14];v=c[15];a[12]=s*d+t*h+u*l+v*p;a[13]=s*e+t*i+u*m+v*q;a[14]=s*f+t*j+u*n+v*r;a[15]=s*g+t*k+u*o+v*b;return a}function r(a,b,c){var d=c[0],e=c[1];c=c[2];var f,g,h,i,j,k,l,m,n,o,p,q;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7],n=b[8],o=b[9],p=b[10],q=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=i,a[4]=j,a[5]=k,a[6]=l,a[7]=m,a[8]=n,a[9]=o,a[10]=p,a[11]=q,a[12]=f*d+j*e+n*c+b[12],a[13]=g*d+k*e+o*c+b[13],a[14]=h*d+l*e+p*c+b[14],a[15]=i*d+m*e+q*c+b[15]);return a}function s(a,b,c){__p&&__p();var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}function t(a,b,c,e){__p&&__p();var f=e[0],g=e[1];e=e[2];var h=Math.sqrt(f*f+g*g+e*e),i=void 0,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(Math.abs(h)<d.EPSILON)return null;h=1/h;f*=h;g*=h;e*=h;i=Math.sin(c);h=Math.cos(c);c=1-h;j=b[0];k=b[1];l=b[2];m=b[3];n=b[4];o=b[5];p=b[6];q=b[7];r=b[8];s=b[9];t=b[10];u=b[11];v=f*f*c+h;w=g*f*c+e*i;x=e*f*c-g*i;y=f*g*c-e*i;z=g*g*c+h;A=e*g*c+f*i;B=f*e*c+g*i;g=g*e*c-f*i;f=e*e*c+h;a[0]=j*v+n*w+r*x;a[1]=k*v+o*w+s*x;a[2]=l*v+p*w+t*x;a[3]=m*v+q*w+u*x;a[4]=j*y+n*z+r*A;a[5]=k*y+o*z+s*A;a[6]=l*y+p*z+t*A;a[7]=m*y+q*z+u*A;a[8]=j*B+n*g+r*f;a[9]=k*B+o*g+s*f;a[10]=l*B+p*g+t*f;a[11]=m*B+q*g+u*f;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a}function u(a,b,c){__p&&__p();var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],h=b[7],i=b[8],j=b[9],k=b[10],l=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+i*d;a[5]=f*c+j*d;a[6]=g*c+k*d;a[7]=h*c+l*d;a[8]=i*c-e*d;a[9]=j*c-f*d;a[10]=k*c-g*d;a[11]=l*c-h*d;return a}function v(a,b,c){__p&&__p();var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],i=b[8],j=b[9],k=b[10],l=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-i*d;a[1]=f*c-j*d;a[2]=g*c-k*d;a[3]=h*c-l*d;a[8]=e*d+i*c;a[9]=f*d+j*c;a[10]=g*d+k*c;a[11]=h*d+l*c;return a}function w(a,b,c){__p&&__p();var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=b[5],k=b[6],l=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+i*d;a[1]=f*c+j*d;a[2]=g*c+k*d;a[3]=h*c+l*d;a[4]=i*c-e*d;a[5]=j*c-f*d;a[6]=k*c-g*d;a[7]=l*c-h*d;return a}function x(a,b){__p&&__p();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a}function y(a,b){__p&&__p();a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function z(a,b,c){__p&&__p();var e=c[0],f=c[1];c=c[2];var g=Math.sqrt(e*e+f*f+c*c),h=void 0;if(Math.abs(g)<d.EPSILON)return null;g=1/g;e*=g;f*=g;c*=g;h=Math.sin(b);g=Math.cos(b);b=1-g;a[0]=e*e*b+g;a[1]=f*e*b+c*h;a[2]=c*e*b-f*h;a[3]=0;a[4]=e*f*b-c*h;a[5]=f*f*b+g;a[6]=c*f*b+e*h;a[7]=0;a[8]=e*c*b+f*h;a[9]=f*c*b-e*h;a[10]=c*c*b+g;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function A(a,b){__p&&__p();var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function B(a,b){__p&&__p();var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function C(a,b){__p&&__p();var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function D(a,b,c){__p&&__p();var d=b[0],e=b[1],f=b[2];b=b[3];var g=d+d,h=e+e,i=f+f,j=d*g,k=d*h;d=d*i;var l=e*h;e=e*i;f=f*i;g=b*g;h=b*h;b=b*i;a[0]=1-(l+f);a[1]=k+b;a[2]=d-h;a[3]=0;a[4]=k-b;a[5]=1-(j+f);a[6]=e+g;a[7]=0;a[8]=d+h;a[9]=e-g;a[10]=1-(j+l);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}function E(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a}function F(a,b){var c=b[0],d=b[1],e=b[2],f=b[4],g=b[5],h=b[6],i=b[8],j=b[9];b=b[10];a[0]=Math.sqrt(c*c+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(i*i+j*j+b*b);return a}function G(a,b){var c=b[0]+b[5]+b[10];c>0?(c=Math.sqrt(c+1)*2,a[3]=.25*c,a[0]=(b[6]-b[9])/c,a[1]=(b[8]-b[2])/c,a[2]=(b[1]-b[4])/c):b[0]>b[5]&b[0]>b[10]?(c=Math.sqrt(1+b[0]-b[5]-b[10])*2,a[3]=(b[6]-b[9])/c,a[0]=.25*c,a[1]=(b[1]+b[4])/c,a[2]=(b[8]+b[2])/c):b[5]>b[10]?(c=Math.sqrt(1+b[5]-b[0]-b[10])*2,a[3]=(b[8]-b[2])/c,a[0]=(b[1]+b[4])/c,a[1]=.25*c,a[2]=(b[6]+b[9])/c):(c=Math.sqrt(1+b[10]-b[0]-b[5])*2,a[3]=(b[1]-b[4])/c,a[0]=(b[8]+b[2])/c,a[1]=(b[6]+b[9])/c,a[2]=.25*c);return a}function H(a,b,c,d){__p&&__p();var e=b[0],f=b[1],g=b[2];b=b[3];var h=e+e,i=f+f,j=g+g,k=e*h,l=e*i;e=e*j;var m=f*i;f=f*j;g=g*j;h=b*h;i=b*i;b=b*j;j=d[0];var n=d[1];d=d[2];a[0]=(1-(m+g))*j;a[1]=(l+b)*j;a[2]=(e-i)*j;a[3]=0;a[4]=(l-b)*n;a[5]=(1-(k+g))*n;a[6]=(f+h)*n;a[7]=0;a[8]=(e+i)*d;a[9]=(f-h)*d;a[10]=(1-(k+m))*d;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}function I(a,b,c,d,e){__p&&__p();var f=b[0],g=b[1],h=b[2];b=b[3];var i=f+f,j=g+g,k=h+h,l=f*i,m=f*j;f=f*k;var n=g*j;g=g*k;h=h*k;i=b*i;j=b*j;b=b*k;k=d[0];var o=d[1];d=d[2];var p=e[0],q=e[1];e=e[2];a[0]=(1-(n+h))*k;a[1]=(m+b)*k;a[2]=(f-j)*k;a[3]=0;a[4]=(m-b)*o;a[5]=(1-(l+h))*o;a[6]=(g+i)*o;a[7]=0;a[8]=(f+j)*d;a[9]=(g-i)*d;a[10]=(1-(l+n))*d;a[11]=0;a[12]=c[0]+p-(a[0]*p+a[4]*q+a[8]*e);a[13]=c[1]+q-(a[1]*p+a[5]*q+a[9]*e);a[14]=c[2]+e-(a[2]*p+a[6]*q+a[10]*e);a[15]=1;return a}function J(a,b){__p&&__p();var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,g=d+d,h=e+e;c=c*f;var i=d*f;d=d*g;var j=e*f,k=e*g;e=e*h;f=b*f;g=b*g;b=b*h;a[0]=1-d-e;a[1]=i+b;a[2]=j-g;a[3]=0;a[4]=i-b;a[5]=1-c-e;a[6]=k+f;a[7]=0;a[8]=j+g;a[9]=k-f;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function K(a,b,c,d,e,f,g){__p&&__p();var h=1/(c-b),i=1/(e-d),j=1/(f-g);a[0]=f*2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=f*2*i;a[6]=0;a[7]=0;a[8]=(c+b)*h;a[9]=(e+d)*i;a[10]=(g+f)*j;a[11]=-1;a[12]=0;a[13]=0;a[14]=g*f*2*j;a[15]=0;return a}function L(a,b,c,d,e){__p&&__p();b=1/Math.tan(b/2);var f=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*f;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*f;a[15]=0;return a}function M(a,b,c,d){__p&&__p();var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var h=2/(g+b),i=2/(e+f);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=i;a[6]=0;a[7]=0;a[8]=-((g-b)*h*.5);a[9]=(e-f)*i*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a}function N(a,b,c,d,e,f,g){__p&&__p();var h=1/(b-c),i=1/(d-e),j=1/(f-g);a[0]=-2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*i;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*j;a[11]=0;a[12]=(b+c)*h;a[13]=(e+d)*i;a[14]=(g+f)*j;a[15]=1;return a}function O(a,b,c,e){__p&&__p();var f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=b[0],p=b[1];b=b[2];var q=e[0],r=e[1];e=e[2];var s=c[0],t=c[1];c=c[2];if(Math.abs(o-s)<d.EPSILON&&Math.abs(p-t)<d.EPSILON&&Math.abs(b-c)<d.EPSILON)return mat4.identity(a);l=o-s;m=p-t;n=b-c;s=1/Math.sqrt(l*l+m*m+n*n);l*=s;m*=s;n*=s;f=r*n-e*m;g=e*l-q*n;h=q*m-r*l;s=Math.sqrt(f*f+g*g+h*h);!s?(f=0,g=0,h=0):(s=1/s,f*=s,g*=s,h*=s);i=m*h-n*g;j=n*f-l*h;k=l*g-m*f;s=Math.sqrt(i*i+j*j+k*k);!s?(i=0,j=0,k=0):(s=1/s,i*=s,j*=s,k*=s);a[0]=f;a[1]=i;a[2]=l;a[3]=0;a[4]=g;a[5]=j;a[6]=m;a[7]=0;a[8]=h;a[9]=k;a[10]=n;a[11]=0;a[12]=-(f*o+g*p+h*b);a[13]=-(i*o+j*p+k*b);a[14]=-(l*o+m*p+n*b);a[15]=1;return a}function P(a,b,c,d){__p&&__p();var e=b[0],f=b[1];b=b[2];var g=d[0],h=d[1];d=d[2];var i=e-c[0],j=f-c[1];c=b-c[2];var k=i*i+j*j+c*c;k>0&&(k=1/Math.sqrt(k),i*=k,j*=k,c*=k);k=h*c-d*j;d=d*i-g*c;g=g*j-h*i;a[0]=k;a[1]=d;a[2]=g;a[3]=0;a[4]=j*g-c*d;a[5]=c*k-i*g;a[6]=i*d-j*k;a[7]=0;a[8]=i;a[9]=j;a[10]=c;a[11]=0;a[12]=e;a[13]=f;a[14]=b;a[15]=1;return a}function Q(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}function R(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}function S(a,b,c){__p&&__p();a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a}function T(a,b,c){__p&&__p();a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a}function U(a,b,c){__p&&__p();a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a}function V(b,c,d,a){__p&&__p();b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;b[4]=c[4]+d[4]*a;b[5]=c[5]+d[5]*a;b[6]=c[6]+d[6]*a;b[7]=c[7]+d[7]*a;b[8]=c[8]+d[8]*a;b[9]=c[9]+d[9]*a;b[10]=c[10]+d[10]*a;b[11]=c[11]+d[11]*a;b[12]=c[12]+d[12]*a;b[13]=c[13]+d[13]*a;b[14]=c[14]+d[14]*a;b[15]=c[15]+d[15]*a;return b}function W(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]}function X(a,b){var c=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14];a=a[15];var s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8],B=b[9],C=b[10],D=b[11],E=b[12],F=b[13],G=b[14];b=b[15];return Math.abs(c-s)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(s))&&Math.abs(e-t)<=d.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))&&Math.abs(f-u)<=d.EPSILON*Math.max(1,Math.abs(f),Math.abs(u))&&Math.abs(g-v)<=d.EPSILON*Math.max(1,Math.abs(g),Math.abs(v))&&Math.abs(h-w)<=d.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(i-x)<=d.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(j-y)<=d.EPSILON*Math.max(1,Math.abs(j),Math.abs(y))&&Math.abs(k-z)<=d.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(l-A)<=d.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(m-B)<=d.EPSILON*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(n-C)<=d.EPSILON*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(o-D)<=d.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(p-E)<=d.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(q-F)<=d.EPSILON*Math.max(1,Math.abs(q),Math.abs(F))&&Math.abs(r-G)<=d.EPSILON*Math.max(1,Math.abs(r),Math.abs(G))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}b.mul=q;b.sub=T},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.setAxes=b.sqlerp=b.rotationTo=b.equals=b.exactEquals=b.normalize=b.sqrLen=b.squaredLength=b.len=b.length=b.lerp=b.dot=b.scale=b.mul=b.add=b.set=b.copy=b.fromValues=b.clone=void 0;b.create=i;b.identity=j;b.setAxisAngle=k;b.getAxisAngle=l;b.multiply=m;b.rotateX=n;b.rotateY=o;b.rotateZ=p;b.calculateW=q;b.slerp=r;b.invert=s;b.conjugate=t;b.fromMat3=u;b.fromEuler=v;b.str=w;j=c(0);var d=a(j);l=c(1);var g=a(l);n=c(2);var h=a(n);o=c(3);p=a(o);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function i(){var a=new d.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}function j(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}function k(a,b,c){c=c*.5;var d=Math.sin(c);a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=Math.cos(c);return a}function l(a,b){var c=Math.acos(b[3])*2,d=Math.sin(c/2);d!=0?(a[0]=b[0]/d,a[1]=b[1]/d,a[2]=b[2]/d):(a[0]=1,a[1]=0,a[2]=0);return c}function m(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2];c=c[3];a[0]=d*c+b*g+e*i-f*h;a[1]=e*c+b*h+f*g-d*i;a[2]=f*c+b*i+d*h-e*g;a[3]=b*c-d*g-e*h-f*i;return a}function n(a,b,c){__p&&__p();c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+b*g;a[1]=e*c+f*g;a[2]=f*c-e*g;a[3]=b*c-d*g;return a}function o(a,b,c){__p&&__p();c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c-f*g;a[1]=e*c+b*g;a[2]=f*c+d*g;a[3]=b*c-e*g;return a}function p(a,b,c){__p&&__p();c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+e*g;a[1]=e*c-d*g;a[2]=f*c+b*g;a[3]=b*c-f*g;return a}function q(a,b){var c=b[0],d=b[1];b=b[2];a[0]=c;a[1]=d;a[2]=b;a[3]=Math.sqrt(Math.abs(1-c*c-d*d-b*b));return a}function r(a,b,c,d){__p&&__p();var e=b[0],f=b[1],g=b[2];b=b[3];var h=c[0],i=c[1],j=c[2];c=c[3];var k=void 0,l,m=void 0,n=void 0;l=e*h+f*i+g*j+b*c;l<0&&(l=-l,h=-h,i=-i,j=-j,c=-c);1-l>1e-6?(k=Math.acos(l),m=Math.sin(k),n=Math.sin((1-d)*k)/m,l=Math.sin(d*k)/m):(n=1-d,l=d);a[0]=n*e+l*h;a[1]=n*f+l*i;a[2]=n*g+l*j;a[3]=n*b+l*c;return a}function s(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*c+d*d+e*e+b*b;f=f?1/f:0;a[0]=-c*f;a[1]=-d*f;a[2]=-e*f;a[3]=b*f;return a}function t(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a}function u(a,b){__p&&__p();var c=b[0]+b[4]+b[8];if(c>0)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[d*3+d]&&(d=2);var e=(d+1)%3,f=(d+2)%3;c=Math.sqrt(b[d*3+d]-b[e*3+e]-b[f*3+f]+1);a[d]=.5*c;c=.5/c;a[3]=(b[e*3+f]-b[f*3+e])*c;a[e]=(b[e*3+d]+b[d*3+e])*c;a[f]=(b[f*3+d]+b[d*3+f])*c}return a}function v(a,b,c,d){__p&&__p();var e=.5*Math.PI/180;b*=e;c*=e;d*=e;e=Math.sin(b);b=Math.cos(b);var f=Math.sin(c);c=Math.cos(c);var g=Math.sin(d);d=Math.cos(d);a[0]=e*c*d-b*f*g;a[1]=b*f*d+e*c*g;a[2]=b*c*g-e*f*d;a[3]=b*c*d+e*f*g;return a}function w(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}b.clone=p.clone;b.fromValues=p.fromValues;b.copy=p.copy;b.set=p.set;b.add=p.add;b.mul=m;b.scale=p.scale;b.dot=p.dot;b.lerp=p.lerp;q=b.length=p.length;b.len=q;s=b.squaredLength=p.squaredLength;b.sqrLen=s;var x=b.normalize=p.normalize;b.exactEquals=p.exactEquals;b.equals=p.equals;b.rotationTo=function(){__p&&__p();var a=h.create(),b=h.fromValues(1,0,0),c=h.fromValues(0,1,0);return function(d,e,f){__p&&__p();var g=h.dot(e,f);if(g<-.999999){h.cross(a,b,e);h.len(a)<1e-6&&h.cross(a,c,e);h.normalize(a,a);k(d,a,Math.PI);return d}else if(g>.999999){d[0]=0;d[1]=0;d[2]=0;d[3]=1;return d}else{h.cross(a,e,f);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=1+g;return x(d,d)}}}();b.sqlerp=function(){var a=i(),b=i();return function(c,d,e,f,g,h){r(a,d,g,h);r(b,e,f,h);r(c,a,b,2*h*(1-h));return c}}();b.setAxes=function(){__p&&__p();var a=g.create();return function(b,c,d,e){__p&&__p();a[0]=d[0];a[3]=d[1];a[6]=d[2];a[1]=e[0];a[4]=e[1];a[7]=e[2];a[2]=-c[0];a[5]=-c[1];a[8]=-c[2];return x(b,u(b,a))}}()},function(a,b,c){__p&&__p();Object.defineProperty(b,"__esModule",{value:!0});b.forEach=b.sqrLen=b.sqrDist=b.dist=b.div=b.mul=b.sub=b.len=void 0;b.create=g;b.clone=h;b.fromValues=i;b.copy=j;b.set=k;b.add=l;b.subtract=m;b.multiply=n;b.divide=o;b.ceil=p;b.floor=q;b.min=r;b.max=s;b.round=t;b.scale=u;b.scaleAndAdd=v;b.distance=w;b.squaredDistance=x;b.length=y;b.squaredLength=z;b.negate=A;b.inverse=B;b.normalize=C;b.dot=D;b.cross=E;b.lerp=F;b.random=G;b.transformMat2=H;b.transformMat2d=I;b.transformMat3=J;b.transformMat4=K;b.str=L;b.exactEquals=M;b.equals=N;h=c(0);var d=a(h);function a(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}}function g(){var a=new d.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a}function h(a){var b=new d.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b}function i(a,b){var c=new d.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c}function j(a,b){a[0]=b[0];a[1]=b[1];return a}function k(a,b,c){a[0]=b;a[1]=c;return a}function l(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a}function m(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}function n(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a}function o(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a}function p(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a}function q(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a}function r(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a}function s(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a}function t(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a}function u(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a}function v(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;return b}function w(a,b){var c=b[0]-a[0];b=b[1]-a[1];return Math.sqrt(c*c+b*b)}function x(a,b){var c=b[0]-a[0];b=b[1]-a[1];return c*c+b*b}function y(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)}function z(a){var b=a[0];a=a[1];return b*b+a*a}function A(a,b){a[0]=-b[0];a[1]=-b[1];return a}function B(a,b){a[0]=1/b[0];a[1]=1/b[1];return a}function C(a,b){var c=b[0],d=b[1];c=c*c+d*d;c>0&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a}function D(a,b){return a[0]*b[0]+a[1]*b[1]}function E(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a}function F(a,b,c,d){var e=b[0];b=b[1];a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a}function G(b,a){a=a||1;var c=d.RANDOM()*2*Math.PI;b[0]=Math.cos(c)*a;b[1]=Math.sin(c)*a;return b}function H(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a}function I(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a}function J(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a}function K(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a}function L(a){return"vec2("+a[0]+", "+a[1]+")"}function M(a,b){return a[0]===b[0]&&a[1]===b[1]}function N(a,b){var c=a[0];a=a[1];var e=b[0];b=b[1];return Math.abs(c-e)<=d.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&Math.abs(a-b)<=d.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}b.len=y;b.sub=m;b.mul=n;b.div=o;b.dist=w;b.sqrDist=x;b.sqrLen=z;b.forEach=function(){var a=g();return function(b,c,d,e,f,g){var h=void 0,i=void 0;c||(c=2);d||(d=0);e?i=Math.min(e*c+d,b.length):i=b.length;for(h=d;h<i;h+=c)a[0]=b[h],a[1]=b[h+1],f(a,a,g),b[h]=a[0],b[h+1]=a[1];return b}}()}])})}var k=!1,l=function(){k||(k=!0,j());return h.exports};a=function(a){switch(a){case void 0:return l()}};e.exports=a}),null);
__d("gl-matrix",["gl-matrix-2.4.0"],(function(a,b,c,d,e,f){e.exports=b("gl-matrix-2.4.0")()}),null);
__d("radToDeg",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a*180/Math.PI}e.exports=a}),null);
__d("SphericalPhotoProjectionUtils",["degToRad","gl-matrix","radToDeg"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("gl-matrix").glMatrix;var g=b("gl-matrix").mat4,h=b("gl-matrix").vec3;a={getMaxMinVfov:function(a,c){var d=b("degToRad")(a.partialRightDegrees||180),e=b("degToRad")(a.partialLeftDegrees||180),f=b("degToRad")(a.partialTopDegrees||90);a=b("degToRad")(a.partialBottomDegrees||90);d=(d+e)/2;e=(f+a)/2;f=2*Math.atan(d/c);a=this.getMinFullVfov(e,e);return{maxVfov:b("radToDeg")(Math.max(f,a)),minVfov:b("radToDeg")(Math.min(a,f/2))}},getMaxVfov:function(a,b){return this.getMaxMinVfov(a,b).maxVfov},getMinFullVfov:function(a,b){a=(a+b)/2;return 2*Math.atan(a)},getMinFullHfov:function(a,b){a=(a+b)/2;return 2*Math.atan(a)},getZoomProgressFromFov:function(a,b,c){return Math.max(0,Math.min(1,(a-c)/(b-c)))},getZoomProgress:function(a,b,c){b=this.getMaxMinVfov(b,c);c=b.maxVfov;b=b.minVfov;return this.getZoomProgressFromFov(a,c,b)},getHfov:function(a,b){a=2*Math.atan(Math.tan(a/2)*b);return a},normalizeLimits:function(a){__p&&__p();var b=a.partialLeftDegrees||0,c=a.partialRightDegrees||0,d=a.partialTopDegrees||0;a=a.partialBottomDegrees||0;if(b<0&&c<0){var e=Math.max(b,c);b-=e;c-=e}if(d<0&&a<0){e=Math.max(d,a);d-=e;a-=e}return{partialLeftDegrees:b,partialRightDegrees:c,partialTopDegrees:d,partialBottomDegrees:a}},getPartialLimits:function(a,c,d){__p&&__p();var e=this.getMaxMinVfov(d,c),f=e.maxVfov;e=e.minVfov;var g=b("degToRad")(a);c=this.getHfov(g,c);e=this.getZoomProgressFromFov(a,f,e);c=Math.tan(c/2);g=Math.tan(g/2);var h=Math.sin(c)*e+c*(1-e);c=Math.cos(c)*e+1*(1-e);var i=Math.sin(g)*e+g*(1-e);g=Math.cos(g)*e+1*(1-e);e=function(c,d,e){var g=Math.sin(c);c=Math.cos(c);return a>f?0:b("radToDeg")(Math.atan2(g*e-c*d,g*d+c*e))};var j=b("degToRad")(d.partialLeftDegrees||180),k=b("degToRad")(d.partialRightDegrees||180),l=b("degToRad")(d.partialTopDegrees||90);d=b("degToRad")(d.partialBottomDegrees||90);return this.normalizeLimits({partialLeftDegrees:e(j,h,c),partialRightDegrees:e(k,h,c),partialTopDegrees:e(l,i,g),partialBottomDegrees:e(d,i,g)})},projectVertex:function(a,b,c,d){__p&&__p();var e=a[0];a=a[1];var f=c?Math.sin(e):Math.sin(e)*Math.cos(a),g=c?a:Math.sin(a);c=c?Math.cos(e):Math.cos(e)*Math.cos(a);f=d*f+(1-d)*e;g=d*g+(1-d)*a;c=d*c+(1-d)*1;e=h.fromValues(f,g,c);h.transformMat4(e,e,b);return e},getSphericalFromVertex:function(a){var b=a[0],c=a[1];a=a[2];var d=Math.atan2(b,a);c=Math.atan2(c,Math.sqrt(b*b+a*a));return{yaw:d,pitch:c}},getRelativeHfov:function(a,c,d){a=this.getPartialLimits(a,c,d);c=d.partialLeftDegrees||180;d=d.partialRightDegrees||180;var e=a.partialLeftDegrees||0;a=a.partialRightDegrees||0;return b("degToRad")(d-a+c-e)},getRelativeVfov:function(a,c,d){a=this.getPartialLimits(a,c,d);c=d.partialTopDegrees||90;d=d.partialBottomDegrees||90;var e=a.partialTopDegrees||0;a=a.partialBottomDegrees||0;return b("degToRad")(c-e+d-a)},convert2dTo3d:function(a,c,d,e,f,i){__p&&__p();var j=e/f,k=e/2,l=f/2;a=(a-k)*(2/e);k=(c-l)*(2/f);e=b("degToRad")(d.fov);c=this.getHfov(e,j);l=this.getMinFullHfov(b("degToRad")(i.partialLeftDegrees||180),b("degToRad")(i.partialRightDegrees||180));f=Math.tan(e/2);e=Math.tan(c/2);c=Math.tan(Math.min(c,l)/2);l=a*e;a=-k*f;if(l>c||l<-c)return null;e=this.getZoomProgress(d.fov,i,j);k=g.create();g.rotateY(k,k,b("degToRad")(d.yaw));g.rotateX(k,k,-b("degToRad")(d.pitch));f=this.projectVertex(h.fromValues(l,a,-1),k,!1,e);c=this.getSphericalFromVertex(f);i=b("radToDeg")(c.yaw);return{yaw:i<0?360+i:i,pitch:b("radToDeg")(c.pitch)}},convert3dTo2d:function(a,c,d,e,f,i){__p&&__p();a=b("degToRad")(a);c=b("degToRad")(c);var j=b("degToRad")(d.fov),k=e/f,l=this.getHfov(j,k),m=this.getMinFullHfov(b("degToRad")(i.partialLeftDegrees||180),b("degToRad")(i.partialRightDegrees||180)),n=Math.tan(l/2);l=Math.tan(Math.min(l,m)/2);m=l/n;l=this.getMinFullVfov(b("degToRad")(i.partialTopDegrees||90),b("degToRad")(i.partialBottomDegrees||90));n=Math.tan(j/2);j=Math.tan(Math.min(j,l)/2);l=j/n;j=this.getRelativeHfov(d.fov,k,i);n=this.getRelativeVfov(d.fov,k,i);k=g.create();g.rotateY(k,k,b("degToRad")(d.yaw));g.rotateX(k,k,-b("degToRad")(d.pitch));g.invert(k,k);i=a+Math.PI;d=c+Math.PI/2;a=-Math.sin(d)*Math.sin(i);c=-Math.cos(d);d=-Math.sin(d)*Math.cos(i);i=h.fromValues(a,c,d);h.transformMat4(i,i,k);a=Math.atan2(i[0],i[2]);c=Math.atan2(i[1],Math.sqrt(i[0]*i[0]+i[2]*i[2]));d=.5+a*m/j;k=.5-c*l/n;return{x:d*e,y:k*f}}};e.exports=a}),null);
__d("calculateHFOVFromVFOV",["degToRad","radToDeg"],(function(a,b,c,d,e,f){"use strict";a=function(a,c){a=b("radToDeg")(Math.atan(Math.tan(b("degToRad")(a/2))*c)*2);return(a%360+360)%360};e.exports=a}),null);
__d("calculateVFOVFromHFOV",["degToRad","radToDeg"],(function(a,b,c,d,e,f){"use strict";a=function(a,c){a=b("radToDeg")(Math.atan(Math.tan(b("degToRad")(a)/2)/c))*2;return(a%360+360)%360};e.exports=a}),null);
__d("SphericalViewportControl",["csx","cx","invariant","Bootloader","CSS","DOMEventListener","DOMQuery","Event","EventEmitter","Keys","Parent","SphericalPhotoProjectionUtils","SubscriptionsHandler","UserAgent","VelocityTracker","calculateHFOVFromVFOV","calculateVFOVFromHFOV","debounce","degToRad","getElementRect","gkx","performanceNow","queryThenMutateDOM","radToDeg","requestAnimationFrame","throttle","uniqueID"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=b("DOMQuery").scry(window.document.body,"_li")[0]||window.document.body,k=navigator===void 0||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),l=.6,m=2.5,n=20,o=110,p=179,q=.01,r=1e3,s=.5,t=["W","A","S","D"].reduce(function(a,b){a[b]=b.charCodeAt(0);return a},{}),u={Up:"__tu",Down:"__tz",Left:"_2a6u",Right:"_2a6v",UpLeft:"__t-",UpRight:"__u0",DownLeft:"__u1",DownRight:"__u3"};a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g){__p&&__p();var h;e===void 0&&(e={});f===void 0&&(f=!1);g===void 0&&(g=j);h=a.call(this)||this;h.$SphericalViewportControl18=!1;h.$SphericalViewportControl19=!1;h.$SphericalViewportControl20=!1;h.$SphericalViewportControl45=!1;h.$SphericalViewportControl62=!1;h.$SphericalViewportControl64={x:1,y:1};h.$SphericalViewportControl65=!1;h.$SphericalViewportControl66=null;h.$SphericalViewportControl69=!1;h.$SphericalViewportControl70=!0;h.$SphericalViewportControl90=function(a){__p&&__p();a.deliberateSync=!0;if(h.$SphericalViewportControl67){if(a.shiftKey){var c=h.$SphericalViewportControl114(a),d=b("getElementRect")(h.$SphericalViewportControl32);if(c.x>d.left&&c.x<d.right&&c.y>d.top&&c.y<d.bottom){var e=(a.deltaX||0)+(a.deltaY||0)+(a.deltaZ||0),f=.5*(d.left+d.right),g=.5*(d.top+d.bottom);f={x:(c.x-f)/(d.right-d.left),y:(c.y-g)/(d.bottom-d.top)};h.emit("wheelScrollWithShiftKey",e,f)}a.preventDefault()}return}h.$SphericalViewportControl38&&a.preventDefault();h.$SphericalViewportControl124(a);h.$SphericalViewportControl46&&b("Event").kill(a)};h.$SphericalViewportControl127=function(a){h.emit("panningWithRightMouse",h.$SphericalViewportControl111());if(h.$SphericalViewportControl69){h.$SphericalViewportControl66=b("requestAnimationFrame")(h.$SphericalViewportControl127);return}h.emit("updateViewportEnd",h.$SphericalViewportControl26.x,h.$SphericalViewportControl26.y);h.$SphericalViewportControl15=!1;h.$SphericalViewportControl66=null};h.$SphericalViewportControl128=function(a){__p&&__p();var c=(a-h.$SphericalViewportControl59)/1e3;h.$SphericalViewportControl59=a;h.$SphericalViewportControl129();h.$SphericalViewportControl60||b("queryThenMutateDOM")(h.$SphericalViewportControl91.bind(babelHelpers.assertThisInitialized(h)),function(){return null});a=h.$SphericalViewportControl111();var d=!1;if(h.$SphericalViewportControl42&&h.$SphericalViewportControl54&&h.$SphericalViewportControl47&&!h.$SphericalViewportControl19&&!h.$SphericalViewportControl20){var e=h.$SphericalViewportControl130()*c;a.x+=e;var f=h.$SphericalViewportControl131()*c;a.y+=f;(e||f)&&(d=!0)}a.x+=h.$SphericalViewportControl8.getVelocityX()*c;a.y+=h.$SphericalViewportControl8.getVelocityY()*c;a.x+=h.$SphericalViewportControl9.getVelocityX()*c;a.y+=h.$SphericalViewportControl9.getVelocityY()*c;a.x*=h.$SphericalViewportControl64.x;a.y*=h.$SphericalViewportControl64.y;h.$SphericalViewportControl132(a.x,a.y);e=h.$SphericalViewportControl8.getSpeed()>0||h.$SphericalViewportControl9.getSpeed()>0;if(h.$SphericalViewportControl19||h.$SphericalViewportControl18||h.$SphericalViewportControl20||h.$SphericalViewportControl57||h.$SphericalViewportControl45||e||d)h.$SphericalViewportControl66=b("requestAnimationFrame")(h.$SphericalViewportControl128);else{h.$SphericalViewportControl15=!1;h.$SphericalViewportControl66=null;f={yaw:h.$SphericalViewportControl26.x,pitch:h.$SphericalViewportControl26.y};c=h.getCurrentViewport();h.$SphericalViewportControl4.pitch+=f.pitch-c.pitch;h.$SphericalViewportControl4.yaw-=f.yaw-c.yaw;h.emit("updateViewportEnd",h.$SphericalViewportControl26.x,h.$SphericalViewportControl26.y)}};h.$SphericalViewportControl124=b("throttle")(function(a){h.emit("wheelScroll",a);if(!h.$SphericalViewportControl46)return;a=(a.deltaX||0)+(a.deltaY||0)+(a.deltaZ||0);a=a/120*45/10;h.$SphericalViewportControl99(a)},30);h.$SphericalViewportControl70=e.listenOnlyOneElement==null?!0:e.listenOnlyOneElement;h.$SphericalViewportControl4={pitch:0,yaw:0};h.$SphericalViewportControl5=d.dragVelocityFactor||l;h.$SphericalViewportControl3=!1;h.$SphericalViewportControl8=new(b("VelocityTracker"))(300);h.$SphericalViewportControl9=new(b("VelocityTracker"))(300);h.$SphericalViewportControl13=new(b("SubscriptionsHandler"))();h.$SphericalViewportControl32=c;h.$SphericalViewportControl10=g;h.$SphericalViewportControl51=n;h.$SphericalViewportControl52=o;h.$SphericalViewportControl53=p;h.$SphericalViewportControl63=f;h.$SphericalViewportControl71(d);h.$SphericalViewportControl21={x:0,y:0};h.$SphericalViewportControl59=0;h.$SphericalViewportControl17={left:0,right:0,up:0,down:0};h.$SphericalViewportControl23={x:0,y:0};h.$SphericalViewportControl24={x:0,y:0};h.$SphericalViewportControl25=new(b("VelocityTracker"))();h.$SphericalViewportControl30=new Map();h.$SphericalViewportControl38=!1;h.$SphericalViewportControl22=!1;h.$SphericalViewportControl27=!1;h.$SphericalViewportControl72(e);h.$SphericalViewportControl57=!1;h.$SphericalViewportControl58=0;h.$SphericalViewportControl56=b("debounce")(function(){return h.emit("zoomStart")},r);h.$SphericalViewportControl37=h.$SphericalViewportControl73();h.$SphericalViewportControl61=[];h.$SphericalViewportControl31=h.addNewLayer(h.$SphericalViewportControl32);c=b("gkx")("678913");k&&c&&b("Bootloader").loadModules(["FullTilt"],function(a){a.getDeviceOrientation({type:"game"}).then(function(a){return h.$SphericalViewportControl74(a,d)})["catch"](function(a){return h.$SphericalViewportControl75(a)})},"SphericalViewportControl");return h}var d=c.prototype;d.$SphericalViewportControl74=function(a,c){var d=this;if(c.partialLimits){var e=c.partialLimits,f=this.getVerticalFieldOfView(),g=this.getHorizontalFieldOfView();this.$SphericalViewportControl6={top:(e.partialTopDegrees||Infinity)-f/2,bottom:-(e.partialBottomDegrees||Infinity)+f/2,left:-(e.partialLeftDegrees||Infinity)+g/2,right:(e.partialRightDegrees||Infinity)-g/2}}b("Bootloader").loadModules(["MSphericalViewportControlEuler"],function(b){d.$SphericalViewportControl2=new b(a,c,d.$SphericalViewportControl6),d.$SphericalViewportControl2.setActive(!0),d.$SphericalViewportControl1=a,d.$SphericalViewportControl1.start(function(){return d.$SphericalViewportControl76()}),d.$SphericalViewportControl3=!0},"SphericalViewportControl")};d.$SphericalViewportControl76=function(){var a={yaw:b("degToRad")(this.$SphericalViewportControl4.yaw-this.$SphericalViewportControl28.x),pitch:b("degToRad")(this.$SphericalViewportControl4.pitch+this.$SphericalViewportControl28.y)};this.$SphericalViewportControl2.onSensorUpdate();this.$SphericalViewportControl2.getRotationMatrix(a);a=this.getCurrentViewport();this.$SphericalViewportControl15||this.emit("viewportChange",a.yaw,a.pitch,this.$SphericalViewportControl11)};d.getCurrentViewport=function(){var a={yaw:b("degToRad")(this.$SphericalViewportControl4.yaw-this.$SphericalViewportControl28.x),pitch:b("degToRad")(this.$SphericalViewportControl4.pitch+this.$SphericalViewportControl28.y)};return!this.$SphericalViewportControl3?{pitch:b("radToDeg")(a.pitch),yaw:b("radToDeg")(a.yaw)}:this.$SphericalViewportControl2.getCurrentViewport(a)||{pitch:b("radToDeg")(a.pitch),yaw:b("radToDeg")(a.yaw)}};d.$SphericalViewportControl75=function(a){this.emit("sensorSetupError",{error:"SPHERICAL_GYROSCOPE_SETUP_FAILED",message:a})};d.isListening=function(a){return!this.$SphericalViewportControl70||Boolean(this.getSubscriptionKeyFromElement(a))};d.getSubscriptionKeyFromElement=function(a){__p&&__p();for(var b=this.$SphericalViewportControl30,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];if(e.element===a)return f}return null};d.addNewLayer=function(a){var c=this.getSubscriptionKeyFromElement(a);if(!c){c=b("uniqueID")();var d=new(b("SubscriptionsHandler"))();this.$SphericalViewportControl77(d,a);this.$SphericalViewportControl30.set(c,{handler:d,element:a})}return c};d.removeLayer=function(a){var b=this.$SphericalViewportControl30.get(a);b&&(b.handler.release(),this.$SphericalViewportControl30["delete"](a))};d.destroy=function(){this.removeAllListeners(),this.getSubscriptions().remove()};d.$SphericalViewportControl77=function(a,c){__p&&__p();var d=this;a.addSubscriptions(b("Event").listen(c,"mousedown",function(a){return d.$SphericalViewportControl78(a)}),b("Event").listen(c,"mouseenter",function(a){return d.$SphericalViewportControl79(a,c)}),b("Event").listen(c,"mouseleave",function(a){return d.$SphericalViewportControl80(a,c)}),b("Event").listen(c,"mousemove",function(a){return d.$SphericalViewportControl81(a)}),b("Event").listen(c,"mouseup",function(a){return d.$SphericalViewportControl82(a)}),b("Event").listen(c,"click",function(a){return d.$SphericalViewportControl83(a)}),b("Event").listen(c,"keydown",function(a){return d.$SphericalViewportControl84(a)}),b("Event").listen(c,"keyup",function(a){return d.$SphericalViewportControl85(a)}),b("Event").listen(c,"blur",function(a){return d.$SphericalViewportControl86(a)}),b("Event").listen(c,"touchstart",function(a){return d.$SphericalViewportControl87(a)}),b("Event").listen(c,"touchmove",function(a){return d.$SphericalViewportControl88(a)}),b("Event").listen(c,"touchend",function(a){return d.$SphericalViewportControl89(a)}),b("Event").listen(c,"touchcancel",function(a){return d.$SphericalViewportControl89(a)}),{remove:function(){b("DOMEventListener").remove(c,"wheel",function(a){return d.$SphericalViewportControl90(a)},{passive:!1})}})};d.$SphericalViewportControl71=function(a){__p&&__p();this.$SphericalViewportControl91();this.$SphericalViewportControl7=this.$SphericalViewportControl34/this.$SphericalViewportControl35;var b=a.fieldOfView;this.$SphericalViewportControl46=Boolean(a.enableZoom);this.$SphericalViewportControl29=(a.panningVelocityFactor||0)/15*80||80;this.$SphericalViewportControl16=(a.keyboardVelocityFactor||0)*1e3||80;a.partialLimits?(this.$SphericalViewportControl39=a.partialLimits,this.$SphericalViewportControl42=!0):(this.$SphericalViewportControl42=!1,this.$SphericalViewportControl39={partialLeftDegrees:null,partialRightDegrees:null,partialTopDegrees:null,partialBottomDegrees:null});this.$SphericalViewportControl40=this.$SphericalViewportControl39;this.$SphericalViewportControl41=1;this.$SphericalViewportControl63&&(this.$SphericalViewportControl42=!0);this.$SphericalViewportControl28={x:a.initialHeading,y:a.initialPitch};a=this.$SphericalViewportControl39;var c=a.partialTopDegrees;a=a.partialBottomDegrees;if(!this.$SphericalViewportControl63&&(c||c===0)&&(a||a===0)){c=c;a=a;var d=c+a;b>d&&(b=d,this.$SphericalViewportControl28.y=(c-a)/2)}this.$SphericalViewportControl11=this.$SphericalViewportControl92(b);this.$SphericalViewportControl12=this.$SphericalViewportControl11;this.$SphericalViewportControl93();this.$SphericalViewportControl26={x:this.$SphericalViewportControl28.x,y:this.$SphericalViewportControl28.y}};d.$SphericalViewportControl72=function(a){a===void 0&&(a={}),this.$SphericalViewportControl43=a.enableGyro||!1,this.$SphericalViewportControl44=a.slipFactor||0,this.$SphericalViewportControl47=a.springFactor||0,this.$SphericalViewportControl48=a.maxSpringDegrees||15,this.$SphericalViewportControl49=a.maxStretchXDegrees||20,this.$SphericalViewportControl50=a.maxStretchYDegrees||20,this.$SphericalViewportControl55=a.rubberBandConstant||0,this.$SphericalViewportControl54=a.enableRubberBanding||!1,this.$SphericalViewportControl67=a.enableZoomWithShiftKey||!1,this.$SphericalViewportControl68=a.enablePanningWithRightMouse||!1,this.$SphericalViewportControl60=a.disableAutoClientSizeUpdate||!1};d.reconfigure=function(a){this.$SphericalViewportControl71(a)};d.reconfigureControlConfig=function(a){a===void 0&&(a={}),this.$SphericalViewportControl72(a)};d.setEnableGyro=function(a){this.$SphericalViewportControl43=a};d.$SphericalViewportControl78=function(a){this.$SphericalViewportControl65&&this.$SphericalViewportControl94(),this.isListening(a.target)&&(this.$SphericalViewportControl19=!0,this.$SphericalViewportControl95(a))};d.$SphericalViewportControl87=function(a){this.$SphericalViewportControl62=!1,this.$SphericalViewportControl65&&this.$SphericalViewportControl94(),this.$SphericalViewportControl20?(this.$SphericalViewportControl96(a),this.$SphericalViewportControl20=!1):this.$SphericalViewportControl20=!0,this.$SphericalViewportControl95(a)};d.$SphericalViewportControl96=function(a){a.touches.length===2&&this.$SphericalViewportControl46&&(this.$SphericalViewportControl57=!0,this.$SphericalViewportControl58=this.$SphericalViewportControl97(a))};d.$SphericalViewportControl88=function(a){this.$SphericalViewportControl62=!0,this.$SphericalViewportControl57&&(this.$SphericalViewportControl98(a),this.$SphericalViewportControl46&&b("Event").kill(a))};d.$SphericalViewportControl98=function(a){a=this.$SphericalViewportControl97(a);var b=this.$SphericalViewportControl11*(this.$SphericalViewportControl58/a);b=b-this.$SphericalViewportControl11;this.$SphericalViewportControl99(b);this.$SphericalViewportControl58=a};d.$SphericalViewportControl97=function(a){var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;return Math.sqrt(Math.pow(b,2)+Math.pow(a,2))};d.$SphericalViewportControl89=function(a){this.$SphericalViewportControl62||(a.target.focus(a),this.$SphericalViewportControl83(a)),this.$SphericalViewportControl57?this.$SphericalViewportControl57=!1:this.$SphericalViewportControl20&&this.$SphericalViewportControl100(a)};d.$SphericalViewportControl95=function(a){this.emit("onMovementStart"),this.$SphericalViewportControl101(),this.$SphericalViewportControl102(a),this.$SphericalViewportControl103(a),this.$SphericalViewportControl68&&(a.which===3||a.button===2)&&(this.$SphericalViewportControl69=!0,this.$SphericalViewportControl15=!1),this.$SphericalViewportControl104(),a.preventDefault()};d.$SphericalViewportControl100=function(a){this.$SphericalViewportControl45&&!this.$SphericalViewportControl19&&(this.$SphericalViewportControl105(),this.$SphericalViewportControl45=!1)};d.$SphericalViewportControl106=function(a){this.$SphericalViewportControl65&&this.$SphericalViewportControl94()};d.$SphericalViewportControl107=function(a){this.$SphericalViewportControl103(a),this.$SphericalViewportControl14=!0,this.emit("updateViewportMove")};d.$SphericalViewportControl108=function(a){this.$SphericalViewportControl45&&(this.$SphericalViewportControl109(a),this.emit("updateViewportMove"))};d.$SphericalViewportControl101=function(){this.$SphericalViewportControl15=!1,this.$SphericalViewportControl45=!1,this.$SphericalViewportControl43=!1};d.$SphericalViewportControl110=function(a){this.$SphericalViewportControl103(a),this.$SphericalViewportControl111(),this.$SphericalViewportControl94(),this.$SphericalViewportControl105(),a.preventDefault()};d.$SphericalViewportControl94=function(a){var c=this;this.$SphericalViewportControl65=!1;b("queryThenMutateDOM")(function(){},function(){return c.$SphericalViewportControl32.style.cursor=""});this.$SphericalViewportControl20=!1;this.$SphericalViewportControl19=!1;this.$SphericalViewportControl69=!1;this.$SphericalViewportControl13.release();this.$SphericalViewportControl36&&(b("CSS").removeClass(this.$SphericalViewportControl10,this.$SphericalViewportControl36),this.$SphericalViewportControl36="")};d.$SphericalViewportControl112=function(a){if(this.$SphericalViewportControl20&&a.changedTouches)return a.changedTouches[0];else if(this.$SphericalViewportControl19)return a;else if(this.$SphericalViewportControl45)return a;return null};d.setMovementPosition=function(a){this.$SphericalViewportControl23=this.$SphericalViewportControl113(a)};d.$SphericalViewportControl113=function(a){a=this.$SphericalViewportControl112(a);return!a?this.$SphericalViewportControl23:{x:a.screenX,y:a.screenY}};d.$SphericalViewportControl114=function(a){a=this.$SphericalViewportControl112(a);return!a?this.$SphericalViewportControl24:{x:a.clientX,y:a.clientY}};d.$SphericalViewportControl102=function(a){__p&&__p();var c=this;this.$SphericalViewportControl65=!0;this.$SphericalViewportControl23=this.$SphericalViewportControl113(a);this.$SphericalViewportControl21={x:0,y:0};this.$SphericalViewportControl25=new(b("VelocityTracker"))();this.$SphericalViewportControl9=new(b("VelocityTracker"))(300);b("queryThenMutateDOM")(function(){},function(){return c.$SphericalViewportControl32.style.cursor=c.$SphericalViewportControl37});this.$SphericalViewportControl13.engage();a=this.$SphericalViewportControl10;this.$SphericalViewportControl20?this.$SphericalViewportControl13.addSubscriptions(b("Event").listen(a,"touchmove",function(a){return c.$SphericalViewportControl107(a)}),b("Event").listen(a,"touchend",function(a){return c.$SphericalViewportControl110(a)}),b("Event").listen(a,"touchcancel",function(a){return c.$SphericalViewportControl106(a)})):this.$SphericalViewportControl13.addSubscriptions(b("Event").listen(a,"mousemove",function(a){return c.$SphericalViewportControl107(a)}),b("Event").listen(a,"mouseup",function(a){return c.$SphericalViewportControl110(a)}),b("Event").listen(a,"mouseleave",function(a){return c.$SphericalViewportControl106(a)}))};d.$SphericalViewportControl109=function(a){this.$SphericalViewportControl115(a,this.$SphericalViewportControl44)};d.$SphericalViewportControl103=function(a){this.$SphericalViewportControl115(a,1)};d.reEnableGyro=function(){this.$SphericalViewportControl21={x:0,y:0},this.$SphericalViewportControl43=!0,this.$SphericalViewportControl45=!0,this.$SphericalViewportControl94()};d.$SphericalViewportControl115=function(a,b){var c=this.$SphericalViewportControl113(a),d=c.x-this.$SphericalViewportControl23.x,e=c.y-this.$SphericalViewportControl23.y,f=this.$SphericalViewportControl22?{x:0,y:0}:this.$SphericalViewportControl21;this.$SphericalViewportControl21={x:b*(c.x-this.$SphericalViewportControl23.x)+f.x,y:b*(c.y-this.$SphericalViewportControl23.y)+f.y};this.$SphericalViewportControl4.yaw+=d*this.$SphericalViewportControl5;this.$SphericalViewportControl4.pitch+=e*this.$SphericalViewportControl5;this.$SphericalViewportControl22=!1;this.$SphericalViewportControl23=c;this.$SphericalViewportControl25.update(c.x,c.y);this.$SphericalViewportControl24=this.$SphericalViewportControl114(a)};d.$SphericalViewportControl116=function(){var a=this.$SphericalViewportControl117(),b=-this.$SphericalViewportControl25.getVelocityX()*a;a=this.$SphericalViewportControl25.getVelocityY()*a;var c=this.$SphericalViewportControl45?this.$SphericalViewportControl44:1;this.$SphericalViewportControl118()&&(b=-b);return{x:b*c,y:a*c}};d.$SphericalViewportControl119=function(a,c){return b("radToDeg")(Math.atan(a/c))};d.$SphericalViewportControl120=function(a,b,c){return{x:this.$SphericalViewportControl119(a.x-this.$SphericalViewportControl34/2,c),y:-this.$SphericalViewportControl119(a.y-this.$SphericalViewportControl35/2,b)}};d.$SphericalViewportControl121=function(a,c){__p&&__p();var d={x:a.x-c.x,y:a.y-c.y},e=this.$SphericalViewportControl35/(2*Math.tan(b("degToRad")(this.getVerticalFieldOfView()/2))),f=e*Math.cos(b("degToRad")(this.$SphericalViewportControl26.y));f=f-(this.$SphericalViewportControl35/2-a.y)*Math.sin(b("degToRad")(this.$SphericalViewportControl26.y));if(this.$SphericalViewportControl26.y==-90&&c.y<0||this.$SphericalViewportControl26.y==90&&c.y>0){c=this.$SphericalViewportControl119(d.y-this.$SphericalViewportControl35/2,d.x-this.$SphericalViewportControl34/2);var g=this.$SphericalViewportControl119(a.y-this.$SphericalViewportControl35/2,a.x-this.$SphericalViewportControl34/2);g=g-c;g>90?g=180-g:g<-90&&(g=180+g);return{x:g*Math.sign(this.$SphericalViewportControl26.y),y:0}}else{c=this.$SphericalViewportControl120(d,e,f);g=this.$SphericalViewportControl120(a,e,f);return{x:c.x-g.x,y:c.y-g.y}}};d.$SphericalViewportControl118=function(){var a=this.$SphericalViewportControl33?this.$SphericalViewportControl33.top:b("getElementRect")(this.$SphericalViewportControl32).top;a=this.$SphericalViewportControl24.y-a;var c=this.$SphericalViewportControl35/(2*Math.tan(b("degToRad")(this.getVerticalFieldOfView()/2)));c=-c/Math.tan(b("degToRad")(this.$SphericalViewportControl26.y))+this.$SphericalViewportControl35/2;a=a>c&&this.$SphericalViewportControl26.y<0||a<c&&this.$SphericalViewportControl26.y>0;return a};d.$SphericalViewportControl111=function(){__p&&__p();if(this.$SphericalViewportControl69){var a={x:0,y:0};this.$SphericalViewportControl22||(this.$SphericalViewportControl22=!0,a.x=this.$SphericalViewportControl21.x/this.$SphericalViewportControl34,a.y=this.$SphericalViewportControl21.y/this.$SphericalViewportControl35);return a}a={x:0,y:0};if(!this.$SphericalViewportControl22){this.$SphericalViewportControl22=!0;var b=this.$SphericalViewportControl33,c=this.$SphericalViewportControl24.x<b.left,d=this.$SphericalViewportControl24.x>b.right,e=this.$SphericalViewportControl24.y<b.top,f=this.$SphericalViewportControl24.y>b.bottom;this.$SphericalViewportControl122(c,d,e,f);b={x:this.$SphericalViewportControl24.x-b.left,y:this.$SphericalViewportControl24.y-b.top};!c&&!d?a.x=this.$SphericalViewportControl121(b,this.$SphericalViewportControl21).x:a.x=-this.$SphericalViewportControl21.x*this.$SphericalViewportControl117()*s;!e&&!f?a.y=this.$SphericalViewportControl121(b,this.$SphericalViewportControl21).y:a.y=this.$SphericalViewportControl21.y*this.$SphericalViewportControl117()*s}this.$SphericalViewportControl9.updateVelocity(0,0);return this.$SphericalViewportControl123(a)};d.$SphericalViewportControl123=function(a){__p&&__p();if(!this.$SphericalViewportControl54||!this.$SphericalViewportControl42)return a;var b=this.$SphericalViewportControl26,c=b.x;b=b.y;var d=this.$SphericalViewportControl40,e=d.partialLeftDegrees,f=d.partialRightDegrees,g=d.partialTopDegrees;d=d.partialBottomDegrees;var h=a.x;a=a.y;var i=c+h;b=b+a;var j=!0,k=!0;if(this.$SphericalViewportControl63){var l=this.$SphericalViewportControl39.partialLeftDegrees,m=this.$SphericalViewportControl39.partialRightDegrees,n=this.$SphericalViewportControl41===0;(i<180&&h<0||i>180&&h>0)&&(i=c-h);(l!=null||!n)&&e!=null&&(j=e<0?(i<180?i+360:i)>360-e:i>360-e);(m!=null||!n)&&f!=null&&(k=f<0?(i<180?i+360:i)<360+f:(i>180?360-i:i)<f);c=g!=null?b<g:!0;l=d!=null?b>-d:!0}else{m=this.getVerticalFieldOfView();n=this.getHorizontalFieldOfView();var o=i<180?i+360:i;i=i>180?i-360:i;j=e!=null?o>360-e+n/2:!0;k=f!=null?i<f-n/2:!0;c=g!=null?b<g-m/2:!0;l=d!=null?b>-d+m/2:!0}!j&&!k&&(h*=this.$SphericalViewportControl55);(!c||!l)&&(a*=this.$SphericalViewportControl55);return{x:h,y:a}};d.$SphericalViewportControl79=function(a,c){b("DOMEventListener").add(c,"wheel",this.$SphericalViewportControl90,{passive:!1}),this.emit("mouseEnter"),this.$SphericalViewportControl19?this.$SphericalViewportControl9=new(b("VelocityTracker"))(300):this.$SphericalViewportControl43&&this.$SphericalViewportControl44&&(this.$SphericalViewportControl9=new(b("VelocityTracker"))(300),this.$SphericalViewportControl45=!0,this.$SphericalViewportControl23=this.$SphericalViewportControl113(a),this.$SphericalViewportControl21={x:0,y:0},this.$SphericalViewportControl104())};d.$SphericalViewportControl80=function(a,c){b("DOMEventListener").remove(c,"wheel",this.$SphericalViewportControl90,{passive:!1}),this.emit("mouseLeave",a),this.$SphericalViewportControl100(a)};d.$SphericalViewportControl81=function(a){this.emit("mouseMove",a),this.$SphericalViewportControl43&&this.$SphericalViewportControl108(a)};d.$SphericalViewportControl82=function(a){this.emit("mouseUp",a)};d.$SphericalViewportControl83=function(a){__p&&__p();if(this.isListening(a.target)){a.target.focus();var c=b("Parent").bySelector(a.target,"._24cp");if(!this.$SphericalViewportControl14){this.emit("DOM/click",a);if(c)return!0}this.$SphericalViewportControl14=!1}return!1};d.$SphericalViewportControl99=function(a){a=this.setFieldOfView(this.$SphericalViewportControl11+a);a&&this.$SphericalViewportControl56()};d.disableKeyboard=function(){this.$SphericalViewportControl27=!0};d.enableKeyboard=function(){this.$SphericalViewportControl27=!1};d.$SphericalViewportControl84=function(a){a=this.$SphericalViewportControl125(a);if(a&&!this.$SphericalViewportControl27){this.$SphericalViewportControl17[a]=1;this.$SphericalViewportControl18||(this.$SphericalViewportControl18=!0,this.$SphericalViewportControl101(),this.$SphericalViewportControl104(),this.emit("updateViewportMove"));return!1}return!0};d.$SphericalViewportControl85=function(a){__p&&__p();a=this.$SphericalViewportControl125(a);if(a&&!this.$SphericalViewportControl27){this.$SphericalViewportControl17[a]=0;a=!1;for(var b in this.$SphericalViewportControl17)if(Object.prototype.hasOwnProperty.call(this.$SphericalViewportControl17,b)&&this.$SphericalViewportControl17[b]>0){a=!0;break}this.$SphericalViewportControl18=a;return!1}return!0};d.$SphericalViewportControl105=function(){var a=this.$SphericalViewportControl116();this.$SphericalViewportControl9=new(b("VelocityTracker"))(300,a)};d.$SphericalViewportControl104=function(){__p&&__p();var a=this;if(!this.$SphericalViewportControl15){this.$SphericalViewportControl60&&this.$SphericalViewportControl126();this.$SphericalViewportControl15=!0;this.$SphericalViewportControl8.updateVelocity(0,0);this.emit("updateViewportBegin",this.$SphericalViewportControl26.x,this.$SphericalViewportControl26.y);var c=this.once("updateViewportMove",function(){return a.emit("updateViewportMoveStart",a.$SphericalViewportControl45)});this.once("updateViewportEnd",function(){return c.remove()});this.$SphericalViewportControl59=b("performanceNow")();if(this.$SphericalViewportControl69){this.$SphericalViewportControl66&&cancelAnimationFrame(this.$SphericalViewportControl66);this.$SphericalViewportControl66=b("requestAnimationFrame")(this.$SphericalViewportControl127);return}this.$SphericalViewportControl66||(this.$SphericalViewportControl66=b("requestAnimationFrame")(this.$SphericalViewportControl128))}};d.$SphericalViewportControl126=function(){this.$SphericalViewportControl33=b("getElementRect")(this.$SphericalViewportControl32)};d.updateViewportClientSize=function(a){this.$SphericalViewportControl34=a.width,this.$SphericalViewportControl35=a.height};d.updateMinVFOV=function(a){this.$SphericalViewportControl51=Math.max(m,Math.min(n,a))};d.updateMaxVFOV=function(a){this.$SphericalViewportControl52=a};d.updateMaxHFOV=function(a){this.$SphericalViewportControl53=a};d.$SphericalViewportControl91=function(){this.$SphericalViewportControl33=b("getElementRect")(this.$SphericalViewportControl32),this.$SphericalViewportControl34=this.$SphericalViewportControl32.clientWidth||1,this.$SphericalViewportControl35=this.$SphericalViewportControl32.clientHeight||1};d.setAngularVelocityScaleFactor=function(a){this.$SphericalViewportControl64=a};d.$SphericalViewportControl130=function(){__p&&__p();var a=180,b=0,c=this.$SphericalViewportControl40,d=c.partialLeftDegrees;c=c.partialRightDegrees;d!=null&&c!=null&&(a=(c-d)/2+180);if(this.$SphericalViewportControl63){var e=this.$SphericalViewportControl39.partialLeftDegrees,f=this.$SphericalViewportControl39.partialRightDegrees,g=this.$SphericalViewportControl41===0;if((e!=null||!g)&&d!=null){e=d<0&&this.$SphericalViewportControl26.x<180?this.$SphericalViewportControl26.x+360:this.$SphericalViewportControl26.x;if(e>a){e=360-d-e;e>0&&(b=Math.min(e,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}if((f!=null||!g)&&c!=null){e=c<0&&this.$SphericalViewportControl26.x>180?this.$SphericalViewportControl26.x-360:this.$SphericalViewportControl26.x;if(e<a){f=c-e;f<0&&(b=Math.max(f,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}}else{g=this.getHorizontalFieldOfView();e=this.$SphericalViewportControl26.x<180?this.$SphericalViewportControl26.x+360:this.$SphericalViewportControl26.x;f=this.$SphericalViewportControl26.x>180?this.$SphericalViewportControl26.x-360:this.$SphericalViewportControl26.x;if(d!=null&&c!=null&&d+c<g){var h=(c-d)/2-f;h>0?b=Math.min(h,this.$SphericalViewportControl48)*this.$SphericalViewportControl47:h<0&&(b=Math.max(h,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47);return Math.abs(b)<q?0:b}if(d!=null&&e>=a){h=360-d+g/2-e;h>0&&(b=Math.min(h,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}if(c!=null&&f<=a){d=c-g/2-f;d<0&&(b=Math.max(d,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}return Math.abs(b)<q?0:b};d.$SphericalViewportControl131=function(){__p&&__p();var a=0,b=0,c=this.$SphericalViewportControl40,d=c.partialTopDegrees;c=c.partialBottomDegrees;if(this.$SphericalViewportControl63){if(c!=null&&d!=null){if(c<0&&d<-c||d<0&&-d>c)return 0;b=(d-c)/2}if(d!=null&&this.$SphericalViewportControl26.y>b){var e=d-this.$SphericalViewportControl26.y;e<0&&(a=Math.max(e,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}if(c!=null&&this.$SphericalViewportControl26.y<b){e=-c-this.$SphericalViewportControl26.y;e>0&&(a=Math.min(e,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}else{b=this.getVerticalFieldOfView();if(c!=null&&d!=null&&c+d<b){e=(d-c)/2-this.$SphericalViewportControl26.y;e>0?a=Math.min(e,this.$SphericalViewportControl48)*this.$SphericalViewportControl47:e<0&&(a=Math.max(e,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47);return Math.abs(a)<q?0:a}if(d!=null){e=d-b/2-this.$SphericalViewportControl26.y;e<0&&(a=Math.max(e,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}if(c!=null){d=-c+b/2-this.$SphericalViewportControl26.y;d>0&&(a=Math.min(d,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}return Math.abs(a)<q?0:a};d.$SphericalViewportControl122=function(a,c,d,e){var f="";if(a||c||d||e){a=a?"Left":c?"Right":"";c=d?"Up":e?"Down":"";f=u[c+a]}this.$SphericalViewportControl36!=f&&(this.$SphericalViewportControl36&&(b("CSS").removeClass(this.$SphericalViewportControl10,this.$SphericalViewportControl36),this.$SphericalViewportControl36=""),f&&(this.$SphericalViewportControl36=f,b("CSS").addClass(this.$SphericalViewportControl10,f)))};d.getSubscriptions=function(){var a=this;return{remove:function(){a.$SphericalViewportControl30.forEach(function(a){a=a.handler;return a.release()}),a.$SphericalViewportControl30.clear(),a.$SphericalViewportControl13.release()}}};d.$SphericalViewportControl86=function(a){for(var b in this.$SphericalViewportControl17)this.$SphericalViewportControl17[b]=0;this.$SphericalViewportControl18=!1};d.getOrientation=function(){return this.$SphericalViewportControl26};d.$SphericalViewportControl93=function(a){if(this.$SphericalViewportControl63){a=a!=null?a:this.getVerticalFieldOfView();var c=this.getAspectRatio();this.$SphericalViewportControl40=b("SphericalPhotoProjectionUtils").getPartialLimits(a,c,this.$SphericalViewportControl39);this.$SphericalViewportControl41=b("SphericalPhotoProjectionUtils").getZoomProgress(a,this.$SphericalViewportControl39,c)}};d.$SphericalViewportControl133=function(a,b){__p&&__p();a=(a+360)%360;b=Math.max(-90,Math.min(90,b));if(!this.$SphericalViewportControl42)return{x:a,y:b};var c=this.$SphericalViewportControl39.partialLeftDegrees,d=this.$SphericalViewportControl39.partialRightDegrees,e=this.$SphericalViewportControl41===0,f=this.$SphericalViewportControl40.partialLeftDegrees,g=this.$SphericalViewportControl40.partialRightDegrees,h=this.$SphericalViewportControl40.partialTopDegrees,i=this.$SphericalViewportControl40.partialBottomDegrees,j=this.getVerticalFieldOfView(),k=this.getHorizontalFieldOfView(),l=0,m=0;if(this.$SphericalViewportControl63)this.$SphericalViewportControl54&&(f!=null&&g!=null&&(l=Math.min(Math.abs((f+g)/2),this.$SphericalViewportControl49)),h!=null&&i!=null&&h>=-i&&(m=Math.min(Math.abs((h+i)/2),this.$SphericalViewportControl50))),(c!=null||!e)&&f!=null&&(f<0?a=Math.max(a>180?a:a+360,360-f-l)%360:a>180&&(a=Math.max(a,360-f-l))),(d!=null||!e)&&g!=null&&(g<0?a=Math.min(a<180?a+360:a,360+g+l)%360:a<180&&(a=Math.min(a,g+l))),h!=null&&(i!=null&&h<0&&-h>i?b=Math.min(b,-i):b=Math.min(b,h+m)),i!=null&&(h!=null&&i<0&&h<-i?b=Math.max(b,h):b=Math.max(b,-i-m));else{this.$SphericalViewportControl54&&(l=this.$SphericalViewportControl49,m=this.$SphericalViewportControl50);if(f!=null&&g!=null&&f+g<k){c=(g-f)/2;d=a>180?a-360:a;d<c?a=Math.max(d,c-l):a=Math.min(d,c+l)}else f!=null&&(a=a<=180?a:Math.max(a,360-f+k/2-l)),g!=null&&(a=a>=180?a:Math.min(a,g-k/2+l));if(h!=null&&i!=null&&h+i<j){e=(h-i)/2;b<e?b=Math.max(b,e-m):b=Math.min(b,e+m)}else h!=null&&(b=Math.min(b,h-j/2+m)),i!=null&&(b=Math.max(b,-i+j/2-m))}return{x:a,y:b}};d.setInitialOrientation=function(){var a=this.$SphericalViewportControl133(0,0),b=a.x;a=a.y;var c=!Number.isNaN(b+a)&&(b!==this.$SphericalViewportControl26.x||a!==this.$SphericalViewportControl26.y);c&&(this.$SphericalViewportControl26={x:b,y:a},this.emit("initialViewportChange",b,a),this.emit("viewportChange",b,a,this.$SphericalViewportControl11))};d.setSphericalOrientation=function(a,b){a===null&&(a=this.$SphericalViewportControl26.x);b===null&&(b=this.$SphericalViewportControl26.y);typeof a==="number"&&typeof b==="number"||i(0,4346);a=this.$SphericalViewportControl133(a,b);b=a.x;a=a.y;var c=!Number.isNaN(b+a)&&(b!==this.$SphericalViewportControl26.x||a!==this.$SphericalViewportControl26.y);c&&(this.$SphericalViewportControl26={x:b,y:a},this.emit("viewportChange",b,a,this.$SphericalViewportControl11))};d.setRelativeSphericalOrientation=function(a,b){this.setSphericalOrientation(a+this.$SphericalViewportControl28.x,b+this.$SphericalViewportControl28.y)};d.$SphericalViewportControl132=function(a,b){this.setSphericalOrientation(this.$SphericalViewportControl26.x+a,this.$SphericalViewportControl26.y+b)};d.$SphericalViewportControl92=function(a){__p&&__p();if(this.$SphericalViewportControl63){var c=b("SphericalPhotoProjectionUtils").getMaxVfov(this.$SphericalViewportControl39,this.getAspectRatio());return Math.min(c,Math.max(this.$SphericalViewportControl51,a))}else{c=Math.min(b("calculateVFOVFromHFOV")(this.$SphericalViewportControl53,this.getAspectRatio()),this.$SphericalViewportControl52);if(this.$SphericalViewportControl42&&this.$SphericalViewportControl39){var d=this.$SphericalViewportControl39.partialTopDegrees||this.$SphericalViewportControl39.partialTopDegrees===0,e=this.$SphericalViewportControl39.partialBottomDegrees||this.$SphericalViewportControl39.partialBottomDegrees===0;if(d&&e){d=this.$SphericalViewportControl39.partialTopDegrees||0;e=this.$SphericalViewportControl39.partialBottomDegrees||0;c=Math.min(c,d+e)}}return Math.min(c,Math.max(this.$SphericalViewportControl51,a))}};d.setFieldOfView=function(a){__p&&__p();var c=this.$SphericalViewportControl11;a=this.$SphericalViewportControl92(a);this.$SphericalViewportControl93(a);var d=this.$SphericalViewportControl40,e=d.partialTopDegrees,f=d.partialBottomDegrees,g=d.partialLeftDegrees;d=d.partialRightDegrees;var h=e||e===0,i=f||f===0,j=g||g===0,k=d||d===0,l=g||d;e=e||0;f=f||0;g=g||0;d=d||0;var m=!1,n=this.$SphericalViewportControl26.x,o=this.$SphericalViewportControl26.y;if(this.$SphericalViewportControl63){e=h?e:90;f=i?f:90;g=j?g:180;d=k?d:180;-o>f&&(f<0&&e<-f?o=e:o=-f,m=!0);o>e&&(e<0&&e<-f?o=-f:o=e,m=!0);j=((d-g)/2+180)%360;n>j&&360-n>g&&(n=360-g,m=!0);n<j&&n>d&&(n=d,m=!0)}else{k=b("calculateHFOVFromVFOV")(a,this.getAspectRatio());i&&a/2-o>f&&(o=a/2-f,m=!0);h&&o+a/2>e&&(o=e-a/2,m=!0);h&&i&&e+f<a&&(o=(e-f)/2,m=!0);if(l){j=((d-g)/2+180)%360;n>j&&k/2+360-n>g&&(n=360+k/2-g,m=!0);n<j&&n+k/2>d&&(n=d-k/2,m=!0);g+d<k&&(n=(d-g)/2%360,m=!0)}}!this.$SphericalViewportControl19&&!this.$SphericalViewportControl20&&m&&!Number.isNaN(n+o)&&(this.$SphericalViewportControl54?this.$SphericalViewportControl66||(this.$SphericalViewportControl66=b("requestAnimationFrame")(this.$SphericalViewportControl128)):this.$SphericalViewportControl26={x:n,y:o});if(!Number.isNaN(a)&&c!==a||m){this.$SphericalViewportControl11=a;this.emit("viewportChange",this.$SphericalViewportControl26.x,this.$SphericalViewportControl26.y,a);return!0}return!1};d.getVerticalFieldOfView=function(){return this.$SphericalViewportControl11};d.getAspectRatio=function(){return this.$SphericalViewportControl32&&this.$SphericalViewportControl34&&this.$SphericalViewportControl35?this.$SphericalViewportControl34/this.$SphericalViewportControl35:this.$SphericalViewportControl7};d.getHorizontalFieldOfView=function(){return b("calculateHFOVFromVFOV")(this.$SphericalViewportControl11,this.getAspectRatio())};d.setPreventScrollDefaultAction=function(a){this.$SphericalViewportControl38=a};d.setEnableZoom=function(a){this.$SphericalViewportControl46=a,a||this.setFieldOfView(this.$SphericalViewportControl12)};d.updateViewport=function(a,b,c){this.$SphericalViewportControl26={x:a,y:b},this.$SphericalViewportControl11=this.$SphericalViewportControl92(c),this.$SphericalViewportControl93()};d.isUpdating=function(){return this.$SphericalViewportControl15};d.$SphericalViewportControl129=function(){var a=this.$SphericalViewportControl16*(this.$SphericalViewportControl17.right-this.$SphericalViewportControl17.left),b=this.$SphericalViewportControl16*(this.$SphericalViewportControl17.up-this.$SphericalViewportControl17.down);this.$SphericalViewportControl8.updateVelocity(a,b)};d.$SphericalViewportControl125=function(a){__p&&__p();a=b("Event").getKeyCode(a);var c=null;switch(a){case b("Keys").LEFT:case t.A:c="left";break;case b("Keys").UP:case t.W:c="up";break;case b("Keys").RIGHT:case t.D:c="right";break;case b("Keys").DOWN:case t.S:c="down";break}return c};d.$SphericalViewportControl117=function(){return this.$SphericalViewportControl11/this.$SphericalViewportControl35};d.$SphericalViewportControl73=function(){var a="grabbing";b("UserAgent").isEngine("WebKit")?a="-webkit-"+a:b("UserAgent").isEngine("Gecko")&&(a="-moz-"+a);return a};return c}(b("EventEmitter"));e.exports=a}),null);
__d("SphericalViewportMovementEnum",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({WWW_ZOOM:null,CLICK_AND_DRAG:null,RECENTER:null,GUIDE:null,PARALLAX:null,KEYBOARD_PAN:null});e.exports=a}),null);
__d("SphericalViewportEventToMovementConfig",["SphericalViewportMovementEnum","keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({WHEEL:null,MOUSE_DOWN:null,COMPASS_CLICK:null,SETUP_COMPLETE:null,WINDOW_VIEWPORT_CHANGED:null,DIRECTIONAL_KEY_DOWN:null});d=(c={},c[a.WHEEL]=[b("SphericalViewportMovementEnum").WWW_ZOOM],c[a.MOUSE_DOWN]=[b("SphericalViewportMovementEnum").CLICK_AND_DRAG],c[a.COMPASS_CLICK]=[b("SphericalViewportMovementEnum").RECENTER,b("SphericalViewportMovementEnum").GUIDE],c[a.SETUP_COMPLETE]=[b("SphericalViewportMovementEnum").GUIDE],c[a.WINDOW_VIEWPORT_CHANGED]=[b("SphericalViewportMovementEnum").PARALLAX],c[a.DIRECTIONAL_KEY_DOWN]=[b("SphericalViewportMovementEnum").KEYBOARD_PAN],c);e.exports={SphericalViewportEventEnum:a,SphericalViewportEventToMovementConfig:d}}),null);
__d("SphericalViewportMediaToMovementConfig",["SphericalViewportMovementEnum","keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({WWW_VIDEO:null});d=(c={},c[a.WWW_VIDEO]=[b("SphericalViewportMovementEnum").WWW_ZOOM,b("SphericalViewportMovementEnum").CLICK_AND_DRAG,b("SphericalViewportMovementEnum").RECENTER,b("SphericalViewportMovementEnum").GUIDE,b("SphericalViewportMovementEnum").PARALLAX,b("SphericalViewportMovementEnum").KEYBOARD_PAN],c);e.exports={SphericalViewportMediaEnum:a,SphericalViewportMediaToMovementConfig:d}}),null);
__d("SphericalViewportPriorityConfig",["SphericalViewportMovementEnum"],(function(a,b,c,d,e,f){"use strict";c=(a={NONE:0},a[b("SphericalViewportMovementEnum").WWW_ZOOM]={START:500,ACTIVE:550},a[b("SphericalViewportMovementEnum").CLICK_AND_DRAG]={START:501,ACTIVE:551,ACTIVE_INERTIA:450,ACTIVE_LOW_INERTIA:350},a[b("SphericalViewportMovementEnum").RECENTER]={START:502,ACTIVE:350},a[b("SphericalViewportMovementEnum").GUIDE]={START:502,ACTIVE:350},a[b("SphericalViewportMovementEnum").PARALLAX]={START:200,ACTIVE:250},a[b("SphericalViewportMovementEnum").KEYBOARD_PAN]={START:500,ACTIVE:550},a);e.exports=c}),null);
__d("SphericalViewportControlNew",["cx","invariant","CSS","DOMEventListener","DOMQuery","Event","EventEmitter","SphericalViewportEventToMovementConfig","SphericalViewportMediaToMovementConfig","SphericalViewportMovement","SphericalViewportPriorityConfig","SphericalViewportUtils","SubscriptionsHandler","calculateHFOVFromVFOV","getElementRect","onViewportChanged","requestAnimationFrame"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("SphericalViewportEventToMovementConfig").SphericalViewportEventEnum,j=b("SphericalViewportMediaToMovementConfig").SphericalViewportMediaToMovementConfig,k=110,l=20,m=b("DOMQuery").scry(window.document.body,"_li")[0]||window.document.body,n={dragLeft:"_2a6u",dragRight:"_2a6v",dragUp:"__tu",dragDown:"__tz",dragUpLeft:"__t-",dragUpRight:"__u0",dragDownLeft:"__u1",dragDownRight:"__u3",webkitGrabbing:"_4li9",mozGrabbing:"_4lia",Grabbing:"_4li8",Default:"_nqe"};a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e,f){__p&&__p();var g;g=a.call(this)||this;g.$SphericalViewportControlNew25=function(a){g.$SphericalViewportControlNew6&&g.$SphericalViewportControlNew6.animate(a),b("requestAnimationFrame")(g.$SphericalViewportControlNew25)};g.$SphericalViewportControlNew34=function(a){a.deliberateSync=!0;g.$SphericalViewportControlNew6&&g.$SphericalViewportControlNew6.handleWheelEvent(a);var c=b("SphericalViewportUtils").getMovementIDsForEvent(g.$SphericalViewportControlNew5,i.WHEEL);c=g.$SphericalViewportControlNew38(c);c&&g.$SphericalViewportControlNew6&&g.$SphericalViewportControlNew6.handleWheelEvent(a);g.emit("wheelScroll",a)};g.$SphericalViewportControlNew35=function(){g.$SphericalViewportControlNew6&&g.$SphericalViewportControlNew6.handleWindowViewportChangedEvent();var a=b("SphericalViewportUtils").getMovementIDsForEvent(g.$SphericalViewportControlNew5,i.WINDOW_VIEWPORT_CHANGED);a=g.$SphericalViewportControlNew38(a);a&&g.$SphericalViewportControlNew6&&g.$SphericalViewportControlNew6.handleWindowViewportChangedEvent()};g.$SphericalViewportControlNew1=c;g.$SphericalViewportControlNew2=f&&f.documentBody?f.documentBody:m;g.$SphericalViewportControlNew4=g.$SphericalViewportControlNew21({x:e.initialHeading,y:e.initialPitch,vFOV:e.fieldOfView});g.$SphericalViewportControlNew14=Object.assign({},g.$SphericalViewportControlNew4);g.$SphericalViewportControlNew5=d;g.$SphericalViewportControlNew6=null;g.$SphericalViewportControlNew10=!1;g.$SphericalViewportControlNew11=!1;g.$SphericalViewportControlNew12=!1;g.$SphericalViewportControlNew13="";f&&f.vpc&&(g.$SphericalViewportControlNew3=f.vpc);g.$SphericalViewportControlNew15=!!e.guideEnabled;g.$SphericalViewportControlNew16=e.guideKeyframes!==void 0?e.guideKeyframes:null;g.$SphericalViewportControlNew17={left:!1,right:!1,up:!1,down:!1};g.$SphericalViewportControlNew18=!1;g.$SphericalViewportControlNew22(e);g.$SphericalViewportControlNew23();g.$SphericalViewportControlNew24();b("requestAnimationFrame")(g.$SphericalViewportControlNew25);return g}var d=c.prototype;d.$SphericalViewportControlNew22=function(a){var c=j[this.$SphericalViewportControlNew5];this.$SphericalViewportControlNew7=b("SphericalViewportUtils").createMovementShapeFromIDs(this,c,a)};d.$SphericalViewportControlNew23=function(){__p&&__p();var a=this;this.$SphericalViewportControlNew8=new(b("SubscriptionsHandler"))();this.$SphericalViewportControlNew8.addSubscriptions(b("Event").listen(this.$SphericalViewportControlNew1,"mouseenter",function(b){return a.$SphericalViewportControlNew26(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"mouseleave",function(b){return a.$SphericalViewportControlNew27(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"mousedown",function(b){return a.$SphericalViewportControlNew28(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"mouseup",function(b){return a.$SphericalViewportControlNew29(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"keydown",function(b){return a.$SphericalViewportControlNew30(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"keyup",function(b){return a.$SphericalViewportControlNew31(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"blur",function(b){return a.$SphericalViewportControlNew32(b)}),b("Event").listen(this.$SphericalViewportControlNew1,"click",function(b){return a.$SphericalViewportControlNew33(b)}),{remove:function(){b("DOMEventListener").remove(a.$SphericalViewportControlNew1,"wheel",function(b){return a.$SphericalViewportControlNew34(b)},{passive:!1})}});this.$SphericalViewportControlNew20=b("onViewportChanged")(this.$SphericalViewportControlNew35);this.$SphericalViewportControlNew3&&this.$SphericalViewportControlNew8.addSubscriptions(this.$SphericalViewportControlNew3.addListener("SphericalHeadingIndicator/click",function(){return a.$SphericalViewportControlNew36()}),this.$SphericalViewportControlNew3.addListener("seekEnd",function(){return a.$SphericalViewportControlNew37()}));this.$SphericalViewportControlNew9=new(b("SubscriptionsHandler"))()};d.$SphericalViewportControlNew38=function(a){__p&&__p();var c=!1,d=this.$SphericalViewportControlNew6;if(d&&(!d.isValid()||!d.isActive())){d=this.$SphericalViewportControlNew6;this.$SphericalViewportControlNew6=null;c=!0;d&&d.deactivate()}if(a.length===0)return c;d=b("SphericalViewportPriorityConfig").NONE;var e="";for(var a=a,f=Array.isArray(a),g=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(g>=a.length)break;i=a[g++]}else{g=a.next();if(g.done)break;i=g.value}i=i;var j=this.$SphericalViewportControlNew7[i];j!==null&&j!==void 0||h(0,3228,i);var k=j.getStartPriority();j.isValid()&&j!==this.$SphericalViewportControlNew6&&k>d&&(d=k,e=i)}j=this.$SphericalViewportControlNew6?this.$SphericalViewportControlNew6.getActivePriority():b("SphericalViewportPriorityConfig").NONE;if(e!==""&&d>j){k=this.$SphericalViewportControlNew6;k&&k.deactivate();this.$SphericalViewportControlNew6=this.$SphericalViewportControlNew7[e];c=!0;this.$SphericalViewportControlNew6||h(0,3229);this.$SphericalViewportControlNew6.activate()}return c};d.destroy=function(){this.removeAllListeners(),this.$SphericalViewportControlNew8.release(),this.$SphericalViewportControlNew20.remove()};d.$SphericalViewportControlNew26=function(a){this.$SphericalViewportControlNew10=!0,this.$SphericalViewportControlNew38([]),b("DOMEventListener").add(this.$SphericalViewportControlNew1,"wheel",this.$SphericalViewportControlNew34,{passive:!1})};d.$SphericalViewportControlNew27=function(a){this.$SphericalViewportControlNew10=!1,this.$SphericalViewportControlNew38([]),b("DOMEventListener").remove(this.$SphericalViewportControlNew1,"wheel",this.$SphericalViewportControlNew34,{passive:!1})};d.$SphericalViewportControlNew28=function(a){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleMouseDownEvent(a);this.$SphericalViewportControlNew12=!0;var c=b("SphericalViewportUtils").getMovementIDsForEvent(this.$SphericalViewportControlNew5,i.MOUSE_DOWN);c=this.$SphericalViewportControlNew38(c);c&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleMouseDownEvent(a)};d.$SphericalViewportControlNew29=function(a){this.$SphericalViewportControlNew12=!1,this.$SphericalViewportControlNew38([])};d.$SphericalViewportControlNew39=function(a){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGlobalMouseMoveEvent(a);var b=this.$SphericalViewportControlNew38([]);b&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGlobalMouseMoveEvent(a)};d.$SphericalViewportControlNew40=function(a){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGlobalMouseUpEvent(a);var b=this.$SphericalViewportControlNew38([]);b&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGlobalMouseUpEvent(a)};d.$SphericalViewportControlNew41=function(a){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGlobalMouseLeaveEvent(a);var b=this.$SphericalViewportControlNew38([]);b&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGlobalMouseLeaveEvent(a)};d.$SphericalViewportControlNew42=function(a){this.$SphericalViewportControlNew4=a,this.$SphericalViewportControlNew38([]),this.emit("viewportChange",this.$SphericalViewportControlNew4.x,this.$SphericalViewportControlNew4.y,this.$SphericalViewportControlNew4.vFOV)};d.$SphericalViewportControlNew43=function(a){this.$SphericalViewportControlNew14=a,this.$SphericalViewportControlNew38([])};d.$SphericalViewportControlNew44=function(a){this.$SphericalViewportControlNew11=a,this.$SphericalViewportControlNew38([])};d.$SphericalViewportControlNew36=function(){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleCompassClickEvent();var a=b("SphericalViewportUtils").getMovementIDsForEvent(this.$SphericalViewportControlNew5,i.COMPASS_CLICK);a=this.$SphericalViewportControlNew38(a);a&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleCompassClickEvent()};d.$SphericalViewportControlNew24=function(){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleSetupCompleteEvent();var a=b("SphericalViewportUtils").getMovementIDsForEvent(this.$SphericalViewportControlNew5,i.SETUP_COMPLETE);a=this.$SphericalViewportControlNew38(a);a&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleSetupCompleteEvent()};d.$SphericalViewportControlNew45=function(a){this.$SphericalViewportControlNew15=a,this.$SphericalViewportControlNew38([])};d.$SphericalViewportControlNew46=function(a){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGuideKeyframesChangeEvent(a);this.$SphericalViewportControlNew16=a;var b=this.$SphericalViewportControlNew38([]);b&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleGuideKeyframesChangeEvent(a)};d.$SphericalViewportControlNew30=function(a){var c=b("SphericalViewportUtils").getKeyDirection(a);if(!c)return;this.$SphericalViewportControlNew17[c]=!0;this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleDirectionalKeyDownEvent(a);c=b("SphericalViewportUtils").getMovementIDsForEvent(this.$SphericalViewportControlNew5,i.DIRECTIONAL_KEY_DOWN);c=this.$SphericalViewportControlNew38(c);c&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleDirectionalKeyDownEvent(a)};d.$SphericalViewportControlNew31=function(a){var c=b("SphericalViewportUtils").getKeyDirection(a);if(!c)return;this.$SphericalViewportControlNew17[c]=!1;this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleDirectionalKeyUpEvent(a);c=this.$SphericalViewportControlNew38([]);c&&this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleDirectionalKeyUpEvent(a)};d.$SphericalViewportControlNew32=function(a){a=Object.keys(this.$SphericalViewportControlNew17);for(var b=0;b<a.length;b++){var c=a[b];this.$SphericalViewportControlNew17[c]=!1}this.$SphericalViewportControlNew38([])};d.$SphericalViewportControlNew33=function(a){this.$SphericalViewportControlNew1.focus(),this.$SphericalViewportControlNew19||this.emit("DOM/click",a),this.$SphericalViewportControlNew19=!1};d.$SphericalViewportControlNew37=function(){this.$SphericalViewportControlNew6&&this.$SphericalViewportControlNew6.handleVideoSeekEvent()};d.getOrientation=function(){return Object.assign({},this.$SphericalViewportControlNew4)};d.setOrientation=function(a){a=this.$SphericalViewportControlNew21(a);var b=this.$SphericalViewportControlNew4.x!==a.x||this.$SphericalViewportControlNew4.y!==a.y||this.$SphericalViewportControlNew4.vFOV!==a.vFOV;b&&this.$SphericalViewportControlNew42(a);return b};d.getInitialOrientation=function(){return Object.assign({},this.$SphericalViewportControlNew14)};d.setInitialOrientation=function(a){a=this.$SphericalViewportControlNew21(a);var b=this.$SphericalViewportControlNew14.x!==a.x||this.$SphericalViewportControlNew14.y!==a.y||this.$SphericalViewportControlNew14.vFOV!==a.vFOV;b&&this.$SphericalViewportControlNew43(a)};d.getHFOV=function(){var a=this.getViewportElement().clientWidth/this.getViewportElement().clientHeight;return b("calculateHFOVFromVFOV")(this.$SphericalViewportControlNew4.vFOV,a)};d.$SphericalViewportControlNew21=function(a){var b=(a.x%360+360)%360,c=Math.max(-90,Math.min(90,a.y));a=Math.min(k,Math.max(l,a.vFOV));return{x:b,y:c,vFOV:a}};d.isMouseOnElement=function(){return this.$SphericalViewportControlNew10};d.isInTahoe=function(){return this.$SphericalViewportControlNew11};d.setInTahoe=function(a){this.$SphericalViewportControlNew44(a)};d.setCursorClass=function(a){Object.prototype.hasOwnProperty.call(n,a)||a===""||h(0,3230),this.$SphericalViewportControlNew13!==a&&(this.$SphericalViewportControlNew13!==""&&b("CSS").removeClass(this.$SphericalViewportControlNew2,n[this.$SphericalViewportControlNew13]),this.$SphericalViewportControlNew13=a,a!==""&&b("CSS").addClass(this.$SphericalViewportControlNew2,n[a]))};d.getViewportElement=function(){return this.$SphericalViewportControlNew1};d.getViewportRect=function(){return b("getElementRect")(this.$SphericalViewportControlNew1)};d.isGuideEnabled=function(){return this.$SphericalViewportControlNew15};d.setGuideEnabled=function(a){a!==this.$SphericalViewportControlNew15&&this.$SphericalViewportControlNew45(a)};d.getGuideKeyframes=function(){return this.$SphericalViewportControlNew16};d.setGuideKeyframes=function(a){this.$SphericalViewportControlNew46(a)};d.getCurrentTime=function(){this.$SphericalViewportControlNew3||h(0,3231);return this.$SphericalViewportControlNew3.getCurrentTimePosition()};d.getVPC=function(){this.$SphericalViewportControlNew3||h(0,3232);return this.$SphericalViewportControlNew3};d.engageGlobalSubscriptions=function(){var a=this;this.$SphericalViewportControlNew9.engage();this.$SphericalViewportControlNew9.addSubscriptions(b("Event").listen(this.$SphericalViewportControlNew2,"mousemove",function(b){return a.$SphericalViewportControlNew39(b)}),b("Event").listen(this.$SphericalViewportControlNew2,"mouseup",function(b){return a.$SphericalViewportControlNew40(b)}),b("Event").listen(this.$SphericalViewportControlNew2,"mouseleave",function(b){return a.$SphericalViewportControlNew41(b)}))};d.releaseGlobalSubscriptions=function(){this.$SphericalViewportControlNew9.release()};d.getCurrentMovement=function(){return this.$SphericalViewportControlNew6};d.getDirectionKeyMap=function(){return this.$SphericalViewportControlNew17};d.isFullscreen=function(){return this.$SphericalViewportControlNew18};d.setFullscreen=function(a){this.$SphericalViewportControlNew18=a};d.ignoreNextClickEvent=function(){this.$SphericalViewportControlNew19=!0};d.getMovements=function(){return this.$SphericalViewportControlNew7};return c}(b("EventEmitter"));e.exports=a}),null);
__d("SphericalViewportUtils",["Event","Keys","SphericalViewportClickAndDrag","SphericalViewportEventToMovementConfig","SphericalViewportGuide","SphericalViewportKeyboardPan","SphericalViewportMediaToMovementConfig","SphericalViewportMovementEnum","SphericalViewportParallax","SphericalViewportRecenter","SphericalViewportWWWZoom"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("SphericalViewportEventToMovementConfig").SphericalViewportEventToMovementConfig,h=b("SphericalViewportMediaToMovementConfig").SphericalViewportMediaToMovementConfig;a={getEmptyMovementShape:function(){return{WWW_ZOOM:null,CLICK_AND_DRAG:null,RECENTER:null,GUIDE:null,PARALLAX:null,KEYBOARD_PAN:null}},createMovementFromID:function(a,c,d){switch(c){case b("SphericalViewportMovementEnum").WWW_ZOOM:return new(b("SphericalViewportWWWZoom"))(a);case b("SphericalViewportMovementEnum").CLICK_AND_DRAG:return new(b("SphericalViewportClickAndDrag"))(a);case b("SphericalViewportMovementEnum").RECENTER:return new(b("SphericalViewportRecenter"))(a);case b("SphericalViewportMovementEnum").GUIDE:return new(b("SphericalViewportGuide"))(a);case b("SphericalViewportMovementEnum").PARALLAX:return new(b("SphericalViewportParallax"))(a);case b("SphericalViewportMovementEnum").KEYBOARD_PAN:return new(b("SphericalViewportKeyboardPan"))(a);default:throw new Error("Unrecognized movement ID: "+c)}},createMovementShapeFromIDs:function(a,c,d){__p&&__p();var e=this.getEmptyMovementShape();for(var c=c,f=Array.isArray(c),g=0,c=f?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=c.length)break;h=c[g++]}else{g=c.next();if(g.done)break;h=g.value}h=h;e[b("SphericalViewportMovementEnum")[h]]=this.createMovementFromID(a,h,d)}return e},getMovementIDsForEvent:function(a,b){a=new Set(h[a]);b=new Set(g[b]);a=this._setIntersection(a,b);return Array.from(a)},_setIntersection:function(a,b){__p&&__p();var c=new Set();for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;b.has(f)&&c.add(f)}return c},getKeyDirection:function(a){__p&&__p();a=b("Event").getKeyCode(a);var c=null;switch(a){case b("Keys").LEFT:case b("Keys").A:c="left";break;case b("Keys").UP:case b("Keys").W:c="up";break;case b("Keys").RIGHT:case b("Keys").D:c="right";break;case b("Keys").DOWN:case b("Keys").S:c="down";break}return c}};e.exports=a}),null);
__d("SphericalViewportClickAndDrag",["SphericalViewportMovement","SphericalViewportMovementEnum","SphericalViewportPriorityConfig","UserAgent","VelocityTracker","degToRad","performanceNow","radToDeg"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=.5,h=20;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;b.$SphericalViewportClickAndDrag8=b.$SphericalViewportClickAndDrag9();b.$SphericalViewportClickAndDrag1=!1;return b}var d=c.prototype;d.isActive=function(){return this.$SphericalViewportClickAndDrag2};d.getStartPriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").CLICK_AND_DRAG].START};d.getActivePriority=function(){return this.$SphericalViewportClickAndDrag1?b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").CLICK_AND_DRAG].ACTIVE:this.$SphericalViewportClickAndDrag6.getSpeed()<h?b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").CLICK_AND_DRAG].ACTIVE_LOW_INERTIA:b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").CLICK_AND_DRAG].ACTIVE_INERTIA};d.animate=function(a){__p&&__p();var b=(a-this.$SphericalViewportClickAndDrag7)/1e3;this.$SphericalViewportClickAndDrag7=a;a=this.$SphericalViewportClickAndDrag10();a.x+=this.$SphericalViewportClickAndDrag6.getVelocityX()*b;a.y+=this.$SphericalViewportClickAndDrag6.getVelocityY()*b;b=this.__viewportControl.getOrientation();b.x+=a.x;b.y+=a.y;this.__viewportControl.setOrientation(b);!this.$SphericalViewportClickAndDrag1&&this.$SphericalViewportClickAndDrag6.getSpeed()<=0&&(this.$SphericalViewportClickAndDrag2=!1)};d.deactivate=function(){this.$SphericalViewportClickAndDrag11()};d.handleMouseDownEvent=function(a){this.$SphericalViewportClickAndDrag12(a),this.$SphericalViewportClickAndDrag13(a),a.preventDefault()};d.handleGlobalMouseMoveEvent=function(a){this.$SphericalViewportClickAndDrag13(a),this.__viewportControl.ignoreNextClickEvent()};d.handleGlobalMouseUpEvent=function(a){this.$SphericalViewportClickAndDrag13(a),this.$SphericalViewportClickAndDrag10(),this.$SphericalViewportClickAndDrag11(),this.$SphericalViewportClickAndDrag14(),a.preventDefault()};d.handleGlobalMouseLeaveEvent=function(a){this.$SphericalViewportClickAndDrag11()};d.$SphericalViewportClickAndDrag12=function(a){this.$SphericalViewportClickAndDrag1=!0,this.$SphericalViewportClickAndDrag2=!0,this.$SphericalViewportClickAndDrag3=this.$SphericalViewportClickAndDrag15(a),this.$SphericalViewportClickAndDrag4=this.$SphericalViewportClickAndDrag15(a),this.$SphericalViewportClickAndDrag5=new(b("VelocityTracker"))(),this.$SphericalViewportClickAndDrag6=new(b("VelocityTracker"))(300),this.$SphericalViewportClickAndDrag7=b("performanceNow")(),this.__viewportControl.setCursorClass(this.$SphericalViewportClickAndDrag8),this.__viewportControl.engageGlobalSubscriptions()};d.$SphericalViewportClickAndDrag11=function(){this.$SphericalViewportClickAndDrag1=!1,this.__viewportControl.setCursorClass(""),this.__viewportControl.releaseGlobalSubscriptions()};d.$SphericalViewportClickAndDrag13=function(a){a=this.$SphericalViewportClickAndDrag15(a);this.$SphericalViewportClickAndDrag3=a;this.$SphericalViewportClickAndDrag5.update(a.x,a.y)};d.$SphericalViewportClickAndDrag10=function(){var a={x:this.$SphericalViewportClickAndDrag3.x-this.$SphericalViewportClickAndDrag4.x,y:this.$SphericalViewportClickAndDrag3.y-this.$SphericalViewportClickAndDrag4.y},b={x:0,y:0},c=this.__viewportControl.getViewportRect(),d=this.$SphericalViewportClickAndDrag3.x<c.left,e=this.$SphericalViewportClickAndDrag3.x>c.right,f=this.$SphericalViewportClickAndDrag3.y<c.top,h=this.$SphericalViewportClickAndDrag3.y>c.bottom;this.$SphericalViewportClickAndDrag16(d,e,f,h);c={x:this.$SphericalViewportClickAndDrag3.x-c.left,y:this.$SphericalViewportClickAndDrag3.y-c.top};!d&&!e?b.x=this.$SphericalViewportClickAndDrag17(c,a).x:b.x=-a.x*this.$SphericalViewportClickAndDrag18(this.__viewportControl.getOrientation().vFOV,this.__viewportControl.getViewportElement().clientHeight)*g;!f&&!h?b.y=this.$SphericalViewportClickAndDrag17(c,a).y:b.y=a.y*this.$SphericalViewportClickAndDrag18(this.__viewportControl.getOrientation().vFOV,this.__viewportControl.getViewportElement().clientHeight)*g;this.$SphericalViewportClickAndDrag6.updateVelocity(0,0);this.$SphericalViewportClickAndDrag4=this.$SphericalViewportClickAndDrag3;return b};d.$SphericalViewportClickAndDrag14=function(){var a=this.$SphericalViewportClickAndDrag19();this.$SphericalViewportClickAndDrag6=new(b("VelocityTracker"))(300,a)};d.$SphericalViewportClickAndDrag17=function(a,c){__p&&__p();var d={x:a.x-c.x,y:a.y-c.y},e=this.__viewportControl.getOrientation(),f=this.__viewportControl.getViewportElement().clientWidth,g=this.__viewportControl.getViewportElement().clientHeight,h=g/(2*Math.tan(b("degToRad")(e.vFOV/2))),i=h*Math.cos(b("degToRad")(e.y));i=i-(g/2-a.y)*Math.sin(b("degToRad")(e.y));if(e.y==-90&&c.y<0||e.y==90&&c.y>0){c=this.$SphericalViewportClickAndDrag20(d.y-g/2,d.x-f/2);var j=this.$SphericalViewportClickAndDrag20(a.y-g/2,a.x-f/2);j=j-c;j>90?j=180-j:j<-90&&(j=180+j);return{x:j*Math.sign(e.y),y:0}}else{c=this.$SphericalViewportClickAndDrag21(d,h,i,f,g);j=this.$SphericalViewportClickAndDrag21(a,h,i,f,g);return{x:c.x-j.x,y:c.y-j.y}}};d.$SphericalViewportClickAndDrag21=function(a,b,c,d,e){return{x:this.$SphericalViewportClickAndDrag20(a.x-d/2,c),y:-this.$SphericalViewportClickAndDrag20(a.y-e/2,b)}};d.$SphericalViewportClickAndDrag20=function(a,c){return b("radToDeg")(Math.atan(a/c))};d.$SphericalViewportClickAndDrag19=function(){var a=this.$SphericalViewportClickAndDrag18(this.__viewportControl.getOrientation().vFOV,this.__viewportControl.getViewportElement().clientHeight),b=-this.$SphericalViewportClickAndDrag5.getVelocityX()*a;a=this.$SphericalViewportClickAndDrag5.getVelocityY()*a;this.$SphericalViewportClickAndDrag22()&&(b=-b);return{x:b,y:a}};d.$SphericalViewportClickAndDrag22=function(){var a=this.__viewportControl.getOrientation(),c=this.__viewportControl.getViewportElement().clientHeight,d=this.__viewportControl.getViewportRect();d=d.top;d=this.$SphericalViewportClickAndDrag3.y-d;var e=c/(2*Math.tan(b("degToRad")(a.vFOV/2)));e=-e/Math.tan(b("degToRad")(a.y))+c/2;c=d>e&&a.y<0||d<e&&a.y>0;return c};d.$SphericalViewportClickAndDrag15=function(a){a=a;return{x:a.screenX,y:a.screenY}};d.$SphericalViewportClickAndDrag18=function(a,b){return a/b};d.$SphericalViewportClickAndDrag9=function(){var a="Grabbing";b("UserAgent").isEngine("WebKit")?a="webkit"+a:b("UserAgent").isEngine("Gecko")&&(a="moz"+a);return a};d.$SphericalViewportClickAndDrag16=function(a,b,c,d){var e="drag",f="";if(a||b||c||d){a=a?"Left":b?"Right":"";b=c?"Up":d?"Down":"";f=b+a}f!==""&&this.__viewportControl.setCursorClass(e+f)};return c}(b("SphericalViewportMovement"));e.exports=a}),null);
__d("SphericalVideoGuideAnimationConfig",[],(function(a,b,c,d,e,f){a=Object.freeze({MIN_INTERVAL_MS:2e3,MS_PER_SECOND:1e3,RETURN_ANIMATION_TIME:1e3});e.exports=a}),null);
__d("findGreatestLowerBoundGuideKeyframeIndex",["BinarySearch"],(function(a,b,c,d,e,f){a=function(a,c){return b("BinarySearch").greatestLowerBound(function(b){return a[b][0]},c,0,a.length,function(a,b){return a-b})};e.exports=a}),null);
__d("SphericalViewportGuideUtils",["findGreatestLowerBoundGuideKeyframeIndex","SphericalVideoGuideAnimationConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("SphericalVideoGuideAnimationConfig").MIN_INTERVAL_MS;a={calculateKeyframeInterval:function(a,c,d){var e,f;if(!c)e=[0,a.y,a.x],f=[Infinity,a.y,a.x];else{var h=b("findGreatestLowerBoundGuideKeyframeIndex")(c,d);e=h===-1?[0,a.y,a.x]:c[h];c.length<=h+1?f=[Infinity,e[1],e[2]]:c[h+1][0]-d>g?f=[c[h+1][0]-g,e[1],e[2]]:(f=c[h+1],e=[c[h+1][0]-g,e[1],e[2]])}return{prevFrame:e,nextFrame:f}},calculateKeyframeIntervalOnResume:function(a,c,d,e){var f=a.x;a=a.y;var h=[e,a,f],i=-1;if(!d)a=[Infinity,a,f];else{f=b("findGreatestLowerBoundGuideKeyframeIndex")(d,e);d.length>f+1?d[f+1][0]-e>2*g?(a=[e+g,f<0?c.y:d[f][1],f<0?c.x:d[f][2]],i=f):d[f+1][0]-e>g?(a=d[f+1],i=f+1):d.length>f+2&&d[f+2][0]-e<2*g?(a=d[f+2],i=f+2):(a=[e+g,d[f+1][1],d[f+1][2]],i=f+1):(a=[e+g,f<0?c.y:d[f][1],f<0?c.x:d[f][2]],i=f)}return{interval:{prevFrame:h,nextFrame:a},nextFrameIndex:i}},calculateKeyframeIntervalAfterReturn:function(a,b,c,d){var e=a.x;a=a.y;var f=[c,a,e],h;!b?h=[Infinity,a,e]:b.length>d+1?b[d+1][0]-c>g?h=[b[d+1][0]-g,a,e]:b.length>d+2?h=b[d+2]:(h=b[d+1],h[0]=c+g):h=[Infinity,a,e];return{prevFrame:f,nextFrame:h}}};e.exports=a}),null);
__d("SphericalViewportGuide",["invariant","SphericalVideoGuideAnimationConfig","SphericalViewportGuideUtils","SphericalViewportMovement","SphericalViewportMovementEnum","SphericalViewportPriorityConfig","easeInOutInterpolate","normalizeDeltaYaw"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("SphericalVideoGuideAnimationConfig").RETURN_ANIMATION_TIME,i=b("SphericalVideoGuideAnimationConfig").MS_PER_SECOND;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;b.$SphericalViewportGuide3=!1;return b}var d=c.prototype;d.isValid=function(){return this.__viewportControl.isGuideEnabled()};d.isActive=function(){return!0};d.getStartPriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").GUIDE].START};d.getActivePriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").GUIDE].ACTIVE};d.activate=function(){this.__viewportControl.getVPC().emit("VideoWithSphericalGuide/toggle",!0),this.$SphericalViewportGuide3=!0,this.$SphericalViewportGuide2=null};d.deactivate=function(){this.__viewportControl.getVPC().emit("VideoWithSphericalGuide/toggle",!1)};d.animate=function(){this.$SphericalViewportGuide3?this.$SphericalViewportGuide5():this.$SphericalViewportGuide6()};d.$SphericalViewportGuide6=function(){__p&&__p();var a=this.$SphericalViewportGuide1,c=this.__viewportControl.getCurrentTime()*i;if(!a||c<a.baseTime||c>a.nextTime){var d=b("SphericalViewportGuideUtils").calculateKeyframeInterval(this.__viewportControl.getInitialOrientation(),this.__viewportControl.getGuideKeyframes()||null,c);this.$SphericalViewportGuide7(d.prevFrame,d.nextFrame);a=this.$SphericalViewportGuide1}a||g(0,4971);d=b("easeInOutInterpolate")((c-a.baseTime)/a.deltaTime);c={x:a.deltaX*d+a.baseX,y:a.deltaY*d+a.baseY,vFOV:this.__viewportControl.getOrientation().vFOV};this.__viewportControl.getVPC().emit("VideoWithSphericalGuide/viewportChange",c.x,c.y);this.__viewportControl.setOrientation(c)};d.$SphericalViewportGuide5=function(){__p&&__p();var a=this.$SphericalViewportGuide2;if(!a){var c=b("SphericalViewportGuideUtils").calculateKeyframeIntervalOnResume(this.__viewportControl.getOrientation(),this.__viewportControl.getInitialOrientation(),this.__viewportControl.getGuideKeyframes()||null,this.__viewportControl.getCurrentTime()*i),d=c.interval;c=c.nextFrameIndex;this.$SphericalViewportGuide8(d.prevFrame,d.nextFrame);this.$SphericalViewportGuide4=c;a=this.$SphericalViewportGuide2}a||g(0,4971);d=Date.now();if(d-a.startTime>h){c=1;this.$SphericalViewportGuide3=!1;var e=b("SphericalViewportGuideUtils").calculateKeyframeIntervalAfterReturn(this.__viewportControl.getOrientation(),this.__viewportControl.getGuideKeyframes()||null,this.__viewportControl.getCurrentTime()*i,this.$SphericalViewportGuide4);this.$SphericalViewportGuide7(e.prevFrame,e.nextFrame)}else c=b("easeInOutInterpolate")((d-a.startTime)/h);e={x:a.deltaX*c+a.baseX,y:a.deltaY*c+a.baseY,vFOV:this.__viewportControl.getOrientation().vFOV};this.__viewportControl.getVPC().emit("VideoWithSphericalGuide/viewportChange",e.x,e.y);this.__viewportControl.setOrientation(e)};d.handleGuideKeyframesChangeEvent=function(){this.$SphericalViewportGuide3=!0};d.handleSetupCompleteEvent=function(){var a=this;this.__viewportControl.getVPC().registerOption("VideoWithSphericalGuide","enabled",function(){return a.__viewportControl.isGuideEnabled()});this.__viewportControl.getVPC().registerOption("VideoWithSphericalGuide","auto",function(){return a.__viewportControl.getCurrentMovement()===a});this.__viewportControl.getVPC().registerOption("VideoWithSphericalGuide","intervalData",function(){return a.$SphericalViewportGuide1});this.$SphericalViewportGuide3=!1};d.handleVideoSeekEvent=function(){this.$SphericalViewportGuide3=!1,this.$SphericalViewportGuide1=null};d.$SphericalViewportGuide7=function(a,c){c={baseTime:a[0],nextTime:c[0],deltaTime:c[0]-a[0],baseX:a[2],deltaX:b("normalizeDeltaYaw")(c[2]-a[2]),baseY:a[1],deltaY:c[1]-a[1]};this.__viewportControl.getVPC().emit("VideoWithSphericalGuide/intervalUpdate",c);this.$SphericalViewportGuide1=c};d.$SphericalViewportGuide8=function(a,c){c={startTime:Date.now(),baseX:a[2],deltaX:b("normalizeDeltaYaw")(c[2]-a[2]),baseY:a[1],deltaY:c[1]-a[1]};this.__viewportControl.getVPC().emit("VideoWithSphericalGuide/intervalUpdate",c);this.$SphericalViewportGuide2=c};return c}(b("SphericalViewportMovement"));e.exports=a}),null);
__d("SphericalViewportKeyboardPan",["Event","SphericalViewportMovement","SphericalViewportMovementEnum","SphericalViewportPriorityConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=.04,h=16;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,b)||this}var d=c.prototype;d.isValid=function(){return this.__viewportControl.isFullscreen()||!this.__viewportControl.isInTahoe()};d.isActive=function(){var a=this.__viewportControl.getDirectionKeyMap();return Object.values(a).some(function(a){return a})};d.getStartPriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").KEYBOARD_PAN].START};d.getActivePriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").KEYBOARD_PAN].ACTIVE};d.animate=function(a){__p&&__p();var b=this.$SphericalViewportKeyboardPan1?a-this.$SphericalViewportKeyboardPan1:h;this.$SphericalViewportKeyboardPan1=a;a=this.__viewportControl.getDirectionKeyMap();var c=this.__viewportControl.getOrientation();b=b*g;a.right&&(c.x+=b);a.left&&(c.x-=b);a.up&&(c.y+=b);a.down&&(c.y-=b);this.__viewportControl.setOrientation(c)};d.deactivate=function(){this.$SphericalViewportKeyboardPan1=null};d.handleDirectionalKeyDownEvent=function(a){b("Event").prevent(a)};d.handleDirectionalKeyUpEvent=function(a){b("Event").prevent(a)};return c}(b("SphericalViewportMovement"));e.exports=a}),null);
__d("SphericalViewportMovement",["Event","SphericalViewportControlNew","SphericalViewportPriorityConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.__viewportControl=a}var c=a.prototype;c.isValid=function(){return!0};c.isActive=function(){return!0};c.animate=function(a){};c.activate=function(){};c.deactivate=function(){};c.getStartPriority=function(){return b("SphericalViewportPriorityConfig").NONE};c.getActivePriority=function(){return b("SphericalViewportPriorityConfig").NONE};c.handleWheelEvent=function(a){};c.handleMouseDownEvent=function(a){};c.handleGlobalMouseMoveEvent=function(a){};c.handleGlobalMouseUpEvent=function(a){};c.handleGlobalMouseLeaveEvent=function(a){};c.handleCompassClickEvent=function(){};c.handleGuideKeyframesChangeEvent=function(a){};c.handleSetupCompleteEvent=function(){};c.handleWindowViewportChangedEvent=function(){};c.handleDirectionalKeyDownEvent=function(a){};c.handleDirectionalKeyUpEvent=function(a){};c.handleVideoSeekEvent=function(){};return a}();e.exports=a}),null);
__d("SphericalViewportParallax",["invariant","SphericalParallaxUtils","SphericalViewportMovement","SphericalViewportMovementEnum","SphericalViewportPriorityConfig","VideoPlayerLoggerSource","getElementRect","getViewportDimensions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("SphericalParallaxUtils").calculateYawOffset;a=.8;var i=16;c=15;var j=a/i/c,k=50,l=.1;d=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,b)||this}var d=c.prototype;d.isValid=function(){return this.__viewportControl.getVPC().getSource()===b("VideoPlayerLoggerSource").INLINE};d.getStartPriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").PARALLAX].START};d.getActivePriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").PARALLAX].ACTIVE};d.animate=function(a){__p&&__p();var b=this.__viewportControl.getOrientation();b.x-this.$SphericalViewportParallax2>180&&(b.x-=360);this.$SphericalViewportParallax2-b.x>180&&(b.x+=360);var c=Math.abs(b.x-this.$SphericalViewportParallax2);c<=180||g(0,4631);if(c<l)return;var d=this.$SphericalViewportParallax3?a-this.$SphericalViewportParallax3:i;this.$SphericalViewportParallax3=a;a=c*j;c=Math.max(d,k);b.x<this.$SphericalViewportParallax2?b.x+=Math.min(this.$SphericalViewportParallax2-b.x,a*c):b.x-=Math.min(b.x-this.$SphericalViewportParallax2,a*c);this.__viewportControl.setOrientation(b)};d.activate=function(){this.$SphericalViewportParallax2=this.__viewportControl.getOrientation().x;var a=this.$SphericalViewportParallax4();this.$SphericalViewportParallax1=this.$SphericalViewportParallax2-a};d.deactivate=function(){this.$SphericalViewportParallax3=null};d.handleWindowViewportChangedEvent=function(){this.$SphericalViewportParallax2=this.$SphericalViewportParallax4()+this.$SphericalViewportParallax1};d.$SphericalViewportParallax4=function(){__p&&__p();var a=this.__viewportControl.getVPC().getRootNode();a||g(0,4632);a=b("getElementRect")(a);a=a.top+a.bottom/2;var c=b("getViewportDimensions").withoutScrollbars().height;a=a/c*100;c=this.__viewportControl.getHFOV();a=h(a,null,null,c);c=a.yaw;a=a.success;a||g(0,4633);return c};return c}(b("SphericalViewportMovement"));e.exports=d}),null);
__d("SphericalViewportRecenter",["invariant","SphericalViewportMovement","SphericalViewportMovementEnum","SphericalViewportPriorityConfig","easeInOutInterpolate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=1e3;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;b.$SphericalViewportRecenter2=!1;return b}var d=c.prototype;d.isValid=function(){return!this.__viewportControl.isGuideEnabled()};d.isActive=function(){return this.$SphericalViewportRecenter2};d.getStartPriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").RECENTER].START};d.getActivePriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").RECENTER].ACTIVE};d.animate=function(){if(!this.$SphericalViewportRecenter2)return;var a=Date.now(),c;a-this.$SphericalViewportRecenter1>h?(c=1,this.$SphericalViewportRecenter2=!1,this.__viewportControl.getVPC().emit("SphericalVideoRecenterControl/animationEnd")):c=b("easeInOutInterpolate")((a-this.$SphericalViewportRecenter1)/h);a=this.$SphericalViewportRecenter3;c={x:a.deltaX*c+a.startX,y:a.deltaY*c+a.startY,vFOV:this.__viewportControl.getOrientation().vFOV};this.__viewportControl.setOrientation(c)};d.deactivate=function(){this.$SphericalViewportRecenter2=!1,this.__viewportControl.getVPC().emit("SphericalVideoRecenterControl/animationEnd")};d.handleCompassClickEvent=function(){if(this.$SphericalViewportRecenter2)return;this.$SphericalViewportRecenter2=!0;this.$SphericalViewportRecenter1=Date.now();this.$SphericalViewportRecenter4(this.__viewportControl.getOrientation());this.__viewportControl.getVPC().emit("SphericalVideoRecenterControl/animationStart")};d.$SphericalViewportRecenter4=function(a){var b=this.__viewportControl.getInitialOrientation(),c=b.x-a.x;Math.abs(c)<=360||g(0,1643);c<-180&&(c+=360);c>180&&(c-=360);b=b.y-a.y;Math.abs(b)<=180||g(0,1644);this.$SphericalViewportRecenter3={startX:a.x,deltaX:c,startY:a.y,deltaY:b}};return c}(b("SphericalViewportMovement"));e.exports=a}),null);
__d("SphericalViewportWWWZoom",["Event","SphericalViewportMovement","SphericalViewportMovementEnum","SphericalViewportPriorityConfig","debounce","throttle"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=1e3,h=30;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this,c)||this;d.$SphericalViewportWWWZoom1=b("debounce")(function(){return d.__viewportControl.emit("zoomStart")},g);d.$SphericalViewportWWWZoom2=b("throttle")(function(a){a=(a.deltaX||0)+(a.deltaY||0)+(a.deltaZ||0);a=a/120*45/10;var b=d.__viewportControl.getOrientation();b.vFOV+=a;a=d.__viewportControl.setOrientation(b);a&&d.$SphericalViewportWWWZoom1()},h);return d}var d=c.prototype;d.isValid=function(){return this.__viewportControl.isInTahoe()&&this.__viewportControl.isMouseOnElement()};d.isActive=function(){return!1};d.getStartPriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").WWW_ZOOM].START};d.getActivePriority=function(){return b("SphericalViewportPriorityConfig")[b("SphericalViewportMovementEnum").WWW_ZOOM].ACTIVE};d.handleWheelEvent=function(a){this.$SphericalViewportWWWZoom2(a),a.preventDefault(),b("Event").kill(a)};return c}(b("SphericalViewportMovement"));e.exports=a}),null);
__d("SphericalViewportControlStore",["invariant","FluxMapStore","Rect","SphericalVideoComponentActions","SphericalVideoComponentConstants","SphericalVideoComponentDispatcher","SphericalViewportControl","SphericalViewportControlNew","Vector","clearTimeout","curry","gkx","immutable","setTimeout","throttle"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={fieldOfView:-1,initialPitch:-1,initialYaw:-1,isInChannelView:!1,isInTahoe:!1,pitch:-1,viewport:null,viewportGrabbed:!1,viewportHeight:0,viewportInactivityTimeout:0,viewportPanStart:!1,viewportWidth:0,yaw:-1};var h=5e3,i=b("gkx")("678911"),j=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(b("immutable").Record(a));c=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return b("immutable").Map({sphericalViewportControls:b("immutable").Map({}),sphericalViewportControlStates:b("immutable").Map({})})};d.reduce=function(a,c){__p&&__p();var d=c.id;switch(c.type){case b("SphericalVideoComponentConstants").ACTIONS.REGISTER_SPHERICAL_VIEWPORT_CONTROL:var e=c.sphericalViewportControl,f=c.viewport,h;i?(e instanceof b("SphericalViewportControlNew")||g(0,4469),h={"new":!0,control:e}):(e instanceof b("SphericalViewportControl")||g(0,4470),h={"new":!1,control:e});a=this.$SphericalViewportStore1(a,d,h,f);break;case b("SphericalVideoComponentConstants").ACTIONS.CHANGE_VIEWPORT:e=c.yaw;h=c.pitch;f=c.fieldOfView;a=this.$SphericalViewportStore2(a,d,e,h,f);break;case b("SphericalVideoComponentConstants").ACTIONS.TOGGLE_VIEWPORT_GRABBED:a=this.$SphericalViewportStore3(a,d);break;case b("SphericalVideoComponentConstants").ACTIONS.UPDATE_VIEWPORT_DIMENSIONS:e=c.width;h=c.height;a=this.$SphericalViewportStore4(a,d,e,h);break;case b("SphericalVideoComponentConstants").ACTIONS.TOGGLE_CHANNEL_VIEW:f=c.isInChannelView;a=this.$SphericalViewportStore5(a,d,f);break;case b("SphericalVideoComponentConstants").ACTIONS.TOGGLE_TAHOE:e=c.isInTahoe;a=this.$SphericalViewportStore6(a,d,e);break;case b("SphericalVideoComponentConstants").ACTIONS.SET_USER_IS_INACTIVE:a=this.$SphericalViewportStore7(a,d);break;case b("SphericalVideoComponentConstants").ACTIONS.SET_INITIAL_VIEWPORT:a=this.$SphericalViewportStore8(a,d,c.yaw,c.pitch);break;default:break}return a};d.getViewportControlWrapper=function(a){var b=this.get("sphericalViewportControls");if(b&&b.has(a))return b.get(a);else throw new Error("Video player controller with id "+a+" is not registered")};d.getOrientation=function(a){a=this.$SphericalViewportStore9(this.getState(),a);var b=a.yaw;a=a.pitch;return{yaw:b,pitch:a}};d.getUserIsActive=function(a){a=this.$SphericalViewportStore9(this.getState(),a);return a.viewportInactivityTimeout!==0};d.getFieldOfView=function(a){return this.$SphericalViewportStore9(this.getState(),a).fieldOfView};d.getViewportGrabbed=function(a){return this.$SphericalViewportStore9(this.getState(),a).viewportGrabbed};d.getInitialYaw=function(a){return this.$SphericalViewportStore9(this.getState(),a).initialYaw};d.getInitialPitch=function(a){return this.$SphericalViewportStore9(this.getState(),a).initialPitch};d.getIsInChannelView=function(a){return this.$SphericalViewportStore9(this.getState(),a).isInChannelView};d.getIsInTahoe=function(a){return this.$SphericalViewportStore9(this.getState(),a).isInTahoe};d.getViewportDimensions=function(a){return{width:this.$SphericalViewportStore9(this.getState(),a).viewportWidth,height:this.$SphericalViewportStore9(this.getState(),a).viewportHeight}};d.getViewportPositionVector=function(a){a=this.$SphericalViewportStore9(this.getState(),a);return new(b("Rect"))(a.viewport).getPositionVector()};d.getViewportCenterVector=function(a){var c=this.getViewportPositionVector(a);a=this.getViewportDimensions(a);var d=a.width;a=a.height;d=new(b("Vector"))(d/2,a/2);return c.add(d)};d.onViewportGrabbed=function(a){b("SphericalVideoComponentActions").toggleViewportGrabbed(a)};d.onViewportPanStart=function(a,b){return};d.onViewportPanEnd=function(a){b("SphericalVideoComponentActions").toggleViewportGrabbed(a)};d.onViewportChange=function(a,c,d,e){b("SphericalVideoComponentActions").changeViewport(a,c,d,e)};d.$SphericalViewportStore1=function(a,c,d,e){__p&&__p();var f=a.get("sphericalViewportControls");if(f.has(c))return a;f=f.set(c,d);a=a.set("sphericalViewportControls",f);f=a.get("sphericalViewportControlStates");var g=d.control;d=new j({yaw:g.getOrientation().x,pitch:g.getOrientation().y,fieldOfView:d["new"]?d.control.getOrientation().vFOV:d.control.getVerticalFieldOfView(),viewport:e});f=f.set(c,d);a=a.set("sphericalViewportControlStates",f);g.addListener("viewportChange",b("throttle")(b("curry")(this.onViewportChange,c),16));g.addListener("updateViewportBegin",b("curry")(this.onViewportGrabbed,c));g.addListener("updateViewportEnd",b("curry")(this.onViewportPanEnd,c));return a};d.$SphericalViewportStore2=function(a,c,d,e,f){__p&&__p();var g=[["yaw",d],["pitch",e],["fieldOfView",f]];for(var h=0;h<g.length;h++){var i=g[h],j=i[0];i=i[1];a=this.$SphericalViewportStore10(a,c,j,i)}j=this.getViewportControlWrapper(c);j["new"]?j.control.setOrientation({x:d,y:e,vFOV:f}):(j.control.setSphericalOrientation(d,e),j.control.setFieldOfView(f));i=this.$SphericalViewportStore9(a,c).get("viewportInactivityTimeout");b("clearTimeout")(i);a=this.$SphericalViewportStore10(a,c,"viewportInactivityTimeout",this.$SphericalViewportStore11(c));return a};d.$SphericalViewportStore11=function(a){return b("setTimeout")(function(){return b("SphericalVideoComponentActions").setUserIsInactive(a)},h)};d.$SphericalViewportStore7=function(a,b){a=this.$SphericalViewportStore10(a,b,"viewportInactivityTimeout",0);return a};d.$SphericalViewportStore8=function(a,b,c,d){a=this.$SphericalViewportStore10(a,b,"initialYaw",c);a=this.$SphericalViewportStore10(a,b,"initialPitch",d);return a};d.$SphericalViewportStore4=function(a,b,c,d){a=this.$SphericalViewportStore10(a,b,"viewportWidth",c);a=this.$SphericalViewportStore10(a,b,"viewportHeight",d);return a};d.$SphericalViewportStore3=function(a,b){var c=this.$SphericalViewportStore9(a,b).viewportGrabbed;return this.$SphericalViewportStore10(a,b,"viewportGrabbed",!c)};d.$SphericalViewportStore5=function(a,b,c){return this.$SphericalViewportStore10(a,b,"isInChannelView",c)};d.$SphericalViewportStore6=function(a,b,c){return this.$SphericalViewportStore10(a,b,"isInTahoe",c)};d.$SphericalViewportStore10=function(a,b,c,d){var e=this.$SphericalViewportStore9(a,b),f=a.get("sphericalViewportControlStates");e=e.set(c,d);f=f.set(b,e);return a.set("sphericalViewportControlStates",f)};d.$SphericalViewportStore9=function(a,b){a=a.get("sphericalViewportControlStates").get(b);a||this.$SphericalViewportStore12(b);return a};d.$SphericalViewportStore12=function(a){throw new Error("Viewport control with id "+a+" does not exist")};return c}(b("FluxMapStore"));c.__moduleID=e.id;e.exports=new c(b("SphericalVideoComponentDispatcher"))}),null);
__d("VideoPlayerControllerStore",["FluxMapStore","SphericalVideoComponentActions","SphericalVideoComponentConstants","SphericalVideoComponentDispatcher","VideoPlayerReason","VideoPlayerReasonTransitionHelper","VideoPlayerStates","curry","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(b("immutable").Record({currentTime:-1,currentVideoPlayerState:b("VideoPlayerStates").UNKNOWN,durationSeconds:-1,videoId:""}));a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.onVideoPlayerControllerStateChange=function(a){var c=a.getVideoPlayerID(),e=d.$VideoPlayerControllerStore6(d.getState(),c);e=e.videoPlayerState;a=a.getState();e!==a&&b("SphericalVideoComponentActions").updateVideoPlayerState(c,a)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.getInitialState=function(){return b("immutable").Map({videoPlayerControllers:b("immutable").Map({}),videoPlayerControllerStates:b("immutable").Map({})})};d.reduce=function(a,c){__p&&__p();var d=c.id;switch(c.type){case b("SphericalVideoComponentConstants").ACTIONS.REGISTER_VIDEO_PLAYER_CONTROLLER:var e=c.controller;a=this.$VideoPlayerControllerStore1(a,e,d);break;case b("SphericalVideoComponentConstants").ACTIONS.UPDATE_VIDEO_PLAYER_STATE:a=this.$VideoPlayerControllerStore2(a,d,c.state);break;case b("SphericalVideoComponentConstants").ACTIONS.TOGGLE_PLAY:a=this.$VideoPlayerControllerStore3(a,d,c.nextIsPlaying);break;case b("SphericalVideoComponentConstants").ACTIONS.SET_CURRENT_PLAY_TIME:a=this.$VideoPlayerControllerStore4(a,d,c.time);break;case b("SphericalVideoComponentConstants").ACTIONS.SET_VIDEO_DURATION:a=this.$VideoPlayerControllerStore5(a,d,c.durationSeconds);break;default:break}return a};d.getVideoPlayerController=function(a){var b=this.get("videoPlayerControllers");if(b&&b.has(a))return b.get(a);else throw new Error("Video player controller with id "+a+" is not registered")};d.getIsVideoPlayable=function(a){a=this.$VideoPlayerControllerStore6(this.getState(),a).currentVideoPlayerState;return a!==b("VideoPlayerStates").FALLBACK&&a!==b("VideoPlayerStates").DESTROYED&&a!==b("VideoPlayerStates").UNKNOWN};d.getIsPlaying=function(a){var c=this.getVideoPlayerController(a).isBuffering();a=this.$VideoPlayerControllerStore6(this.getState(),a).currentVideoPlayerState;return a===b("VideoPlayerStates").PLAYING&&!c};d.getCurrentTime=function(a){return this.$VideoPlayerControllerStore6(this.getState(),a).currentTime};d.getVideoID=function(a){return this.$VideoPlayerControllerStore6(this.getState(),a).videoId};d.$VideoPlayerControllerStore1=function(a,c,d){__p&&__p();var e=a.get("videoPlayerControllers");if(e.has(d))return a;e=e.set(d,c);a=a.set("videoPlayerControllers",e);e=a.get("videoPlayerControllerStates");var f=new g({isPlaying:c.isState(b("VideoPlayerStates").PLAYING),currentTime:c.getCurrentTimePosition(),videoId:c.getVideoID()});e=e.set(d,f);a=a.set("videoPlayerControllerStates",e);c.addListener("stateChange",b("curry")(this.onVideoPlayerControllerStateChange,c));c.addListener("updateStatus",b("curry")(this.onTimeUpdate,c));c.addListener("updateMetadata",b("curry")(this.onUpdateMetaData,c));c.addListener("VideoChannelController/pendingElementsShown",b("curry")(this.onToggleChannelView,c,!0));c.addListener("VideoChannelController/exitChannel",b("curry")(this.onToggleChannelView,c,!1));c.addListener("seekRequested",b("curry")(this.onSeekStart,c));c.addListener("TahoeController/enterTahoe",b("curry")(this.onToggleTahoe,c,!0));c.addListener("TahoeController/exitTahoe",b("curry")(this.onToggleTahoe,c,!1));return a};d.onTimeUpdate=function(a,c){b("SphericalVideoComponentActions").setCurrentVideoTime(a.getVideoPlayerID(),c.position)};d.onSeekStart=function(a){b("SphericalVideoComponentActions").seekStart(a.getVideoPlayerID())};d.onUpdateMetaData=function(a){b("SphericalVideoComponentActions").setVideoDuration(a.getVideoPlayerID(),a.getPlaybackDuration())};d.onToggleChannelView=function(a,c){b("SphericalVideoComponentActions").toggleChannelView(a.getVideoPlayerID(),c)};d.onToggleTahoe=function(a,c){b("SphericalVideoComponentActions").toggleTahoe(a.getVideoPlayerID(),c)};d.$VideoPlayerControllerStore3=function(a,c,d){var e=this.getVideoPlayerController(c);c=this.$VideoPlayerControllerStore6(this.getState(),c);c=c.currentVideoPlayerState;(c===b("VideoPlayerStates").PLAYING&&!d||c===b("VideoPlayerStates").PAUSED&&d)&&(d?e.play(new(b("VideoPlayerReasonTransitionHelper"))(b("VideoPlayerReason").USER)):e.pause());return a};d.$VideoPlayerControllerStore4=function(a,b,c){return this.$VideoPlayerControllerStore7(a,b,"currentTime",c)};d.$VideoPlayerControllerStore2=function(a,b,c){return this.$VideoPlayerControllerStore7(a,b,"currentVideoPlayerState",c)};d.$VideoPlayerControllerStore5=function(a,b,c){return this.$VideoPlayerControllerStore7(a,b,"durationSeconds",c)};d.$VideoPlayerControllerStore6=function(a,b){a=a.get("videoPlayerControllerStates").get(b);a||this.$VideoPlayerControllerStore8(b);return a};d.$VideoPlayerControllerStore7=function(a,b,c,d){var e=a.get("videoPlayerControllerStates"),f=this.$VideoPlayerControllerStore6(a,b);f=f.set(c,d);e=e.set(b,f);return a.set("videoPlayerControllerStates",e)};d.$VideoPlayerControllerStore8=function(a){throw new Error("Video player controller with id "+a+" does not exist")};return c}(b("FluxMapStore"));a.__moduleID=e.id;e.exports=new a(b("SphericalVideoComponentDispatcher"))}),null);
__d("SphericalVideoHalfEquirectConfig",["SphericalMediaConstants"],(function(a,b,c,d,e,f){"use strict";var g=b("SphericalMediaConstants").HALF_EQUIRECT_PARTIAL_LIMIT,h=b("SphericalMediaConstants").RB_FRICTION,i=b("SphericalMediaConstants").RB_MAX_SPRING_DEGREE,j=b("SphericalMediaConstants").RB_MAX_STRETCH_X_DEGREE,k=b("SphericalMediaConstants").RB_MAX_STRETCH_Y_DEGREE,l=b("SphericalMediaConstants").RB_SPRING_FACTOR;a={getHalfEquirectangularPartialLimits:function(){return{partialLeftDegrees:g,partialRightDegrees:g,partialTopDegrees:g,partialBottomDegrees:g}},getHalfEquirectangularControllerConfig:function(){return{enableRubberBanding:!0,springFactor:l,maxSpringDegrees:i,maxStretchXDegrees:j,maxStretchYDegrees:k,rubberBandConstant:h}}};e.exports=a}),null);
__d("SphericalMediaUtils",[],(function(a,b,c,d,e,f){"use strict";a={getDPR:function(){return Math.max(window.devicePixelRatio||1,1)}};e.exports=a}),null);
__d("SphericalMediaHeadingIndicator.react",["cx","EventListener","React","SphericalMediaConstants","SphericalMediaUtils","SphericalPhotoProjectionUtils","SubscriptionsHandler","calculateHFOVFromVFOV","degToRad","easeInOutInterpolate","requestAnimationFrame","uniqueID"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("SphericalMediaConstants").HI_SIZE_NORMAL,i=b("SphericalMediaConstants").HI_SIZE_FULL,j=b("SphericalMediaConstants").HI_ALPHA_BG,k=b("SphericalMediaConstants").HI_ALPHA_ELEMENT,l=b("SphericalMediaConstants").HI_ALPHA_DURATION,m=b("SphericalMediaConstants").HI_FADE_OUT_DELAY,n=b("SphericalMediaConstants").HI_BLINK_ARC_RAD,o=b("SphericalMediaConstants").HI_BLINK_DURATION,p=b("SphericalMediaUtils").getDPR,q=function(a){return a!==void 0&&a!==null},r=function(a,b,c,d){a.beginPath(),a.arc(b.x,b.y,c*p(),0,2*Math.PI,!1),a.fillStyle=d,a.lineWidth=0,a.fill()},s=function(a,b,c,d,e,f,g){var h=p();a.beginPath();a.arc(b.x,b.y,c*h,d,e,!1);a.lineWidth=f*h;a.strokeStyle=g;a.stroke()};a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this,c)||this;d.$13=function(){var a=d.__getDrawData();if(!q(a.poiYaw)){d.$11=!1;d.draw(a);return}var c=(Date.now()-d.__blinkStartTime)%o<o/2;d.$11!==c&&(d.$11=c,d.draw(a));b("requestAnimationFrame")(d.$13)};d.$15=function(){if(d.$6===j.end)return;d.$25(j.start,j.end,k.start,k.end)};d.$16=function(){if(d.$6===j.start)return;d.$25(j.end,j.start,k.end,k.start)};d.$2=b("uniqueID")();d.$5=0;d.$6=j.start;d.$7=k.start;d.$8=null;d.$9=!1;d.$10=!1;d.$11=!1;if(!d.constructor.__subClassMethods)throw new Error('Must implement "static __subClassMethods"');for(var e in d.constructor.__subClassMethods)if(typeof babelHelpers.assertThisInitialized(d)[e]!=="function")throw new Error('Must implement "'+e+'"');b("requestAnimationFrame")(d.$13);return d}var d=c.prototype;d.UNSAFE_componentWillReceiveProps=function(a){var b=a.isActive&&a.isPanning!==this.props.isPanning;b&&this.$14(a.isPanning)};d.shouldComponentUpdate=function(a){a=a.aspectRatio!==this.props.aspectRatio||a.isActive!==this.props.isActive||a.isGuideAuto!==this.props.isGuideAuto||a.useLargeHeadingIndicator!==this.props.useLargeHeadingIndicator;return a};d.$14=function(a,b){var c=this;b===void 0&&(b=!0);this.$5+=a?1:-1;a?(this.$8!==null&&clearTimeout(this.$8),this.$15()):this.$5===0&&(this.$8=setTimeout(function(){c.$8=null,c.$16()},b?m:0))};d.$17=function(){var a=this.$18(),b=p();return{width:a.width*b,height:a.height*b}};d.$18=function(){return this.props.useLargeHeadingIndicator?i:h};d.$19=function(){var a=this.$17();return{x:a.width/2,y:a.height/2}};d.draw=function(a){__p&&__p();if(!this.$1)return;var b=this.$1,c=this.$17();(b.width!==c.width||b.height!==c.height)&&(b.width=c.width,b.height=c.height);b=b.getContext("2d");if(!b)return;b.save();b.clearRect(0,0,c.width,c.height);this.$20(b,a);this.$21(b,a);this.$22(b,a);b.restore()};d.$20=function(a,c){__p&&__p();var d=this.$18(),e=this.$19(),f=c.fov*this.props.aspectRatio;f=b("degToRad")(f)/2;r(a,e,d.background_radius,this.$23());if(this.props.isGuideAuto){var g=d.inner_radius+d.inner_stroke/2-d.center_radius;s(a,e,d.center_radius+g/2,0,2*Math.PI,g,this.$24())}else{r(a,e,d.center_radius,this.$24());g=this.props.partialLimits;if(g&&g.partialLeftDegrees&&g.partialRightDegrees){var h=g.partialLeftDegrees;g=g.partialRightDegrees;s(a,e,d.inner_radius,0,2*Math.PI,d.inner_stroke,this.getPartialPanoElementColor());c=270-c.initialYaw;h=b("degToRad")(h*-1+c+f);g=b("degToRad")(g+c-f);s(a,e,d.inner_radius,h||0,g||0,d.inner_stroke,this.$24())}else s(a,e,d.inner_radius,0,2*Math.PI,d.inner_stroke,this.$24())}};d.$22=function(a,c){__p&&__p();var d=this.$18(),e=this.$19();if(this.props.isGuideAuto&&this.$11){var f=b("degToRad")((c.poiYaw||0)-c.initialYaw)-Math.PI/2;s(a,e,d.rim_radius,f-n/2,f+n/2,d.rim_stroke,this.$24())}f=p();var g=d.triangle[0]*f,h=d.triangle[1]*f;d=d.triangle[2]*f;a.translate(e.x,e.y);if(c.pointerYaw){f=c.pointerYaw-c.initialYaw;a.rotate(b("degToRad")(f||0))}a.beginPath();a.moveTo(0,g-e.y);a.lineTo(-h,d-e.y);a.lineTo(h,d-e.y);a.fillStyle=this.$24();a.fill()};d.$21=function(a,c){__p&&__p();var d=this.$18(),e=this.$19(),f=this.props,g=f.partialLimits,h=f.aspectRatio;f=f.showNewPhotoRenderer;var i=c.yaw-c.initialYaw,j=b("calculateHFOVFromVFOV")(c.fov,this.props.aspectRatio);j=b("degToRad")(j)/2;if(f&&g){f=b("SphericalPhotoProjectionUtils").getRelativeHfov(c.fov,h,g);j=f/2}c=b("degToRad")(i)-Math.PI/2;h=this.props.isGuideAuto;if(h){g=p();a.save();a.beginPath();a.lineWidth=d.arc_stroke*g;a.arc(e.x,e.y,(d.arc_radius+d.arc_stroke/2)*g,c-j,c+j,!1);a.arc(e.x,e.y,(d.arc_radius-d.arc_stroke/2)*g,c+j,c-j,!0);a.clip();f=this.$17();a.clearRect(0,0,f.width,f.height);a.restore()}s(a,e,d.arc_radius,c-j,c+j,d.arc_stroke,h?this.$23():this.$24())};d.getPartialPanoElementColor=function(){return"rgba(255, 255, 255, "+this.$7*.4+")"};d.$24=function(){return"rgba(255, 255, 255, "+this.$7+")"};d.$23=function(){return"rgba(0, 0, 0, "+this.$6+")"};d.$25=function(a,c,d,e){__p&&__p();var f=this;this.$10=this.$9;this.$9=!0;var g=Date.now(),h=function a(d){__p&&__p();var h=Date.now();if(f.$10){f.$10=!1;return}if(h-g>l){f.$9=!1;f.$6=c;f.$7=e;return}b("requestAnimationFrame")(function(){a(d)});h=b("easeInOutInterpolate")((h-g)/l);var i=d.deltaAlphaBG*h+d.startAlphaBG;h=d.deltaAlphaElement*h+d.startAlphaElement;f.$6=i;f.$7=h;f.draw(f.__getDrawData())},i=c-a,j=e-d;b("requestAnimationFrame")(function(){h({startAlphaBG:a,deltaAlphaBG:i,startAlphaElement:d,deltaAlphaElement:j})})};d.componentDidMount=function(){var a=this;this.props.isActive&&this.draw(this.__getDrawData());this.props.useNativeListeners&&(this.$12=new(b("SubscriptionsHandler"))(),this.$12.addSubscriptions(b("EventListener").listen(this.$4,"click",function(b){return a.__onClick(b)}),b("EventListener").listen(this.$4,"mouseover",function(){return a.$14(!0)}),b("EventListener").listen(this.$4,"mouseout",function(){return a.$14(!1,!1)})))};d.componentDidUpdate=function(){this.props.isActive&&this.draw(this.__getDrawData()),b("requestAnimationFrame")(this.$13)};d.componentWillUnmount=function(){this.$1=null,this.props.useNativeListeners&&this.$12.release()};d.render=function(){var a=this,c=this.$18(),d=this.props.isActive,e={};this.props.useNativeListeners||(e.onClick=function(b){return a.__onClick(b)},e.onMouseOver=function(){return a.$14(!0)},e.onMouseOut=function(){return a.$14(!1,!1)});return b("React").createElement("button",babelHelpers["extends"]({},e,{ref:function(b){return a.$4=b},className:"_17az sphericalHeadingIndicator"+(d?"":" hidden_elem"),style:{width:c.width,height:c.height}}),b("React").createElement("div",{className:"_17a-",ref:function(b){return a.$3=b}},b("React").createElement("canvas",{className:"_5nxw _17ay",ref:function(b){return a.$1=b}})))};return c}(b("React").Component);e.exports=a}),null);
__d("SphericalVideoHeadingIndicator.react",["cx","fbt","BasicFBNux","React","SphericalMediaHeadingIndicator.react","SphericalPhotoPartialLimits","SphericalVideoExperiments","SphericalVideoHalfEquirectConfig","SphericalViewportControlStore","SubscriptionsHandler","VideoPlayerLoggerSource","VideoPlayerStates","XUIAmbientNUX.react","gkx"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=b("SphericalPhotoPartialLimits").makePartialLimits,j=4320,k=h._("You're watching the best views from this 360 video only. You can swipe or drag the video to watch it manually."),l=b("gkx")("678911"),m=function(a){return a!==void 0&&a!==null},n=function(b){"use strict";__p&&__p();babelHelpers.inheritsLoose(a,b);function a(a){a=b.call(this,a)||this;m(a.__getDrawData().poiYaw)&&(a.__blinkStartTime=Date.now());return a}var c=a.prototype;c.__onClick=function(a){this.props.onClick(a)};c.__getDrawData=function(){return{fov:this.props.fov,initialYaw:this.props.initialYaw,pointerYaw:this.props.pointerYaw,poiYaw:this.props.poiYaw,yaw:this.props.yaw}};c.$SphericalHeadingIndicatorImpl1=function(a){return{fov:a.fov,initialYaw:a.initialYaw,pointerYaw:a.pointerYaw,poiYaw:a.poiYaw,yaw:a.yaw}};c.UNSAFE_componentWillReceiveProps=function(a){b.prototype.UNSAFE_componentWillReceiveProps.call(this,a);!m(this.props.poiYaw)&&m(a.poiYaw)&&(this.__blinkStartTime=Date.now());var c=a.isActive===this.props.isActive&&(a.initialYaw!==this.props.initialYaw||a.aspectRatio!==this.props.aspectRatio||a.fov!==this.props.fov||a.yaw!==this.props.yaw||a.pointerYaw!==this.props.pointerYaw||a.poiYaw!==this.props.poiYaw);c&&this.draw(this.$SphericalHeadingIndicatorImpl1(a))};c.shouldComponentUpdate=function(a){a=b.prototype.shouldComponentUpdate.call(this,a)||a.poiYaw!==this.props.poiYaw;return a};return a}(b("SphericalMediaHeadingIndicator.react"));n.__subClassMethods={__onClick:!0,__getDrawData:!0};a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this,c)||this;d.$6=!1;d.$1=c.controller;d.$5=c.isComposer;d.$5||(d.$3=j,d.$4=k);d.$2=new(b("SubscriptionsHandler"))();return d}var d=c.prototype;d.componentDidMount=function(){var a=this;this.$1.getOption("SphericalVideoPlayer","isReady")?this.$7():this.$2.addSubscriptions(this.$1.once("SphericalVideoPlayer/ready",function(){return a.$7()}))};d.componentWillUnmount=function(){this.$2.release()};d.$7=function(){__p&&__p();var a=this,c=this.$1.getVideoPlayerID();this.$2.addSubscriptions(this.$1.addListener("PhotoSnowlift/enterSnowlift",function(){return a.$8(!0)}),this.$1.addListener("PhotoSnowlift/exitSnowlift",function(){return a.$8(!1)}),this.$1.addListener("toggleFullscreen",function(){return a.$9()}),this.$1.addListener("beginPlayback",function(){return a.$10(!0)}),this.$1.addListener("finishPlayback",function(){return a.$10(!1)}),this.$1.addListener("VideoChannelController/enterChannel",function(){return a.$11(!0)}),this.$1.addListener("VideoChannelController/exitChannel",function(){return a.$11(!1)}),this.$1.addListener("TahoeController/enterTahoe",function(){return a.$12(!0)}),this.$1.addListener("TahoeController/exitTahoe",function(){return a.$12(!1)}),b("SphericalViewportControlStore").addListener(function(){var d=b("SphericalViewportControlStore"),e=d.getOrientation(c),f=e.pitch;e=e.yaw;a.setState({isActive:d.getViewportGrabbed(c),pitch:f,yaw:e,fov:d.getFieldOfView(c)})}),this.$1.addListener("SphericalVideoRecenterControl/animationStart",function(){return a.$13(!0)}),this.$1.addListener("SphericalVideoRecenterControl/animationEnd",function(){return a.$13(!1)}),this.$1.addListener("VideoControls/visibilityUpdate",function(b){b=b.areControlsVisible;return a.$13(b)}),this.$1.addListener("viewportChange",function(b,c){return a.forceUpdate()}),this.$1.addListener("VideoWithSphericalGuide/viewportChange",function(b){return a.setState({pointerYaw:b})}),this.$1.addListener("VideoWithSphericalGuide/intervalUpdate",function(b){return a.$14(b)}),this.$1.addListener("VideoWithSphericalGuide/toggle",function(b){return a.setState({isGuideAuto:b})}),this.$1.addListener("VideoWithSphericalGuide/stateToggle",function(b){b||a.setState({isGuideAuto:!1,poiYaw:void 0,pointerYaw:0})}));this.setState({isVisible:this.$1.isState(b("VideoPlayerStates").PLAYING),isActive:!1,inChannel:this.$1.getIsInChannel(),inSnowlift:this.$1.getOption("PhotoSnowlift","isInSnowlift"),inTahoe:this.$1.getSource()===b("VideoPlayerLoggerSource").TAHOE,inFullscreen:this.$1.isFullscreen(),isGuideAuto:this.$1.getOption("VideoWithSphericalGuide","auto"),showGuideNux:b("SphericalVideoExperiments").showGuideNux,pitch:b("SphericalViewportControlStore").getOrientation(c).pitch,yaw:b("SphericalViewportControlStore").getOrientation(c).yaw,fov:b("SphericalViewportControlStore").getFieldOfView(c)});l&&this.$1.getOption("VideoWithSphericalGuide","auto")&&this.$14(this.$1.getOption("VideoWithSphericalGuide","intervalData"));this.$6=!0};d.$10=function(a){this.setState({isVisible:a})};d.$9=function(){this.setState({inFullscreen:this.$1.isFullscreen()})};d.$11=function(a){this.setState({inChannel:a})};d.$8=function(a){this.setState({inSnowlift:a})};d.$12=function(a){this.setState({inTahoe:a})};d.$13=function(a){this.setState({isActive:a})};d.$15=function(){this.setState({showGuideNux:!1}),b("BasicFBNux").onDismiss(j)};d.$14=function(a){var b,c;l?(c=a.deltaX===0&&a.deltaY===0,b=c?void 0:a.baseX+a.deltaX):(c=a.deltaPitch===0&&a.deltaYaw===0,b=c?void 0:a.baseYaw+a.deltaYaw);this.setState({poiYaw:b,isActive:!c})};d.render=function(){__p&&__p();var a=this;if(!this.$6)return null;var c=this.$1.getOption("SphericalVideoPlayer","getDimensions"),d=c.width;c=c.height;var e=!this.state.inChannel&&!this.state.inSnowlift&&!this.state.inFullscreen&&!this.state.inTahoe,f=this.$1.getOption("VideoWithSphericalGuide","enabled"),g;this.$5||(g=this.state.showGuideNux&&f);f={};var h=this.$1.getOption("SphericalVideoPlayer","getIsSingleFisheye");if(h){h=this.$1.getOption("SphericalVideoPlayer","getOriginalFOV");h!==null&&h!==0&&(f.partialLimits=i({partialLeftDegrees:h/2,partialRightDegrees:h/2,partialTopDegrees:0,partialBottomDegrees:0}))}h=this.$1.getOption("SphericalVideoPlayer","getIsHalfEquirectangular");h&&(f.partialLimits=i(b("SphericalVideoHalfEquirectConfig").getHalfEquirectangularPartialLimits()));return b("React").createElement("div",{className:"_3ldo"+(e?" _42a0":"")+(this.state.inTahoe?" _4l1h":"")+(this.state.inFullscreen?" _70uh":"")},b("React").createElement(n,babelHelpers["extends"]({ref:"compass",aspectRatio:d/c,initialYaw:this.props.initialYaw,isActive:this.state.isVisible,fov:this.state.fov,pitch:this.state.pitch,yaw:this.state.yaw,onClick:this.props.onClick,useLargeHeadingIndicator:this.state.inFullscreen,isPanning:this.state.isActive,isGuideAuto:this.state.isGuideAuto,pointerYaw:this.state.pointerYaw,poiYaw:this.state.poiYaw},f)),b("React").createElement(b("XUIAmbientNUX.react"),{contextRef:function(){return a.refs.compass},shown:g,position:"left",onCloseButtonClick:function(){return a.$15()}},this.$4))};return c}(b("React").Component);e.exports=a}),null);
__d("SpatialAudioFallbackReasons",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHANNEL:"channel",SCROLL:"scroll"})}),null);
__d("SphericalMediaPerformanceEvents",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SNAPSHOT:"snapshot",AUDIO_FALLBACK:"audio_fallback",SPATIAL_REACTIONS_CLUSTERS_COMPUTATION:"spatial_reactions_clusters_computation",SPATIAL_REACTIONS_CACHE_REBUILD:"spatial_reactions_cache_rebuild",SPHERICAL_RENDERER_SETUP:"spherical_renderer_setup"})}),null);
__d("SphericalMediaProductNames",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SPHERICAL_VIDEO:"spherical_video",SPATIAL_AUDIO:"spatial_audio",SPATIAL_REACTIONS:"spatial_reactions"})}),null);
__d("SphericalVideoPerformanceTracker",["MovingAverage","SpatialAudioFallbackReasons","SphericalMediaPerformanceEvents","SphericalMediaPerformanceTypedLogger","SphericalMediaProductNames","Visibility","performance"],(function(a,b,c,d,e,f){__p&&__p();var g=b("MovingAverage").MovingAverage;a=60;c=1e3;var h=10*c,i=15,j=c/a;d=function(){"use strict";__p&&__p();function a(){__p&&__p();var c=this;a.$1=!1;this.$10=new g(500,j);this.$11=new(b("SphericalMediaPerformanceTypedLogger"))();this.$12=!1;this.$7=-1;this.$8=-1;this.$5=!1;this.$6=!1;var d=function(){c.$4=!1,c.$16()},e=function(){c.$4=!0};b("Visibility").isHidden()?d():e();b("Visibility").addListener(b("Visibility").HIDDEN,d);b("Visibility").addListener(b("Visibility").VISIBLE,e)}a.get=function(){a.$2||(a.$2=new a());return a.$2};var c=a.prototype;c.addFrameAtTime=function(b){__p&&__p();if(!this.$4)return;if(b!==this.$9){a.$1=!0;this.$9=b;if(!this.$3)this.$3=b;else{var c=b-this.$3;this.$3=b;this.$10.add(c);this.$12||(this.$17(),this.$12=!0)}}};c.setProjection=function(a){this.$15=a;return this};c.trackSpatialAudioMetrics=function(){this.$5=!0,this.$14=0};c.isTrackingSpatialAudioMetrics=function(){return this.$5};c.addAudioStutter=function(){this.isTrackingSpatialAudioMetrics()||this.trackSpatialAudioMetrics(),this.$14++};c.enterSpatialAudioFallback=function(){this.isTrackingSpatialAudioMetrics()||this.trackSpatialAudioMetrics(),this.$7=b("performance").now()};c.exitSpatialAudioFallback=function(){this.isTrackingSpatialAudioMetrics()||this.trackSpatialAudioMetrics();if(this.$7>0){var a=Math.trunc(b("performance").now()-this.$7);this.$7=-1;this.$11.setProductName(b("SphericalMediaProductNames").SPATIAL_AUDIO).setEvent(b("SphericalMediaPerformanceEvents").AUDIO_FALLBACK).setFallbackDuration(a).setFallbackReason(b("SpatialAudioFallbackReasons").CHANNEL).log();this.$11.clear()}};c.trackSphericalRendererMetrics=function(){this.$6=!0};c.isTrackingSphericalRendererMetrics=function(){return this.$6};c.isOne360VideoActive=function(){return a.$1};c.enterSphericalRendererSetup=function(){this.isTrackingSphericalRendererMetrics()||this.trackSphericalRendererMetrics(),this.$8=b("performance").now()};c.exitSphericalRendererSetup=function(){this.isTrackingSphericalRendererMetrics()||this.trackSphericalRendererMetrics();if(this.$8>0){var a=Math.trunc(b("performance").now()-this.$8);this.$8=-1;this.$11.setProductName(b("SphericalMediaProductNames").SPHERICAL_VIDEO).setEvent(b("SphericalMediaPerformanceEvents").SPHERICAL_RENDERER_SETUP).setProjection(this.$15).setSphericalRendererSetupDuration(a).log();this.$11.clear()}};c.log=function(){__p&&__p();if(!this.isOne360VideoActive())return;else{var a=Math.trunc(this.$18()*Math.pow(10,i));this.$11.setProductName(b("SphericalMediaProductNames").SPHERICAL_VIDEO).setEvent(b("SphericalMediaPerformanceEvents").SNAPSHOT).setNormalizedFrameTime(a);this.$15&&this.$11.setProjection(this.$15);this.$5&&(this.$11.setProductName(b("SphericalMediaProductNames").SPATIAL_AUDIO).setNumSpatialAudioStutters(this.$14),this.$14=0);this.$11.log();this.$11.clear()}this.$16()};c.destroy=function(){clearInterval(this.$13),a.$2=null};c.$18=function(){return this.$10.getAvg()/j};c.$16=function(){this.$3=null,a.$1=!1};c.$17=function(){this.$13=setInterval(this.log.bind(this),h)};return a}();e.exports=d}),null);
__d("SphericalShader",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DEFAULT:"default",CUBE_MAP:"cube_map",CDS:"cds",CDS_FALLBACK:"cds_fallback",HALF_EQUIRECTANGULAR:"half_equirectangular"})}),null);
__d("CDSFallback.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n\n  uniform highp vec2 uOffset;\n  uniform sampler2D uSampler;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  void main()\n  {\n    if (vRecompute > 0.0) {\n      highp vec3 v = normalize( vPos );\n      highp float d = length( v.xz );\n      highp vec2 t = normalize(v.xz / d + uOffset) * d;\n      v = vec3(t.x, v.y, t.y);\n      highp vec2 o;\n      if ( abs(v.y) < 0.707106781 ) {\n        o = EquirectPart( v );\n      } else {\n        o = FacePart( v );\n      }\n      gl_FragColor = texture2D( uSampler, o );\n    } else {\n      gl_FragColor = texture2D( uSampler, vTextureCoord );\n    }\n  }\n"}),null);
__d("CDSFallback.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n\n  // It's actually inverse MV matrix\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  uniform highp vec2 uOffset;\n\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  const float eps = 0.03;\n\n  void main(void) {\n    gl_Position = uPMatrix * vec4(aVertexPosition, 1.0);\n    vPos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\n    highp vec3 v = normalize( vPos );\n    highp float d = length( v.xz );\n    highp vec2 t = normalize(v.xz / d + uOffset) * d;\n    v = vec3(t.x, v.y, t.y);\n    vRecompute = 0.0;\n    if ( abs(v.y) < 0.707106781 ) {\n      vTextureCoord = EquirectPart( v );\n      vRecompute += float( vTextureCoord.x < eps * 0.5 ||\n          vTextureCoord.x > 0.8 - eps * 0.5 );\n    } else {\n      vTextureCoord = FacePart( v );\n      vRecompute += float( abs(v.y) > 1.0 - eps );\n    }\n    vRecompute += float( abs(v.y) < 0.707106781 + eps &&\n        abs(v.y) > 0.707106781 - eps );\n  }\n"}),null);
__d("CDSRenderer.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n  varying highp vec2 vOffset;\n\n  uniform sampler2D uSampler;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  void main()\n  {\n    if (vRecompute > 0.0) {\n      highp vec3 v = normalize( vPos );\n      highp float d = length( v.xz );\n      highp vec2 t = normalize(v.xz / d + vOffset) * d;\n      v = vec3(t.x, v.y, t.y);\n      highp vec2 o;\n      if ( abs(v.y) < 0.707106781 ) {\n        o = EquirectPart( v );\n      } else {\n        o = FacePart( v );\n      }\n      gl_FragColor = texture2D( uSampler, o );\n    } else {\n      gl_FragColor = texture2D( uSampler, vTextureCoord );\n    }\n  }\n"}),null);
__d("CDSRenderer.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n\n  uniform sampler2D uSampler;\n  // It's actually inverse MV matrix\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vPos;\n  varying lowp float vRecompute;\n  varying highp vec2 vOffset;\n\n  highp vec2 EquirectPart( highp vec3 p )\n  {\n    highp float xz = sqrt( p.x * p.x + p.z * p.z );\n    highp float lat = -atan( p.y, xz );\n    highp float t = lat / 1.57079633 / 1.01 + 0.5;\n    highp float s = atan( p.x, -p.z ) / 1.01 / (2.5 * 3.1415927) + 0.4;\n    highp vec2 st = vec2(s, t);\n    return st;\n  }\n\n  highp vec2 FacePart( highp vec3 p )\n  {\n      highp vec2 t = p.xz / p.y;\n      highp float s = sign(p.y);\n      return vec2(0.9 + t.x * s * 0.099009901,\n          0.5 - s * 0.25 - t.y * 0.247524752);\n  }\n\n  highp vec4 extractFromSample(highp vec4 c)\n  {\n    highp float minC = min(0.5, min(c.r, min(c.g, c.b)));\n    highp float diffC = max(0.5, max(c.r, max(c.g, c.b))) - minC + 0.001;\n    return step(0.5, (c - minC) / diffC);\n  }\n\n  highp vec2 parseOffset()\n  {\n    highp float calculated_offsetX, calculated_offsetZ;\n    highp float offset_v, offset_e, offset_sig; // temp variables\n    highp vec4 texCoordsX[7], texCoordsZ[7]; // constants\n\n    texCoordsX[0] = extractFromSample(texture2D(uSampler, vec2(0.396, 1.0)));\n    texCoordsX[1] = extractFromSample(texture2D(uSampler, vec2(0.404, 1.0)));\n    texCoordsX[2] = extractFromSample(texture2D(uSampler, vec2(0.412, 1.0)));\n    texCoordsX[3] = extractFromSample(texture2D(uSampler, vec2(0.420, 1.0)));\n    texCoordsX[4] = extractFromSample(texture2D(uSampler, vec2(0.428, 1.0)));\n    texCoordsX[5] = extractFromSample(texture2D(uSampler, vec2(0.436, 1.0)));\n    texCoordsX[6] = extractFromSample(texture2D(uSampler, vec2(0.444, 1.0)));\n\n    offset_v = texCoordsX[0].r * 0.0009765625\n      + dot(texCoordsX[1].bgr, vec3(0.001953125, 0.00390625, 0.0078125))\n      + dot(texCoordsX[2].bgr, vec3(0.015625, 0.03125, 0.0625))\n      + dot(texCoordsX[3].bgr, vec3(0.125, 0.25, 0.5))\n      + 1.0;\n\n    offset_e = dot(texCoordsX[4].bgr, vec3(1.0, 2.0, 4.0))\n      + dot(texCoordsX[5].bgr, vec3(8.0, 16.0, 32.0))\n      + dot(texCoordsX[6].bg, vec2(64.0, 128.0))\n      - 127.0;\n\n    offset_sig = -2.0 * texCoordsX[6].r + 1.0;\n    calculated_offsetX = offset_sig * offset_v * pow(2.0, offset_e);\n\n\n    texCoordsZ[0] = extractFromSample(texture2D(uSampler, vec2(0.572, 1.0)));\n    texCoordsZ[1] = extractFromSample(texture2D(uSampler, vec2(0.580, 1.0)));\n    texCoordsZ[2] = extractFromSample(texture2D(uSampler, vec2(0.588, 1.0)));\n    texCoordsZ[3] = extractFromSample(texture2D(uSampler, vec2(0.596, 1.0)));\n    texCoordsZ[4] = extractFromSample(texture2D(uSampler, vec2(0.604, 1.0)));\n    texCoordsZ[5] = extractFromSample(texture2D(uSampler, vec2(0.612, 1.0)));\n    texCoordsZ[6] = extractFromSample(texture2D(uSampler, vec2(0.620, 1.0)));\n\n    offset_v = dot(texCoordsZ[0].bgr, vec3(0.0009765625, 0.001953125, 0.00390625))\n      + dot(texCoordsZ[1].bgr, vec3(0.0078125, 0.015625, 0.03125))\n      + dot(texCoordsZ[2].bgr, vec3(0.0625, 0.125, 0.25))\n      + texCoordsZ[3].b * 0.5\n      + 1.0;\n\n    offset_e = dot(texCoordsZ[3].gr, vec2(1.0, 2.0))\n      + dot(texCoordsZ[4].bgr, vec3(4.0, 8.0, 16.0))\n      + dot(texCoordsZ[5].bgr, vec3(32.0, 64.0, 128.0))\n      - 127.0;\n\n    offset_sig = 2.0 * texCoordsZ[6].b - 1.0;\n    calculated_offsetZ = offset_sig * offset_v * pow(2.0, offset_e);\n\n    return vec2(calculated_offsetX, calculated_offsetZ);\n  }\n\n  const float eps = 0.03;\n\n  void main(void) {\n    gl_Position = uPMatrix * vec4(aVertexPosition, 1.0);\n    vPos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\n    highp vec3 v = normalize( vPos );\n    vOffset = parseOffset();\n    highp float d = length( v.xz );\n    highp vec2 t = normalize(v.xz / d + vOffset) * d;\n    v.xz = t.xy;\n    vRecompute = 0.0;\n    highp float abs_vy = abs(v.y);\n    if ( abs_vy < 0.707106781 ) {\n      vTextureCoord = EquirectPart( v );\n      vRecompute += float( vTextureCoord.x < eps * 0.5 ||\n          vTextureCoord.x > 0.8 - eps * 0.5 );\n    } else {\n      vTextureCoord = FacePart( v );\n      vRecompute += float( abs_vy > 1.0 - eps );\n    }\n    vRecompute += float( abs_vy < 0.707106781 + eps &&\n        abs_vy > 0.707106781 - eps );\n  }\n"}),null);
__d("DefaultRenderer.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec2 vTextureCoord;\n\n  uniform sampler2D uSampler;\n\n  void main(void) {\n    gl_FragColor = texture2D(\n      uSampler,\n      vec2(vTextureCoord.s, vTextureCoord.t)\n    );\n  }\n"}),null);
__d("DefaultRenderer.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n\n  varying highp vec2 vTextureCoord;\n\n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n  }\n"}),null);
__d("HalfEquirect.fs",[],(function(a,b,c,d,e,f){e.exports="\n  // If changed, copy this constant to the vertex shader\n  #define FEATHER_RATIO 0.0278  // 10 / 360 degrees\n\n  uniform highp mat4 uSTMatrix;\n  uniform mediump vec2 uBoundaries;\n  uniform sampler2D uSampler;\n\n  varying highp vec2 vTextureCoord;\n  varying mediump vec4 vLeftBoundaryColor;\n  varying mediump vec4 vRightBoundaryColor;\n\n  mediump float leftBoundary;\n  mediump float rightBoundary;\n  mediump float processedX;\n\n  mediump vec4 getTextureColor() {\n    return texture2D(uSampler, (uSTMatrix * vec4(vTextureCoord, 0, 1)).xy);\n  }\n\n  mediump float getWrappedValue(mediump float value) {\n    return value + (value < leftBoundary ? 1.0 : 0.0);\n  }\n\n  mediump vec4 interpolate() {\n    mediump float interp = (processedX - rightBoundary) / (1.0 + leftBoundary - rightBoundary);\n    return mix(vRightBoundaryColor, vLeftBoundaryColor, interp);\n  }\n\n  mediump vec4 getFeatheredPixel() {\n    bool useLeftBoundary = processedX <= leftBoundary + FEATHER_RATIO;\n    mediump vec4 currColor = getTextureColor();\n    mediump vec4 boundaryColor = useLeftBoundary ? vLeftBoundaryColor : vRightBoundaryColor;\n    mediump float interp =\n      (useLeftBoundary ? (processedX - leftBoundary) : (rightBoundary - processedX))\n      / FEATHER_RATIO;\n    return mix(boundaryColor, currColor, interp);\n  }\n\n  void main(void) {\n    leftBoundary = uBoundaries.x;\n    rightBoundary = getWrappedValue(uBoundaries.y);\n\n    processedX = getWrappedValue(vTextureCoord.x);\n    bool mainImageBetweenFeatheredBounds =\n      (processedX > leftBoundary + FEATHER_RATIO)\n      && (processedX < rightBoundary - FEATHER_RATIO);\n\n    if (mainImageBetweenFeatheredBounds) {\n      gl_FragColor = getTextureColor();\n    } else if (processedX < leftBoundary || processedX > rightBoundary) {\n      gl_FragColor = interpolate();\n    } else {\n      gl_FragColor = getFeatheredPixel();\n    }\n  }\n"}),null);
__d("HalfEquirect.vs",[],(function(a,b,c,d,e,f){e.exports="\n  #define HALF_WINDOW_SIZE 20\n  #define WINDOW_SIZE 2*HALF_WINDOW_SIZE\n  #define TRIANGLE_WIDTH 0.04  // 1 / 30 triangles\n  #define INV_HEIGHT 0.005\n  #define BLUR_LENGTH float(HALF_WINDOW_SIZE)*INV_HEIGHT\n\n  // If changed, copy this definition to the fragment shader\n  #define FEATHER_RATIO 0.0278  // 10 / 360 degrees\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  uniform mat4 uSTMatrix;\n  uniform mediump vec2 uBoundaries;\n  uniform sampler2D uSampler;\n\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n\n  varying highp vec2 vTextureCoord;\n  varying mediump vec4 vLeftBoundaryColor;\n  varying mediump vec4 vRightBoundaryColor;\n\n  mediump float leftBoundary;\n  mediump float rightBoundary;\n\n  mediump float getUnWrappedValue(mediump float value) {\n    return value - (value > 1.0 ? 1.0 : 0.0);\n  }\n\n  mediump vec4 getVerticalBlurredBoundaryPixel(mediump float y, bool isLeft) {\n    mediump vec4 result = vec4(0.0);\n    mediump float boundaryFactor = FEATHER_RATIO * 0.5;\n    mediump float coordJEnd = clamp(y + BLUR_LENGTH, 0.0, 1.0);\n    mediump float coordJ = clamp(y - BLUR_LENGTH, 0.0, 1.0);\n    int numSamples = 0;\n\n    for (int j = 0; j <= WINDOW_SIZE; j++) {\n      if (coordJ > coordJEnd) {\n        break;\n      }\n      mediump float coordI = isLeft ? leftBoundary : rightBoundary;\n\n      // get boundary pixel color\n      result += texture2D(uSampler, (uSTMatrix * vec4(getUnWrappedValue(coordI), coordJ, 0, 1)).xy);\n\n      // get one more horizontal sample to average out any noise\n      coordI += boundaryFactor * (isLeft ? 1.0 : -1.0);\n      result += texture2D(uSampler, (uSTMatrix * vec4(getUnWrappedValue(coordI), coordJ, 0, 1)).xy);\n\n      numSamples += 2;\n      coordJ += INV_HEIGHT;\n    }\n\n    result.rgb /= float(numSamples);\n    result.a = 1.0;\n    return result;\n  }\n\n  mediump float getWrappedValue(mediump float value) {\n    return value + (value < leftBoundary ? 1.0 : 0.0);\n  }\n\n  void maybeSetBoundaryColors() {\n    mediump float processedX = getWrappedValue(vTextureCoord.x);\n    bool mainImageBetweenFeatheredBounds =\n      processedX > (leftBoundary + FEATHER_RATIO + TRIANGLE_WIDTH)\n      && processedX < (rightBoundary - FEATHER_RATIO - TRIANGLE_WIDTH);\n    if (mainImageBetweenFeatheredBounds) {\n      return;\n    }\n    vLeftBoundaryColor = getVerticalBlurredBoundaryPixel(vTextureCoord.y, true);\n    vRightBoundaryColor = getVerticalBlurredBoundaryPixel(vTextureCoord.y, false);\n  }\n\n  void main(void) {\n    leftBoundary = uBoundaries.x;\n    rightBoundary = getWrappedValue(uBoundaries.y);\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    maybeSetBoundaryColors();\n  }\n"}),null);
__d("TextureCubeMap.fs",[],(function(a,b,c,d,e,f){e.exports="\n  varying highp vec3 vVertexDirectionVector;\n  uniform samplerCube uSampler;\n\n  void main(void) {\n    gl_FragColor = textureCube(uSampler, vVertexDirectionVector);\n  }\n"}),null);
__d("TextureCubeMap.vs",[],(function(a,b,c,d,e,f){e.exports="\n  attribute vec3 aVertexPosition;\n\n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n\n  varying highp vec3 vVertexDirectionVector;\n\n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vVertexDirectionVector = aVertexPosition;\n  }\n"}),null);
__d("SphericalShaderUtils",["CDSFallback.fs","CDSFallback.vs","CDSRenderer.fs","CDSRenderer.vs","DefaultRenderer.fs","DefaultRenderer.vs","HalfEquirect.fs","HalfEquirect.vs","SphericalShader","TextureCubeMap.fs","TextureCubeMap.vs"],(function(a,b,c,d,e,f){__p&&__p();a={getVertexShader:function(a){switch(a){case b("SphericalShader").CUBE_MAP:return b("TextureCubeMap.vs");case b("SphericalShader").CDS:return b("CDSRenderer.vs");case b("SphericalShader").CDS_FALLBACK:return b("CDSFallback.vs");case b("SphericalShader").HALF_EQUIRECTANGULAR:return b("HalfEquirect.vs");default:return b("DefaultRenderer.vs")}},getFragmentShader:function(a){switch(a){case b("SphericalShader").CUBE_MAP:return b("TextureCubeMap.fs");case b("SphericalShader").CDS:return b("CDSRenderer.fs");case b("SphericalShader").CDS_FALLBACK:return b("CDSFallback.fs");case b("SphericalShader").HALF_EQUIRECTANGULAR:return b("HalfEquirect.fs");default:return b("DefaultRenderer.fs")}}};e.exports=a}),null);
__d("SphericalRenderer",["DOM","EventEmitter","EventListener","SphericalShader","SphericalShaderUtils","VideoProjection","VideoStereoFormat","gl-matrix"],(function(a,b,c,d,e,f){__p&&__p();var g=b("gl-matrix").glMatrix,h=b("gl-matrix").mat4,i=Math.max(window.devicePixelRatio||1,1),j=.25,k=.75,l=function(){"use strict"};c=function(c){"use strict";__p&&__p();babelHelpers.inheritsLoose(d,c);function d(a,d,e){__p&&__p();var f;f=c.call(this)||this;f.$SphericalRenderer2=e;f.$SphericalRenderer23=e.fieldOfView;f.$SphericalRenderer18=!0;f.$SphericalRenderer17=a;f.$SphericalRenderer1=d;f.$SphericalRenderer11=h.create();f.$SphericalRenderer12=h.create();f.$SphericalRenderer13=h.create();f.$SphericalRenderer14=h.create();f.$SphericalRenderer3=!1;f.$SphericalRenderer20=[];f.$SphericalRenderer22=null;f.$SphericalRenderer21=null;f.$SphericalRenderer19=e.projectionType===b("VideoProjection").UNPADDED_CUBESTRIP;f.$SphericalRenderer9=e.projectionType===b("VideoProjection").ROTATED_CUBEMAP;f.$SphericalRenderer7=e.projectionType===b("VideoProjection").CDS_BARREL;f.$SphericalRenderer8=!1;f.$SphericalRenderer10=e.projectionType===b("VideoProjection").HALF_EQUIRECTANGULAR;f.$SphericalRenderer25=new l();f.$SphericalRenderer25.ready=!1;f.$SphericalRenderer26=!1;f.$SphericalRenderer4=f.$SphericalRenderer27.bind(babelHelpers.assertThisInitialized(f));f.$SphericalRenderer5=f.$SphericalRenderer28.bind(babelHelpers.assertThisInitialized(f));f.$SphericalRenderer1.addEventListener("webglcontextlost",f.$SphericalRenderer4);f.$SphericalRenderer1.addEventListener("webglcontextrestored",f.$SphericalRenderer5);f.$SphericalRenderer29();return f}var e=d.prototype;e.destroy=function(){this.removeAllListeners(),this.$SphericalRenderer1.removeEventListener("webglcontextlost",this.$SphericalRenderer4),this.$SphericalRenderer1.removeEventListener("webglcontextrestored",this.$SphericalRenderer5)};e.reconfigure=function(a,c,d){d===void 0&&(d=!1),d&&(this.$SphericalRenderer20=[],this.$SphericalRenderer22=null,this.$SphericalRenderer21=null),this.$SphericalRenderer23=c.fieldOfView,this.$SphericalRenderer17=a,this.$SphericalRenderer2=c,this.$SphericalRenderer19=c.projectionType===b("VideoProjection").UNPADDED_CUBESTRIP,this.$SphericalRenderer9=c.projectionType===b("VideoProjection").ROTATED_CUBEMAP,this.$SphericalRenderer7=c.projectionType===b("VideoProjection").CDS_BARREL,this.$SphericalRenderer10=c.projectionType===b("VideoProjection").HALF_EQUIRECTANGULAR,this.$SphericalRenderer25.framebuffer=null,this.$SphericalRenderer26=!1,this.$SphericalRenderer29()};e.hasRenderingContext=function(){return!this.$SphericalRenderer3};e.$SphericalRenderer27=function(a){a.preventDefault(),this.emit("renderingContextLost"),this.$SphericalRenderer3=!0};e.$SphericalRenderer28=function(a){this.$SphericalRenderer3=!1,this.$SphericalRenderer29(),this.emit("renderingContextRestore")};e.setAutoUpdateTexture=function(a){this.$SphericalRenderer18=a};e.updateFieldOfView=function(a){this.$SphericalRenderer23!==a&&(this.$SphericalRenderer23=a,this.$SphericalRenderer30())};e.updateViewportDimensions=function(a,b){this.$SphericalRenderer1.width=a*i,this.$SphericalRenderer1.height=b*i,this.$SphericalRenderer30()};e.$SphericalRenderer30=function(){h.perspective(this.$SphericalRenderer11,g.toRadian(this.$SphericalRenderer23),this.$SphericalRenderer1.width/this.$SphericalRenderer1.height,.1,100),this.$SphericalRenderer6.viewport(0,0,this.$SphericalRenderer6.drawingBufferWidth,this.$SphericalRenderer6.drawingBufferHeight)};e.$SphericalRenderer31=function(){this.$SphericalRenderer14=h.create(),this.$SphericalRenderer10&&(this.$SphericalRenderer14[0]=1/this.$SphericalRenderer24.x/(k-j),this.$SphericalRenderer14[5]=1/this.$SphericalRenderer24.y,this.$SphericalRenderer14[12]=-(this.$SphericalRenderer14[0]*j),this.$SphericalRenderer24={x:1,y:1})};e.$SphericalRenderer29=function(){__p&&__p();this.$SphericalRenderer32();if(this.$SphericalRenderer7){var a=this.$SphericalRenderer6.getParameter(this.$SphericalRenderer6.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.$SphericalRenderer8=a==0}this.updateViewportDimensions(this.$SphericalRenderer1.clientWidth,this.$SphericalRenderer1.clientHeight);this.$SphericalRenderer24={x:this.$SphericalRenderer2.stereoFormat===b("VideoStereoFormat").LEFT_RIGHT?2:1,y:this.$SphericalRenderer2.stereoFormat===b("VideoStereoFormat").TOP_BOTTOM?2:1};this.$SphericalRenderer31();this.$SphericalRenderer33();this.$SphericalRenderer34();this.$SphericalRenderer6.clearColor(0,0,0,1);this.$SphericalRenderer17.setAttribute("crossorigin","anonymous")};e.getScreenshotDataURL=function(a,b,c,d){if(!this.$SphericalRenderer6||this.$SphericalRenderer3)return"";this.render(a,b);return this.$SphericalRenderer1.toDataURL(c,d)};e.$SphericalRenderer32=function(){__p&&__p();if(this.$SphericalRenderer6&&!this.$SphericalRenderer3)return;if(!(a.WebGLRenderingContext||a.WebGL2RenderingContext))throw new Error("WebGLRenderingContext not available.");var c=["webgl2","webgl","experimental-webgl"],d=null,e=null,f=b("EventListener").listen(this.$SphericalRenderer1,"webglcontextcreationerror",function(a){return e=a.statusMessage});for(var g=0;g<c.length;g++){try{d=this.$SphericalRenderer1.getContext(c[g])}catch(a){}if(d)break}f.remove();if(!d){e||(e="Unknown error.");throw new Error("Failed to acquire 3D rendering context: "+e)}this.$SphericalRenderer6=d;this.$SphericalRenderer3=!1};e.$SphericalRenderer33=function(){var a=this.$SphericalRenderer7?this.$SphericalRenderer8?b("SphericalShader").CDS_FALLBACK:b("SphericalShader").CDS:this.$SphericalRenderer19?b("SphericalShader").CUBE_MAP:this.$SphericalRenderer10?b("SphericalShader").HALF_EQUIRECTANGULAR:b("SphericalShader").DEFAULT,c=this.$SphericalRenderer35(a);a=this.$SphericalRenderer36(a);this.$SphericalRenderer16=this.$SphericalRenderer6.createProgram();this.$SphericalRenderer6.attachShader(this.$SphericalRenderer16,c);this.$SphericalRenderer6.attachShader(this.$SphericalRenderer16,a);this.$SphericalRenderer6.linkProgram(this.$SphericalRenderer16)};e.$SphericalRenderer37=function(){__p&&__p();if(!this.$SphericalRenderer6.getProgramParameter(this.$SphericalRenderer16,this.$SphericalRenderer6.LINK_STATUS)){var a="",b=this.$SphericalRenderer6.getAttachedShaders(this.$SphericalRenderer16);for(var c=0;c<b.length;c++)if(!this.$SphericalRenderer6.getShaderParameter(b[c],this.$SphericalRenderer6.COMPILE_STATUS)){a="Shader error: "+this.$SphericalRenderer6.getShaderInfoLog(b[c]);break}a===""&&(a="Program link error: "+this.$SphericalRenderer6.getProgramInfoLog(this.$SphericalRenderer16));throw new Error(a)}this.$SphericalRenderer6.useProgram(this.$SphericalRenderer16);this.$SphericalRenderer16.vertexPositionAttribute=this.$SphericalRenderer6.getAttribLocation(this.$SphericalRenderer16,"aVertexPosition");this.$SphericalRenderer6.enableVertexAttribArray(this.$SphericalRenderer16.vertexPositionAttribute);this.$SphericalRenderer16.pMatrixUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uPMatrix");this.$SphericalRenderer16.mvMatrixUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uMVMatrix");this.$SphericalRenderer16.stMatrixUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uSTMatrix");this.$SphericalRenderer16.samplerUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uSampler");!this.$SphericalRenderer19&&!this.$SphericalRenderer7&&(this.$SphericalRenderer16.textureCoordAttribute=this.$SphericalRenderer6.getAttribLocation(this.$SphericalRenderer16,"aTextureCoord"),this.$SphericalRenderer6.enableVertexAttribArray(this.$SphericalRenderer16.textureCoordAttribute));this.$SphericalRenderer8&&(this.$SphericalRenderer16.offsetUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uOffset"));this.$SphericalRenderer10&&(this.$SphericalRenderer16.boundariesUniform=this.$SphericalRenderer6.getUniformLocation(this.$SphericalRenderer16,"uBoundaries"));this.$SphericalRenderer26=!0};e.$SphericalRenderer34=function(){this.$SphericalRenderer15=this.$SphericalRenderer6.createTexture();this.$SphericalRenderer15.image=this.$SphericalRenderer17;var a=this.$SphericalRenderer19?this.$SphericalRenderer6.TEXTURE_CUBE_MAP:this.$SphericalRenderer6.TEXTURE_2D;this.$SphericalRenderer6.bindTexture(a,this.$SphericalRenderer15);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_MAG_FILTER,this.$SphericalRenderer6.LINEAR);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_MIN_FILTER,this.$SphericalRenderer6.LINEAR);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_WRAP_S,this.$SphericalRenderer6.CLAMP_TO_EDGE);this.$SphericalRenderer6.texParameteri(a,this.$SphericalRenderer6.TEXTURE_WRAP_T,this.$SphericalRenderer6.CLAMP_TO_EDGE)};e.$SphericalRenderer38=function(a,b,c,d,e,f){__p&&__p();b===void 0&&(b=30);c===void 0&&(c=30);d===void 0&&(d=Math.PI);e===void 0&&(e=Math.PI*2);f===void 0&&(f=0);var g=2,h=[],i=[],j,k;for(j=0;j<=b;j++){var l=(j/b-.5)*d,m=Math.sin(l);l=Math.cos(l);for(k=0;k<=c;k++){var n=(k/c-.5)*e+f,o=Math.sin(n);n=Math.cos(n);n=n*l;var p=m;o=o*l;var q=k/c/this.$SphericalRenderer24.x,r=j/b/this.$SphericalRenderer24.y;i.push(q);i.push(r);h.push(g*n);h.push(g*p);h.push(g*o)}}q=[];for(j=0;j<b;j++)for(k=0;k<c;k++){r=j*(c+1)+k;n=r+c+1;q.push(r);q.push(n);q.push(r+1);q.push(n);q.push(n+1);q.push(r+1)}this.$SphericalRenderer20[a]=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[a]);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(i),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer20[a].itemSize=2;this.$SphericalRenderer20[a].numItems=i.length/2;this.$SphericalRenderer22=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(h),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer22&&(this.$SphericalRenderer22.itemSize=3,this.$SphericalRenderer22.numItems=h.length/3);this.$SphericalRenderer21=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,new Uint16Array(q),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer21&&(this.$SphericalRenderer21.itemSize=1,this.$SphericalRenderer21.numItems=q.length)};e.$SphericalRenderer39=function(a,b){__p&&__p();var c=40,d=60,e=2,f=[],g=[],h=[],i=[],j,k;for(j=0;j<=c;j++){var l=j/c-.5,m=l*.5*Math.PI,n=Math.sin(m);m=Math.cos(m);var o=(l/a+.5)/this.$SphericalRenderer24.y;for(k=0;k<=d;k++){var p=k/d-.5,q=p*2*Math.PI,r=Math.sin(q);q=Math.cos(q);var s=q*m*e,t=n*e,u=r*m*e;p=(p/a*.8+.4)/this.$SphericalRenderer24.x;g.push(p);g.push(o);f.push(s);f.push(t);f.push(u);if(j==0||j==c){p=Math.sign(1-j);r=(r*.1/a+.9)/this.$SphericalRenderer24.x;q=(q*.25*p/a+.5+l*.5)/this.$SphericalRenderer24.y;i.push(r);i.push(q);h.push(s);h.push(t);h.push(u)}}}p=f.length/3;g.push.apply(g,i);f.push.apply(f,h);r=f.length/3;q=Math.sin(Math.PI*.25)*e;g.push(.9/this.$SphericalRenderer24.x);g.push(.25/this.$SphericalRenderer24.y);f.push(0);f.push(-q);f.push(0);g.push(.9/this.$SphericalRenderer24.x);g.push(.75/this.$SphericalRenderer24.y);f.push(0);f.push(q);f.push(0);s=[];for(j=0;j<c;j++)for(k=0;k<d;k++){t=j*(d+1)+k;u=t+d+1;s.push(t);s.push(u);s.push(t+1);s.push(u);s.push(u+1);s.push(t+1)}for(var m=0;m<2;m++)for(k=0;k<d;k++)s.push(k+p+m*(d+1)),s.push(k+p+m*(d+1)+1),s.push(r+m);this.$SphericalRenderer20[b]=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[b]);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(g),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer20[b].itemSize=2;this.$SphericalRenderer20[b].numItems=g.length/2;this.$SphericalRenderer22=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(f),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer22&&(this.$SphericalRenderer22.itemSize=3,this.$SphericalRenderer22.numItems=f.length/3);this.$SphericalRenderer21=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer21&&(this.$SphericalRenderer21.itemSize=1,this.$SphericalRenderer21.numItems=s.length)};e.$SphericalRenderer40=function(a,b,c){__p&&__p();this.$SphericalRenderer9?a=[1,3,7,5,6,7,3,2,0,2,3,1,4,5,7,6,4,6,2,0,0,1,5,4]:a=[5,1,3,7,0,4,6,2,6,7,3,2,0,1,5,4,4,5,7,6,1,0,2,3];var d=[];for(var e=0;e<a.length;e++){var f=a[e]>>2&1,g=a[e]>>1&1,h=a[e]>>0&1;d.push(f*2-1);d.push(g*2-1);d.push(h*2-1)}this.$SphericalRenderer22=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(d),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer22&&(this.$SphericalRenderer22.itemSize=3,this.$SphericalRenderer22.numItems=d.length/3);if(!this.$SphericalRenderer19){var i;f=[];if(this.$SphericalRenderer9){g=this.$SphericalRenderer15.image.videoWidth/2;b=g/(Math.floor(g/32)*32);h=(1-1/b)/2;e=3;d=2;g=1/d;i=1/e}else h=(1-1/b)/2,e=2,d=3,g=1/d,i=1/e;for(var b=0;b<e;++b)for(var j=0;j<d;++j){var k=e-1-b,l=j;f.push((l+h)*g);f.push((k+h)*i);f.push((l+1-h)*g);f.push((k+h)*i);f.push((l+1-h)*g);f.push((k+1-h)*i);f.push((l+h)*g);f.push((k+1-h)*i)}this.$SphericalRenderer20[c]=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[c]);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ARRAY_BUFFER,new Float32Array(f),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer20[c].itemSize=2;this.$SphericalRenderer20[c].numItems=f.length/2}l=[];for(var k=0;k<a.length;k+=4)l.push(k),l.push(k+2),l.push(k+1),l.push(k),l.push(k+3),l.push(k+2);this.$SphericalRenderer21=this.$SphericalRenderer6.createBuffer();this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.bufferData(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,new Uint16Array(l),this.$SphericalRenderer6.STATIC_DRAW);this.$SphericalRenderer21&&(this.$SphericalRenderer21.itemSize=1,this.$SphericalRenderer21.numItems=l.length)};e.$SphericalRenderer35=function(a){var c=this.$SphericalRenderer6.createShader(this.$SphericalRenderer6.VERTEX_SHADER);a=b("SphericalShaderUtils").getVertexShader(a);this.$SphericalRenderer6.shaderSource(c,a);this.$SphericalRenderer6.compileShader(c);return c};e.$SphericalRenderer36=function(a){var c=this.$SphericalRenderer6.createShader(this.$SphericalRenderer6.FRAGMENT_SHADER);a=b("SphericalShaderUtils").getFragmentShader(a);this.$SphericalRenderer6.shaderSource(c,a);this.$SphericalRenderer6.compileShader(c);return c};e.$SphericalRenderer41=function(){this.$SphericalRenderer25.framebuffer=this.$SphericalRenderer6.createFramebuffer(),this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,this.$SphericalRenderer25.framebuffer),this.$SphericalRenderer6.framebufferTexture2D(this.$SphericalRenderer6.FRAMEBUFFER,this.$SphericalRenderer6.COLOR_ATTACHMENT0,this.$SphericalRenderer6.TEXTURE_2D,this.$SphericalRenderer15,0),this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,null)};e.$SphericalRenderer42=function(){this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,this.$SphericalRenderer25.framebuffer),this.$SphericalRenderer6.readPixels(0,this.$SphericalRenderer15.image.videoHeight-1,this.$SphericalRenderer15.image.videoWidth,1,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.UNSIGNED_BYTE,this.$SphericalRenderer25.pixels),this.$SphericalRenderer6.bindFramebuffer(this.$SphericalRenderer6.FRAMEBUFFER,null)};e.$SphericalRenderer43=function(){__p&&__p();this.$SphericalRenderer25.bitmask.fill(0);var a=[0,0,0],b=this.$SphericalRenderer15.image.videoWidth/125,c=Math.round(b),d;for(d=0;d<33;++d){var e=Math.floor((45+d)*b)*4,f=128,g=127;for(var h=0;h<3;++h){a[h]=0;for(var i=0;i<c;++i)a[h]+=this.$SphericalRenderer25.pixels[e+i*4+(2-h)];a[h]/=c;f=Math.max(f,a[h]);g=Math.min(g,a[h])}for(h=0;h<3;++h){i=(a[h]-g)/(f-g);this.$SphericalRenderer25.bitmask[d*3+h]=i>.5?1:0}}for(d=0;d<12;++d){e=0;for(var i=0;i<8;++i)e+=this.$SphericalRenderer25.bitmask[1+d*8+i]*Math.pow(2,i);this.$SphericalRenderer25.dataView.setUint8(d,e)}this.$SphericalRenderer25.offsetX=this.$SphericalRenderer25.dataView.getFloat32(0,!0);this.$SphericalRenderer25.offsetZ=-this.$SphericalRenderer25.dataView.getFloat32(8,!0)};e.$SphericalRenderer44=function(){try{this.$SphericalRenderer25.ready||(this.$SphericalRenderer25.pixels=new Uint8Array(3840*4),this.$SphericalRenderer25.bitmask=new Uint8Array(33*3),this.$SphericalRenderer25.dataView=new DataView(new ArrayBuffer(12)),this.$SphericalRenderer25.ready=!0),this.$SphericalRenderer25.framebuffer||this.$SphericalRenderer41(),this.$SphericalRenderer42(),this.$SphericalRenderer43()}catch(a){this.emit("renderingError",a)}};e.$SphericalRenderer45=function(){if(this.$SphericalRenderer19)this.$SphericalRenderer46();else{this.$SphericalRenderer6.bindTexture(this.$SphericalRenderer6.TEXTURE_2D,this.$SphericalRenderer15);this.$SphericalRenderer6.pixelStorei(this.$SphericalRenderer6.UNPACK_FLIP_Y_WEBGL,!this.$SphericalRenderer7);try{this.$SphericalRenderer6.texImage2D(this.$SphericalRenderer6.TEXTURE_2D,0,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.UNSIGNED_BYTE,this.$SphericalRenderer15.image)}catch(a){this.emit("renderingError",a)}this.$SphericalRenderer8&&this.$SphericalRenderer44()}};e.renderWithRotationMatrix=function(a){if(this.$SphericalRenderer3)return;this.$SphericalRenderer18&&this.$SphericalRenderer45();this.$SphericalRenderer12=a;this.$SphericalRenderer7&&h.rotateY(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(-90));this.$SphericalRenderer47()};e.render=function(a,b){if(this.$SphericalRenderer3)return;this.$SphericalRenderer18&&this.$SphericalRenderer45();this.$SphericalRenderer9?(h.identity(this.$SphericalRenderer12),h.rotateX(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(-b)),h.rotateY(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(a-135)),h.rotateZ(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(45))):(this.$SphericalRenderer7&&(a-=90),h.identity(this.$SphericalRenderer12),h.rotateX(this.$SphericalRenderer12,this.$SphericalRenderer12,-g.toRadian(b)),h.rotateY(this.$SphericalRenderer12,this.$SphericalRenderer12,g.toRadian(a)));this.$SphericalRenderer47()};e.$SphericalRenderer47=function(){__p&&__p();if(this.$SphericalRenderer19)this.$SphericalRenderer22===null&&this.$SphericalRenderer40(this.$SphericalRenderer2.projectionType,this.$SphericalRenderer2.expansionCoef||0,0);else{this.$SphericalRenderer26||(this.$SphericalRenderer37(),this.$SphericalRenderer6.activeTexture(this.$SphericalRenderer6.TEXTURE0));var a=this.$SphericalRenderer15.image.videoWidth;this.$SphericalRenderer2.projectionType===b("VideoProjection").CUBEMAP||this.$SphericalRenderer2.projectionType===b("VideoProjection").ROTATED_CUBEMAP?a in this.$SphericalRenderer20||this.$SphericalRenderer40(this.$SphericalRenderer2.projectionType,this.$SphericalRenderer2.expansionCoef||0,a):this.$SphericalRenderer2.projectionType===b("VideoProjection").BARREL?a in this.$SphericalRenderer20||this.$SphericalRenderer39(this.$SphericalRenderer2.expansionCoef||1.01,a):this.$SphericalRenderer7?a in this.$SphericalRenderer20||this.$SphericalRenderer38(a,40,40,Math.PI/180*111,Math.PI/180*142,-Math.PI/2):a in this.$SphericalRenderer20||this.$SphericalRenderer38(a);this.$SphericalRenderer7||(this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer20[a]),this.$SphericalRenderer6.vertexAttribPointer(this.$SphericalRenderer16.textureCoordAttribute,this.$SphericalRenderer20[a].itemSize,this.$SphericalRenderer6.FLOAT,!1,0,0))}this.$SphericalRenderer6.uniform1i(this.$SphericalRenderer16.samplerUniform,0);this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ARRAY_BUFFER,this.$SphericalRenderer22);this.$SphericalRenderer22&&this.$SphericalRenderer6.vertexAttribPointer(this.$SphericalRenderer16.vertexPositionAttribute,this.$SphericalRenderer22.itemSize,this.$SphericalRenderer6.FLOAT,!1,0,0);this.$SphericalRenderer6.bindBuffer(this.$SphericalRenderer6.ELEMENT_ARRAY_BUFFER,this.$SphericalRenderer21);this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.pMatrixUniform,!1,this.$SphericalRenderer11);this.$SphericalRenderer10&&this.$SphericalRenderer6.uniform2f(this.$SphericalRenderer16.boundariesUniform,j,k);this.$SphericalRenderer7?(h.invert(this.$SphericalRenderer13,this.$SphericalRenderer12),this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.mvMatrixUniform,!1,this.$SphericalRenderer13),this.$SphericalRenderer8&&this.$SphericalRenderer6.uniform2f(this.$SphericalRenderer16.offsetUniform,this.$SphericalRenderer25.offsetX,this.$SphericalRenderer25.offsetZ)):this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.mvMatrixUniform,!1,this.$SphericalRenderer12);this.$SphericalRenderer10&&this.$SphericalRenderer6.uniformMatrix4fv(this.$SphericalRenderer16.stMatrixUniform,!1,this.$SphericalRenderer14);this.$SphericalRenderer21&&this.$SphericalRenderer6.drawElements(this.$SphericalRenderer6.TRIANGLES,this.$SphericalRenderer21.numItems,this.$SphericalRenderer6.UNSIGNED_SHORT,0)};e.$SphericalRenderer48=function(){var a=this.$SphericalRenderer6.getParameter(this.$SphericalRenderer6.MAX_CUBE_MAP_TEXTURE_SIZE),b=this.$SphericalRenderer15.image.width;return Math.min(a,b)};e.$SphericalRenderer46=function(){var a=this.$SphericalRenderer48(),c=this.$SphericalRenderer15.image.width,d=b("DOM").create("canvas",{width:a,height:a});d=d.getContext("2d");this.$SphericalRenderer6.bindTexture(this.$SphericalRenderer6.TEXTURE_CUBE_MAP,this.$SphericalRenderer15);this.$SphericalRenderer6.pixelStorei(this.$SphericalRenderer6.UNPACK_FLIP_Y_WEBGL,!1);for(var e=0;e<6;e++){d.drawImage(this.$SphericalRenderer15.image,0,e*c,c,c,0,0,a,a);var f=new Uint8Array(d.getImageData(0,0,a,a).data);this.$SphericalRenderer6.texImage2D(this.$SphericalRenderer6.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,this.$SphericalRenderer6.RGBA,a,a,0,this.$SphericalRenderer6.RGBA,this.$SphericalRenderer6.UNSIGNED_BYTE,f)}};return d}(b("EventEmitter"));e.exports=c}),null);
__d("SphericalVideoPlayer",["cx","invariant","Arbiter","Banzai","CSS","DOM","DOMDimensions","Event","FullScreen","SphericalMediaCanvasPool","SphericalParallaxUtils","SphericalRenderer","SphericalVideoComponentActions","SphericalVideoComponentDispatcher","SphericalVideoHalfEquirectConfig","SphericalVideoPerformanceTracker","SphericalVideoPlayerEvents","SphericalViewportControl","SphericalViewportControlNew","SphericalViewportMediaToMovementConfig","SubscriptionsHandler","VideoPlayerFallbackEvents","VideoPlayerLoggerEvent","VideoPlayerLoggerSource","VideoPlayerReason","VideoPlayerReasonTransitionHelper","VideoPlayerStates","VideoProjection","forwardEvent","getElementRect","getFullScreenElement","getViewportDimensions","gkx","onViewportChanged","requestAnimationFrame","uniqueID","SphericalViewportControlStore","VideoPlayerControllerStore"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("SphericalParallaxUtils").calculateYawOffset,j=b("SphericalViewportMediaToMovementConfig").SphericalViewportMediaEnum,k="SphericalVideoPlayer";c=2;var l=1e3;d=.8;f=16;g=15;var m=d/f/g,n=50,o=.1,p=b("gkx")("678911");b("SphericalMediaCanvasPool").setLimit(c,k);d=function(){__p&&__p();function c(a,c){__p&&__p();var d=this;this.$48=function(){var a=!!d.$1.getOption("VideoWithSphericalGuide","auto");if(d.$1.getSource()!==b("VideoPlayerLoggerSource").INLINE||a)return;a=d.$55();if(a===null)return;typeof a==="number"||h(0,1207);d.$26=a;d.$29&&(d.$24=d.$12.getOrientation().x-d.$26,d.$25=d.$26,d.$29=!1)};this.$50=function(){d.$1.isState(b("VideoPlayerStates").PAUSED)||d.$1.pause(b("VideoPlayerReason").SPHERICAL_SWITCH_CANVAS),d.$57(),d.$46()};this.$54=function(a){__p&&__p();if(!d.$14)return;var c=d.$14,e=d.$30?a-d.$30:0;e=d.$56(e);e&&d.$36(d.$24+d.$25,null);if(d.$2.readyState>=d.$2.HAVE_CURRENT_DATA&&(d.$44()||d.$7||e)){b("SphericalVideoPerformanceTracker").get().setProjection(d.$10.projectionType).addFrameAtTime(a);d.$7=!1;if(p){e=d.$13.getOrientation();c.render(e.x+90,e.y)}else{e=d.$12.getOrientation();c.render(e.x+90,e.y)}d.$16&&(d.$16.remove(),d.$16=null)}d.$30=a;b("requestAnimationFrame")(d.$54)};this.$33=function(a,b){if(p){var c=d.$13.getOrientation();c.x+=a;c.y+=b;d.$13.setOrientation(c)}else d.$12.setRelativeSphericalOrientation(a,b)};this.$36=function(a,b){if(p){var c=d.$13.getOrientation();c.x=typeof a==="number"?a:c.x;c.y=typeof b==="number"?b:c.y;d.$13.setOrientation(c)}else d.$12.setSphericalOrientation(a,b)};this.$37=function(a){__p&&__p();if(d.$14){d.$14.updateFieldOfView(a);if(p){var b=d.$13.getOrientation();b.vFOV=a;d.$13.setOrientation(b)}else d.$12.setFieldOfView(a);d.$20=a;d.$32()}};this.$38=function(a){d.$14&&(d.$10.projectionType=a,d.$14.reconfigure(d.$2,d.$10,!0),d.$32())};this.$39=function(a){d.$14&&(d.$10.stereoFormat=a,d.$14.reconfigure(d.$2,d.$10,!0),d.$32())};this.$40=function(a){d.$12&&(d.$10.partialLimits=a,d.$12.reconfigure(d.$10),d.$32())};this.$41=function(a){a===void 0&&(a={}),d.$12&&(d.$12.reconfigureControlConfig(a),d.$32())};this.$34=function(a,c){if(b("FullScreen").isFullScreen()&&(a<d.$5.width||c<d.$5.height))return;d.$14?(d.$5.width=a,d.$5.height=c,d.$53(d.$14,a,c),d.$11.useViewportDimension&&(d.$6=b("DOMDimensions").getElementDimensions(d.$4)),d.$32()):d.$5={width:a,height:c}};this.$52=function(a,b,c){__p&&__p();if(!d.$14)return;a=a>=0?(a+180)%360-180:(a-180)%360+180;d.$59(a,b);d.$19.yaw=a;d.$19.pitch=b;d.$20=c;d.$14&&d.$14.updateFieldOfView(c);d.$58(a);d.$32()};this.$10=a;this.$11=Object.assign({viewportClassName:"_2a6s",canvasClassName:"_38vt",placeholderImgClassName:"_44h9",videoID:"",playerID:void 0,eagerPreload:void 0,preventScrollDefaultAction:void 0,useViewportDimension:void 0,useContainerDimensions:void 0},c);this.$22=0;this.$28=!0;this.$29=!1}var d=c.prototype;d.enable=function(c){__p&&__p();var d=this;if(this.$1)return;this.$1=c;if(typeof a.WebGLRenderingContext!=="function"&&typeof a.WebGL2RenderingContext!=="function"){this.$31({error:"SPHERICAL_SETUP_FAILED",message:"WebGLRenderingContext not available."});return}if(!b("gkx")("678912")){this.$31({error:"SPHERICAL_RENDER_ERROR",message:"Unsupported browser version"});return}var e=c.getVideoNode();e instanceof HTMLVideoElement||h(0,1208);this.$2=e;this.$7=!1;this.$18=!0;this.$8=new(b("SubscriptionsHandler"))();this.$8.addSubscriptions(b("Event").listen(this.$2,"loadeddata",function(){return d.$32()}),b("Event").listen(this.$2,"seeked",function(){return d.$32()}),b("Event").listen(this.$2,"ended",function(){return d.$33(0,0)}),b("Event").listen(window,"resize",function(){b("FullScreen").isFullScreen()&&d.$1.getContainerNode()===b("getFullScreenElement")()&&d.$34(window.innerWidth,window.innerHeight)}),c.addListener("stateChange",function(){(c.isState(b("VideoPlayerStates").DESTROYED)||c.isState(b("VideoPlayerStates").FALLBACK)&&(c.isLiveVideo()||!c.isFallbackRecoverable()))&&d.$35()}),c.addListener(b("VideoPlayerFallbackEvents").RECOVER,function(){d.$35(),b("CSS").removeClass(d.$2,"_3axk"),d.$1.play(new(b("VideoPlayerReasonTransitionHelper"))(b("VideoPlayerReason").SPHERICAL_FALLBACK))}),c.addListener(b("SphericalVideoPlayerEvents").SET_ABSOLUTE_SPHERICAL_ORIENTATION,this.$36),c.addListener(b("SphericalVideoPlayerEvents").SET_RELATIVE_SPHERICAL_ORIENTATION,this.$33),c.addListener(b("SphericalVideoPlayerEvents").SET_FIELD_OF_VIEW,this.$37),c.addListener(b("SphericalVideoPlayerEvents").SET_VIDEO_PROJECTION,this.$38),c.addListener(b("SphericalVideoPlayerEvents").SET_STEREO_MODE,this.$39),c.addListener(b("SphericalVideoPlayerEvents").SET_PARTIAL_LIMITS,this.$40),c.addListener(b("SphericalVideoPlayerEvents").SET_VIEWPORT_CONTROL_CONFIG,this.$41),c.addListener("dimensionsChange",this.$34),c.once("changeVolume",function(){return d.$18=!1}),c.once("muteVideo",function(){return d.$18=!1}),c.once("unmuteVideo",function(){return d.$18=!1}),c.addListener("toggleFullscreen",function(){return d.$4.focus()}),c.addListener("TahoeController/enterTahoe",function(){d.$4.focus(),p?d.$13.setInTahoe(!0):(d.$12.setEnableZoom(!0),d.$23=!0,d.$1.emit("SphericalVideoPlayer/zoomEnabled"))}),c.addListener("TahoeController/exitTahoe",function(){d.$4.focus(),p?d.$13.setInTahoe(!1):(d.$12.setEnableZoom(!1),d.$23=!1,d.$1.emit("SphericalVideoPlayer/zoomDisabled"))}));if(this.$11.useContainerDimensions){var f=c.getContainerNode();this.$5=b("DOMDimensions").getElementDimensions(f)}else this.$5=b("DOMDimensions").getElementDimensions(e),(this.$5.width===0||this.$5.height===0)&&(this.$5={width:e.width,height:e.height});this.$15=this.$1.getVideoPlayerID()||b("uniqueID")();this.$19={yaw:this.$10.initialHeading,pitch:this.$10.initialPitch};this.$20=this.$10.fieldOfView;this.$23=!1;f=c.getVideoProjection();f&&(this.$10.projectionType=f);b("CSS").addClass(e,"_3axk");this.$42();c.registerOption("SphericalVideoPlayer","getDimensions",function(){return d.$11.useViewportDimension?d.$6:d.$5});c.registerOption("SphericalVideoPlayer","isReady",function(){return!!d.$14});c.registerOption("SphericalVideoPlayer","getScreenshotDataURL",function(){return d.$43()});c.registerOption("SphericalVideoPlayer","getIsSingleFisheye",function(){return d.$10.isSingleFisheye&&d.$10.originalFOV!==null});c.registerOption("SphericalVideoPlayer","getOriginalFOV",function(){return d.$10.originalFOV});c.registerOption("SphericalVideoPlayer","getEnableZoom",function(){return d.$23});c.registerOption("SphericalVideoPlayer","getIsHalfEquirectangular",function(){return d.$10.projectionType===b("VideoProjection").HALF_EQUIRECTANGULAR});this.$44()||this.$11.eagerPreload?this.$45():this.$46()};d.disable=function(){this.$35()};d.$45=function(){__p&&__p();if(this.$1.getOption("SphericalVideoPlayer","isUnavailable"))return;this.$17&&(this.$17.remove(),this.$17=null);try{b("SphericalVideoPerformanceTracker").get().setProjection(this.$10.projectionType).enterSphericalRendererSetup(),this.$47(),b("SphericalVideoPerformanceTracker").get().exitSphericalRendererSetup()}catch(a){this.$31({error:"SPHERICAL_SETUP_FAILED",message:a.message});return}this.$1.setStillFrameEnabled(!1);this.$32();this.$1.emit("SphericalVideoPlayer/ready");if(!p){var a=this.$12.getOrientation().x;this.$28?this.$24=a:this.$29=!0;this.$27=b("onViewportChanged")(this.$48)}this.$28=!1};d.$46=function(){var a=this;this.$17=this.$1.addListener("stateChange",function(){a.$44()&&a.$45()})};d.$49=function(){if(!this.$14)return;var a=this.$43();a=b("DOM").create("img",{width:this.$5.width,height:this.$5.height,src:a,className:this.$11.placeholderImgClassName});b("DOM").insertAfter(this.$2,a);this.$16&&this.$16.remove();this.$16=a;this.$50()};d.$43=function(a,b){if(!this.$14)return"";var c=this.$14,d=p?this.$13.getOrientation():this.$12.getOrientation(),e=d.x;d=d.y;return c.getScreenshotDataURL(e+90,d,a,b)};d.$42=function(){__p&&__p();var a=this,c=b("DOM").create("div",{className:this.$11.viewportClassName,tabIndex:0}),d={};if(this.$10.isSingleFisheye&&this.$10.originalFOV){var e=this.$10.originalFOV/2;this.$10.partialLimits={partialLeftDegrees:e,partialRightDegrees:e,partialTopDegrees:e,partialBottomDegrees:e};d=this.$51()}this.$10.projectionType===b("VideoProjection").HALF_EQUIRECTANGULAR&&(this.$10.partialLimits=b("SphericalVideoHalfEquirectConfig").getHalfEquirectangularPartialLimits(),d=b("SphericalVideoHalfEquirectConfig").getHalfEquirectangularControllerConfig());b("SphericalVideoComponentDispatcher").explicitlyRegisterStores([b("SphericalViewportControlStore"),b("VideoPlayerControllerStore")]);if(p){this.$13=new(b("SphericalViewportControlNew"))(c,j.WWW_VIDEO,this.$10,{vpc:this.$1});b("SphericalVideoComponentActions").registerSphericalViewportControl(this.$1.getVideoPlayerID(),this.$13,this.$4);this.$8.addSubscriptions(this.$13.addListener("viewportChange",this.$52),this.$13.addListener("DOM/click",function(b){if(b.button!==0)return;a.$1.clickVideo();b.preventDefault()}));e=["DOM/click","wheelScroll","viewportChange"];this.$8.addSubscriptions.apply(this.$8,e.map(function(c){return b("forwardEvent")(a.$13,a.$1,c)}));b("FullScreen").subscribe("changed",function(){a.$13.setFullscreen(b("FullScreen").isFullScreen())})}else{var f=new(b("SphericalViewportControl"))(c,this.$10,d);this.$8.addSubscriptions(f.addListener("DOM/click",function(b){if(b.button!==0)return;a.$1.clickVideo();b.preventDefault()}),f.addListener("mouseMove",function(b){a.$1.mouseMove(b),b.preventDefault()}),f.addListener("mouseUp",function(b){a.$1.mouseUp(b),b.preventDefault()}),f.addListener("mouseLeave",function(b){a.$1.mouseLeave(b),b.preventDefault()}),f.addListener("updateViewportBegin",function(){a.$1.isMuted()&&a.$18&&(a.$18=!1,a.$1.unmute()),a.$1.logEvent(b("VideoPlayerLoggerEvent").VIEWPORT_ROTATED)}));this.$8.addSubscriptions(f.addListener("viewportChange",this.$52));e=["DOM/click","updateViewportBegin","updateViewportMove","updateViewportEnd","wheelScroll","viewportChange"];this.$8.addSubscriptions.apply(this.$8,e.map(function(c){return b("forwardEvent")(f,a.$1,c)}));this.$12=f;b("Arbiter").subscribe("VideoChannelView/opened",function(){a.$21=!0,a.$12.disableKeyboard()});b("Arbiter").subscribe("VideoChannelView/closed",function(){a.$21=!1,a.$12.enableKeyboard()});b("FullScreen").subscribe("changed",function(){b("FullScreen").isFullScreen()?a.$12.enableKeyboard():a.$21&&a.$12.disableKeyboard()});this.$11.preventScrollDefaultAction&&this.$12.setPreventScrollDefaultAction(!0);b("SphericalVideoComponentActions").registerSphericalViewportControl(this.$1.getVideoPlayerID(),this.$12,this.$4)}this.$1.registerOption("SphericalVideoPlayer","getCurrentViewport",function(){return a.$19});this.$1.registerOption("SphericalVideoPlayer","getFieldOfView",function(){return a.$20});this.$4=c;b("DOM").insertAfter(this.$2,c);this.$11.useViewportDimension&&(this.$6=b("DOMDimensions").getElementDimensions(c))};d.$47=function(){__p&&__p();var a=this,c={canvasAttrs:{width:this.$5.width,height:this.$5.height,className:this.$11.canvasClassName,tabIndex:0},beforeCanvasLost:function(){return a.$49()}};c=b("SphericalMediaCanvasPool").get(this.$15,c,k);var d=new(b("SphericalRenderer"))(this.$2,c,this.$10);this.$9=new(b("SubscriptionsHandler"))();this.$9.addSubscriptions(d.addListener("renderingError",function(b){return a.$31({error:"SPHERICAL_RENDER_ERROR",message:b.message})}),d.addListener("renderingContextLost",this.$50));this.$3=c;this.$14=d;b("DOM").insertAfter(this.$2,c);this.$53(d,this.$5.width,this.$5.height);b("requestAnimationFrame")(this.$54);b("CSS").show(c)};d.$55=function(){__p&&__p();var a=this.$1.getRootNode();if(!a)return null;a=b("getElementRect")(a);a=a.top+a.bottom/2;var c=b("getViewportDimensions").withoutScrollbars().height;a=a/c*100;c=this.$12.getHorizontalFieldOfView();a=i(a,null,null,c);c=a.yaw;a=a.success;return a?c:null};d.$56=function(a){__p&&__p();if(typeof this.$26!=="number")return!1;typeof this.$25!=="number"&&(this.$25=0);var b=Math.abs(this.$25-this.$26);if(b<o)return!1;b=b*m;a=Math.max(a,n);this.$25<this.$26?this.$25+=Math.min(this.$26-this.$25,b*a):this.$25-=Math.min(this.$25-this.$26,b*a);return!0};d.$31=function(a){this.$1.logError(a),this.$1.emit(b("VideoPlayerLoggerEvent").ERROR,a),this.$35()};d.$44=function(){return this.$1.isState(b("VideoPlayerStates").PLAYING)};d.$58=function(a){if(!this.$25)return;this.$24=a-this.$25};d.$53=function(a,c,d){a.updateViewportDimensions(c,d),b("SphericalVideoComponentActions").updateViewportDimensions(this.$1.getVideoPlayerID(),c,d)};d.$32=function(){this.$7=!0};d.$59=function(a,c){var d=Date.now();if(d-this.$22>=l){this.$22=d;var e=!!this.$1.getOption("VideoWithSphericalGuide","auto");b("Banzai").post("spherical_video_viewport",{video_fbid:this.$1.getVideoID(),yaw_degrees:a,pitch_degrees:c,roll_degrees:0,field_of_view_y:this.$10.fieldOfView,aspect_ratio:this.$5.height/this.$5.width,video_player_position:this.$2.currentTime,video_player_position_ms:this.$2.currentTime*1e3,guide_enabled:e,timestamp:d})}};d.$57=function(){this.$14&&(this.$14.destroy(),this.$14=null,this.$27&&this.$27.remove(),this.$27=null,this.$9.release(),this.$3.remove())};d.$35=function(){this.$1.hasOption("SphericalVideoPlayer","isUnavailable")||this.$1.registerOption("SphericalVideoPlayer","isUnavailable",function(){return!0}),this.$8&&this.$8.release(),this.$57(),this.$12&&this.$12.destroy(),this.$13&&this.$13.destroy(),this.$4&&this.$4.remove(),b("SphericalVideoPerformanceTracker").get().destroy()};d.$51=function(){return{disableAutoClientSizeUpdate:!1,enableGyro:!1,enableRubberBanding:!1,maxSpringDegrees:0,maxStretchXDegrees:0,maxStretchYDegrees:0,minVFOV:3,rubberBandConstant:0,slipFactor:0,springFactor:0,enableZoomWithShiftKey:!1,enablePanningWithRightMouse:!1}};return c}();e.exports=d}),null);
__d("SphericalVideoRecenterControl",["SubscriptionsHandler","easeInOutInterpolate","requestAnimationFrame"],(function(a,b,c,d,e,f){__p&&__p();var g=1e3;a=function(){"use strict";__p&&__p();function a(a,b,c){var d=this;this.$2=a;this.$1=!1;this.$7=this.$10.bind(this);this.$6={yaw:b,pitch:c};this.$5={yaw:b,pitch:c};a.getOption("SphericalVideoPlayer","isReady")?this.$11():a.once("SphericalVideoPlayer/ready",function(){return d.$11()})}var c=a.prototype;c.$11=function(){var a=this;this.$9=new(b("SubscriptionsHandler"))();this.$9.addSubscriptions(this.$2.addListener("updateViewportBegin",function(){return a.$12()}),this.$2.addListener("SphericalHeadingIndicator/click",function(){return a.$13()}),this.$2.addListener("VideoWithSphericalGuide/intervalUpdate",function(b){return a.updateTargetViewport(b.baseYaw+b.deltaYaw,b.basePitch+b.deltaPitch)}),this.$2.addListener("VideoWithSphericalGuide/stateToggle",function(b){b||(a.$6.yaw=a.$5.yaw,a.$6.pitch=a.$5.pitch)}),this.$2.addListener("SphericalVideoViewportTagComment/click",function(b){return a.$13(b)}))};c.updateTargetViewport=function(a,b){this.$6.yaw=a,this.$6.pitch=b};c.$13=function(a){__p&&__p();if(this.$1||this.$2.getOption("VideoWithSphericalGuide","enabled")&&this.$2.isState("playing"))return;this.$1=!0;this.$3=Date.now();var c=this.$2.getOption("SphericalVideoPlayer","getCurrentViewport");a=a||this.$6;var d=a.yaw-c.yaw;Math.abs(d)>180&&(d=d>0?d-360:d+360);this.$8={basePitch:c.pitch,deltaPitch:a.pitch-c.pitch,baseYaw:c.yaw,deltaYaw:d};this.$2.emit("SphericalVideoRecenterControl/animationStart");b("requestAnimationFrame")(this.$7)};c.$12=function(){this.$1=!1};c.$10=function(){__p&&__p();if(!this.$1){this.$2.emit("SphericalVideoRecenterControl/animationEnd");return}var a=Date.now();if(a-this.$3>g){this.$14(this.$8,1);this.$1=!1;this.$2.emit("SphericalVideoRecenterControl/animationEnd");return}b("requestAnimationFrame")(this.$7);this.$14(this.$8,b("easeInOutInterpolate")((a-this.$3)/g))};c.$14=function(a,b){var c=a.deltaPitch*b+a.basePitch;b=a.deltaYaw*b+a.baseYaw;this.$2.setSphericalOrientation(b,c)};c.destroy=function(){this.$9.release()};return a}();e.exports=a}),null);
__d("VideoSphericalHeadingIndicator",["cx","CSS","React","ReactDOM","SphericalVideoHeadingIndicator.react","VideoPlayerFallbackEvents","VideoPlayerLoggerEvent","destroyOnUnload"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(){__p&&__p();function a(a,c,d,e,f,g){__p&&__p();var h=this;g===void 0&&(g=!1);this.$7=function(a){a.preventDefault(),h.$1.emit("SphericalHeadingIndicator/click"),h.$1.logEvent(b("VideoPlayerLoggerEvent").HEADING_RESET)};this.$1=a;this.$2=c;this.$3=d;this.$4=g;var i=a.addListener(b("VideoPlayerFallbackEvents").ENTER,function(){i.remove(),b("ReactDOM").unmountComponentAtNode(c)});if(a.isState("ready")||a.isState("playing"))this.$5();else var j=a.addListener("stateChange",function(){(h.$1.isState("ready")||h.$1.isState("playing"))&&(j.remove(),h.$5())});b("destroyOnUnload")(function(){b("ReactDOM").unmountComponentAtNode(c)})}var c=a.prototype;c.$5=function(){this.$1.addListener("toggleFullscreen",this.$6.bind(this)),b("ReactDOM").render(b("React").createElement(b("SphericalVideoHeadingIndicator.react"),{initialYaw:this.$3,onClick:this.$7,controller:this.$1,isComposer:this.$4}),this.$2)};c.$6=function(){this.$1.isFullscreen()?b("CSS").addClass(this.$2,"_4ubd"):b("CSS").removeClass(this.$2,"_4ubd")};return a}();e.exports=a}),null);